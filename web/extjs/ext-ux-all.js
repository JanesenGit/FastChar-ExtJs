Ext.define("Ext.ux.dd.BoxContainerDD",{extend:"Ext.dd.DD",alignElWithMouse:function(b,a,c){a=this.getTargetCoord(a,c);c=a.x;var d=a.y,e=b.dom?b:Ext.fly(b,"_dd");if(this.deltaSetXY)this.setLocalXY(e,Math.max(0,c+this.deltaSetXY[0]),Math.max(0,d+this.deltaSetXY[1]));else{var f=[Math.max(0,c),Math.max(0,d)];e.setXY(f);f=this.getLocalX(e);e=e.getLocalY();this.deltaSetXY=[f-c,e-d]}this.cachePosition(c,d);this.autoScroll(c,d,b.offsetHeight,b.offsetWidth);return a}});
Ext.define("Ext.ux.BoxReorderer",{extend:"Ext.plugin.Abstract",alias:"plugin.boxreorderer",requires:["Ext.ux.dd.BoxContainerDD"],mixins:{observable:"Ext.util.Observable"},itemSelector:".x-box-item",animate:100,constructor:function(){this.callParent(arguments);this.mixins.observable.constructor.call(this)},init:function(b){var a=b.getLayout();this.container=b;this.names=a._props[a.type].names;this.animatePolicy={};this.animatePolicy[this.names.x]=!0;this.container.on({scope:this,boxready:this.onBoxReady,
beforedestroy:this.onContainerDestroy})},onContainerDestroy:function(){var b=this.dd;b&&(b.unreg(),this.dd=null)},onBoxReady:function(){var b=this.container.getLayout(),a=this.names;b=this.dd=new Ext.ux.dd.BoxContainerDD(b.innerCt,this.container.id+"-reorderer");Ext.apply(b,{animate:this.animate,reorderer:this,container:this.container,getDragCmp:this.getDragCmp,clickValidator:Ext.Function.createInterceptor(b.clickValidator,this.clickValidator,this,!1),onMouseDown:this.onMouseDown,startDrag:this.startDrag,
onDrag:this.onDrag,endDrag:this.endDrag,getNewIndex:this.getNewIndex,doSwap:this.doSwap,findReorderable:this.findReorderable,names:a});b.dim=a.width;b.startAttr=a.beforeX;b.endAttr=a.afterX},getDragCmp:function(b){return this.container.getChildByElement(b.getTarget(this.itemSelector,10))},clickValidator:function(b){b=this.getDragCmp(b);return!(!b||!1===b.reorderable)},onMouseDown:function(b){var a=this.container;if(this.dragCmp=this.getDragCmp(b)){var c=this.dragCmp.getEl();this.startIndex=this.curIndex=
a.items.indexOf(this.dragCmp);c=c.getBox();this.lastPos=c[this.startAttr];a=a.el.getBox();"width"===this.dim?(this.minX=a.left,this.maxX=a.right-c.width,this.minY=this.maxY=c.top,this.deltaX=b.getX()-c.left):(this.minY=a.top,this.maxY=a.bottom-c.height,this.minX=this.maxX=c.left,this.deltaY=b.getY()-c.top);this.constrainY=this.constrainX=!0}},startDrag:function(){var b=this.dragCmp,a;if(b){if((a=this.container.getScrollable())&&a.scrollBy(-1).then(function(){a.scrollBy(1)}),b.setPosition=Ext.emptyFn,
b.animate=!1,this.animate&&(this.container.getLayout().animatePolicy=this.reorderer.animatePolicy),this.dragElId=b.getEl().id,this.reorderer.fireEvent("StartDrag",this,this.container,b,this.curIndex),b.suspendEvents(),b.disabled=!0,b.el.setStyle("zIndex",100),!b.nextSibling()){b=this.container.layout.targetEl;var c=b.dom;var d=c.scrollWidth-1;c=c.scrollHeight-1;this.spacerEl=Ext.dom.Helper.append(b,{tag:"div",style:"width: 1px;height: 1px;position: absolute;left: "+d+"px;top: "+c+'px;"'})}}else this.dragElId=
null},findReorderable:function(b){var a=this.container.items;if(!1===a.getAt(b).reorderable){var c=a.getAt(b);if(b>this.startIndex)for(;c&&!1===c.reorderable;)b++,c=a.getAt(b);else for(;c&&!1===c.reorderable;)b--,c=a.getAt(b)}b=Math.min(Math.max(b,0),a.getCount()-1);return!1===a.getAt(b).reorderable?-1:b},doSwap:function(b){var a=this.container.items,c=this.container,d=this.curIndex<b?1:-1;if(1<Math.abs(this.curIndex-b))this.doSwap(this.curIndex+d);else if(b=this.findReorderable(b),-1!==b&&b!==this.curIndex){this.reorderer.fireEvent("ChangeIndex",
this,c,this.dragCmp,this.startIndex,b);d=a.getAt(this.curIndex);var e=a.getAt(b);a.remove(d);var f=Math.min(Math.max(b,0),a.getCount()-1);a.insert(f,d);a.remove(e);a.insert(this.curIndex,e);c.updateLayout({isRoot:!0});this.startIndex=this.curIndex=b}},onDrag:function(b){b=this.getNewIndex(b.getPoint());void 0!==b&&(this.reorderer.fireEvent("Drag",this,this.container,this.dragCmp,this.startIndex,this.curIndex),this.doSwap(b))},endDrag:function(b){var a=this.dragCmp,c=this.container,d=c.getLayout();
b&&b.stopEvent();if(a){delete this.dragElId;delete a.setPosition;a.animate=!0;a.lastBox[this.names.x]=a.getPosition(!0)[this.names.widthIndex];c.updateLayout({isRoot:!0});if(b=Ext.fx.Manager.getFxQueue(a.el.id)[0])b.on({afteranimate:this.reorderer.afterBoxReflow,scope:this});else Ext.asap(this.reorderer.afterBoxReflow,this);this.animate&&delete d.animatePolicy;this.reorderer.fireEvent("drop",this,c,a,this.startIndex,this.curIndex)}},afterBoxReflow:function(){var b=Ext.fly(this.spacerEl),a=this.dragCmp;
a.el.setStyle("zIndex","");a.disabled=!1;a.resumeEvents();b&&(b.remove(),this.spacerEl=null)},getNewIndex:function(b){b=this.getDragEl();var a=Ext.fly(b).getBox(),c=0,d=this.container.items.items,e=d.length,f=this.lastPos;for(this.lastPos=a[this.startAttr];c<e;c++){var g=d[c].getEl();if(g.dom!==b&&g.is(this.reorderer.itemSelector))if(g=g.getBox(),g=g[this.startAttr]+(g[this.dim]>>1),c<this.curIndex){if(a[this.startAttr]<f&&a[this.startAttr]<g-5)return c}else if(c>this.curIndex&&a[this.startAttr]>
f&&a[this.endAttr]>g+5)return c}}});
Ext.define("Ext.ux.TabReorderer",{extend:"Ext.ux.BoxReorderer",alias:"plugin.tabreorderer",itemSelector:"."+Ext.baseCSSPrefix+"tab",init:function(b){this.callParent([b.getTabBar()]);b.onAdd=Ext.Function.createSequence(b.onAdd,this.onAdd)},onBoxReady:function(){var b,a=0;this.callParent(arguments);var c=this.container.items.items;for(b=c.length;a<b;a++){var d=c[a];d.card&&(d.reorderable=d.card.reorderable)}},onAdd:function(b,a){b.tab.reorderable=b.reorderable},afterBoxReflow:function(){Ext.ux.BoxReorderer.prototype.afterBoxReflow.apply(this,arguments);
this.dragCmp&&(this.container.tabPanel.setActiveTab(this.dragCmp.card),this.container.tabPanel.move(this.dragCmp.card,this.curIndex))}});
Ext.define("Ext.ux.TabCloseMenu",{extend:"Ext.plugin.Abstract",alias:"plugin.tabclosemenu",mixins:{observable:"Ext.util.Observable"},closeTabText:"\u5173\u95ed\u5f53\u524d",showCloseOthers:!0,closeOthersTabsText:"\u5173\u95ed\u5176\u4ed6",showCloseAll:!0,closeAllTabsText:"\u5173\u95ed\u6240\u6709",extraItemsHead:null,extraItemsTail:null,constructor:function(b){this.callParent([b]);this.mixins.observable.constructor.call(this,b)},init:function(b){this.tabPanel=b;this.tabBar=b.down("tabbar");this.mon(this.tabPanel,
{scope:this,afterlayout:this.onAfterLayout,single:!0})},onAfterLayout:function(){this.mon(this.tabBar.el,{scope:this,contextmenu:this.onContextMenu,delegate:".x-tab"})},destroy:function(){this.callParent();Ext.destroy(this.menu)},onContextMenu:function(b,a){var c=this,d=c.createMenu(),e=!0,f=!0;a=c.tabBar.getChildByElement(a);a=c.tabBar.items.indexOf(a);c.item=c.tabPanel.getComponent(a);d.child("#anchorLeftMenu").setDisabled(!c.item.closable);d.child("#close").setDisabled(!c.item.closable);d.child("#copyTab").setDisabled(!c.item.closable);
d.child("#openInWindowTab").setDisabled(!c.item.closable);d.child("#copyUrlTab").setDisabled(!c.item.closable);c.item.justFixed?d.child("#fixedTab").hide():(d.child("#fixedTab").show(),c.item.closable?(d.child("#fixedTab").setText("\u56fa\u5b9a\u6807\u7b7e"),d.child("#fixedTab").setIconCls("extIcon extFixed")):(d.child("#fixedTab").setText("\u53d6\u6d88\u56fa\u5b9a"),d.child("#fixedTab").setIconCls("extIcon extUnFixed")));if(c.showCloseAll||c.showCloseOthers)c.tabPanel.items.each(function(g){return g.closable&&
(e=!1,g!==c.item)?f=!1:!0}),c.showCloseAll&&d.child("#closeAll").setDisabled(e),c.showCloseOthers&&d.child("#closeOthers").setDisabled(f);d.child("#closeRightOthers").setDisabled(this.tabPanel.items.indexOf(this.item)===this.tabPanel.items.getCount()-1);b.preventDefault();c.fireEvent("beforemenu",d,c.item,c);d.showAt(b.getXY())},createMenu:function(){var b=this;if(!b.menu){var a=[];a.push({itemId:"anchorLeftMenu",text:"\u5b9a\u4f4d\u5de6\u4fa7\u83dc\u5355",scope:b,iconCls:"extIcon extLastPoint",handler:function(){b.item.anchorLeftMenu()}});
a.push({itemId:"copyUrlTab",text:"\u590d\u5236\u5730\u5740",scope:b,iconCls:"extIcon extCopy",handler:function(){b.item.doCopyUrl()}});a.push({itemId:"fixedTab",text:"\u56fa\u5b9a\u6807\u7b7e",scope:b,iconCls:"extIcon extFixed",handler:function(){b.item.doFixed()}});a.push({itemId:"copyTab",text:"\u590d\u5236\u6807\u7b7e\u9875",scope:b,iconCls:"extIcon extCopy",handler:function(){system.showTab(b.item.method,"CopyTab"+Ext.now(),"\u590d\u5236-"+b.item.title,b.item.icon)}});a.push({itemId:"openInWindowTab",
text:"\u5728\u7a97\u53e3\u4e2d\u6253\u5f00",scope:b,iconCls:"extIcon extWindow",handler:function(){b.item.openInWindow()}});a.push("-");a.push({itemId:"close",text:b.closeTabText,scope:b,iconCls:"extIcon extClose",handler:b.onClose});(b.showCloseAll||b.showCloseOthers)&&a.push("-");b.showCloseOthers&&a.push({itemId:"closeOthers",text:b.closeOthersTabsText,scope:b,iconCls:"extIcon extCloseOther",handler:b.onCloseOthers});a.push({itemId:"closeRightOthers",text:"\u5173\u95ed\u53f3\u4fa7\u6807\u7b7e",
scope:b,iconCls:"extIcon extCloseOther",handler:b.onRightCloseOthers});b.showCloseAll&&a.push({itemId:"closeAll",text:b.closeAllTabsText,scope:b,iconCls:"extIcon extCloseAll",handler:b.onCloseAll});b.extraItemsHead&&(a=b.extraItemsHead.concat(a));b.extraItemsTail&&(a=a.concat(b.extraItemsTail));b.menu=Ext.create("Ext.menu.Menu",{items:a,listeners:{hide:b.onHideMenu,click:b.onItemClick,scope:b}})}return b.menu},onHideMenu:function(){this.fireEvent("aftermenu",this.menu,this)},onItemClick:function(b,
a,c,d){this.fireEvent("itemclick",b,a,c,d)},onClose:function(){this.tabPanel.remove(this.item)},onCloseOthers:function(){this.doClose(!0)},onRightCloseOthers:function(){this.doClose(!0,!0)},onCloseAll:function(){this.doClose(!1)},doClose:function(b,a){var c=[],d=-1;a&&(d=this.tabPanel.items.indexOf(this.item));this.tabPanel.items.each(function(e,f){e.closable&&f>d&&(b&&e===this.item||c.push(e))},this);Ext.suspendLayouts();Ext.Array.forEach(c,function(e){e.setDisabled(!0)},this);Ext.Array.forEach(c,
function(e){this.tabPanel.remove(e)},this);Ext.resumeLayouts(!0);this.fireEvent("closedone",this.menu,this)}});
Ext.define("Ext.ux.colorpick.ColorUtils",function(b){return{singleton:!0,constructor:function(){b=this},backgroundTpl:"background: {rgba};",setBackground:function(a,c){if(a){var d=Ext.XTemplate.getTpl(b,"backgroundTpl");c={rgba:b.getRGBAString(c)};d=d.apply(c);a.applyStyles(d)}},formats:{HEX6:function(a){return b.rgb2hex(a&&a.r,a&&a.g,a&&a.b)},HEX8:function(a){var c=b.rgb2hex(a.r,a.g,a.b);a=Math.round(255*a.a).toString(16);2>a.length&&(c+="0");return c+=a.toUpperCase()},rgb:function(a){return b.getRGBString(a)},
rgba:function(a){return b.getRGBAString(a)}},hexRe:/^#?([0-9a-f]{3,8})/i,rgbaAltRe:/rgba\(\s*([\w#\d]+)\s*,\s*([\d\.]+)\s*\)/,rgbaRe:/rgba\(\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*\)/,rgbRe:/rgb\(\s*([\d\.]+)\s*,\s*([\d\.]+)\s*,\s*([\d\.]+)\s*\)/,parseColor:function(a,c){var d;if(!a)return null;if(d=this.colorMap[a])a={r:d[0],g:d[1],b:d[2],a:1};else if("transparent"===a)a={r:0,g:0,b:0,a:0};else if(d=this.hexRe.exec(a))switch(d=d[1],d.length){default:return null;case 3:a={r:parseInt(d[0]+
d[0],16),g:parseInt(d[1]+d[1],16),b:parseInt(d[2]+d[2],16),a:1};break;case 6:case 8:a={r:parseInt(d.substr(0,2),16),g:parseInt(d.substr(2,2),16),b:parseInt(d.substr(4,2),16),a:parseInt(d.substr(6,2)||"ff",16)/255}}else if(d=this.rgbaRe.exec(a))a={r:parseFloat(d[1]),g:parseFloat(d[2]),b:parseFloat(d[3]),a:parseFloat(d[4])};else{if(d=this.rgbaAltRe.exec(a))return a=this.parseColor(d[1]),a.a=parseFloat(d[2]),a;if(d=this.rgbRe.exec(a))a={r:parseFloat(d[1]),g:parseFloat(d[2]),b:parseFloat(d[3]),a:1};else return null}c&&
(a.a=Ext.util.Format.number(a.a,c));c=this.rgb2hsv(a.r,a.g,a.b);return Ext.apply(a,c)},isValid:function(a){return null!==b.parseColor(a)},getRGBAString:function(a){a=null===a?{r:0,g:0,b:0,h:1,s:1,v:1,a:"1"}:a;return"rgba("+a.r+","+a.g+","+a.b+","+a.a+")"},getRGBString:function(a){return"rgb("+a.r+","+a.g+","+a.b+")"},hsv2rgb:function(a,c,d){a=1<a?1:a;c=1<c?1:c;d=1<d?1:d;a=360*(void 0===a?1:a);360===a&&(a=0);var e=d*c;var f=a/60;var g=e*(1-Math.abs(f%2-1));var h=[0,0,0];switch(Math.floor(f)){case 0:h=
[e,g,0];break;case 1:h=[g,e,0];break;case 2:h=[0,e,g];break;case 3:h=[0,g,e];break;case 4:h=[g,0,e];break;case 5:h=[e,0,g];break;default:console.error("unknown color "+a+" "+c+" "+d)}a=d-e;h[0]+=a;h[1]+=a;h[2]+=a;h[0]=Math.round(255*h[0]);h[1]=Math.round(255*h[1]);h[2]=Math.round(255*h[2]);return{r:h[0],g:h[1],b:h[2]}},rgb2hsv:function(a,c,d){a/=255;c/=255;d/=255;var e=Math.max(a,c,d);var f=e-Math.min(a,c,d);var g=0;0!==f&&(e===a?g=(c-d)/f%6:e===c?g=(d-a)/f+2:e===d&&(g=(a-c)/f+4));a=60*g;360===a&&
(a=0);c=0;0!==f&&(c=f/e);a/=360;0>a&&(a+=1);return{h:a,s:c,v:e}},rgb2hex:function(a,c,d){a=null===a?a:a.toString(16);c=null===c?c:c.toString(16);d=null===d?d:d.toString(16);if(null===a||2>a.length)a="0"+a||"0";if(null===c||2>c.length)c="0"+c||"0";if(null===d||2>d.length)d="0"+d||"0";if(null===a||2<a.length)a="ff";if(null===c||2<c.length)c="ff";if(null===d||2<d.length)d="ff";return(a+c+d).toUpperCase()},colorMap:{aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,
212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,
183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,
0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,
210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,
179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,
239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,
180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]}}},function(b){var a=b.formats,c={};a["#HEX6"]=function(d){return"#"+a.HEX6(d)};a["#HEX8"]=function(d){return"#"+a.HEX8(d)};Ext.Object.each(a,function(d,e){c[d.toLowerCase()]=function(f){return e(f).toLowerCase()}});Ext.apply(a,c)});