var FastExt;
(function(c){var v=function(){function m(){}m.getOS=function(){try{var b=navigator.userAgent,a="Win32"===navigator.platform||"Windows"===navigator.platform,d="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(d)return"Mac";if("X11"===navigator.platform&&!a&&!d)return"Unix";if(-1<String(navigator.platform).indexOf("Linux"))return"Linux";if(a)return-1<b.indexOf("Windows NT 5.0")||-1<b.indexOf("Windows 2000")?"Windows 2000":
-1<b.indexOf("Windows NT 5.1")||-1<b.indexOf("Windows XP")?"Windows XP":-1<b.indexOf("Windows NT 5.2")||-1<b.indexOf("Windows 2003")?"Windows 2003":-1<b.indexOf("Windows NT 6.0")||-1<b.indexOf("Windows Vista")?"Windows Vista":-1<b.indexOf("Windows NT 6.1")||-1<b.indexOf("Windows 7")?"Windows 7":-1<b.indexOf("Windows NT 8.0")||-1<b.indexOf("Windows 8")?"Windows 8":-1<b.indexOf("Windows NT 10.0")||-1<b.indexOf("Windows 10")?"Windows 10":"Windows"}catch(e){}return"Other"};m.deleteObjectAttr=function(b){for(var a=
[],d=1;d<arguments.length;d++)a[d-1]=arguments[d];for(d=0;d<a.length;d++)delete a[d][b]};m.toBool=function(b,a){Ext.isEmpty(a)&&(a=!1);return Ext.isEmpty(b)?a:Ext.isString(b)?"0"===b||"off"===b||"false"===b.toLowerCase()?!1:"1"===b||"on"===b||"true"===b.toLowerCase()?!0:a:Ext.isNumber(b)?0===b?!1:1===b?!0:a:Ext.isBoolean(b)?b:!!b};m.copyToBoard=function(b){var a=document.createElement("input");a.value=b;document.body.appendChild(a);a.select();document.execCommand("Copy");a.style.display="none";$(a).remove()};
m.copy=function(b){var a={};if(b instanceof Array)a=b.concat();else if(b instanceof Function)a=b;else for(var d in b)a[d]=b[d];return a};m.loadFunction=function(b){try{if(b.toString().trim().startsWith("function")){var a="do"+$.md5(b);if(Ext.isEmpty(c.Cache.memory[a])){var d=document.createElement("script");d.type="text/javascript";b="let "+a+"\x3d"+b;try{d.appendChild(document.createTextNode(b))}catch(e){d.text=b}document.body.appendChild(d);c.Cache.memory[a]=!0}return eval(a)}}catch(e){}return function(){}};
m.download=function(b,a){var d=b.split("?")[0].substring(b.lastIndexOf("/")),e=document.createElement("a"),f=new MouseEvent("click");Ext.isEmpty(a)&&(a=0===d.length?"file"+d:d);e.download=a;e.href=b;e.dispatchEvent(f)};m.openUrl=function(b,a){Ext.isEmpty(a)&&(a=FastEnum.Target._blank);var d=document.createElement("a");d.click?(d.setAttribute("href",b),d.setAttribute("target",a),d.style.display="none",$(document.body).append(d),d.click(),$(d).remove()):window.location.href=b};m.runCallBack=function(b,
a){if(Ext.isFunction(b)&&!b.callBacked){for(var d=[],e=1;e<arguments.length;e++)d[e-1]=arguments[e];b.apply(this,d);b.callBacked=!0}};m.buildOnlyCode=function(b){return b+$.md5(this.buildUUID8())};m.buildOnlyNumber=function(b){return b+Ext.now()};m.getNumberValue=function(b){return parseFloat(b.replace(/[^0-9]/ig,""))};m.prefixInteger=function(b,a){return(Array(a).join("0")+b).slice(-a)};m.getSVGIcon=function(b){return'\x3csvg class\x3d"svgIcon fileIcon" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#'+
b+'"\x3e\x3c/use\x3e\x3c/svg\x3e'};m.getSVGClassName=function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++){var d=b[a].toString().toLowerCase(),e=void 0;c.File.isSuffixFile(d,"doc","docx")?e="extFileWord":c.File.isSuffixFile(d,"xls","xlsx")?e="extFileExcel":c.File.isSuffixFile(d,"pdf")?e="extFilePDF":c.File.isSuffixFile(d,"ppt")?e="extFilePPT":c.File.isSuffixFile(d,"zip","rar","gzip")?e="extFileZIP":c.File.isSuffixFile(d,"apk","aar")?e="extFileAPK":c.File.isSuffixFile(d,
"jpg","jpeg")?e="extFileJPG":c.File.isSuffixFile(d,"png")?e="extFilePNG":c.File.isSuffixFile(d,"psd")?e="extFilePSD":c.File.isSuffixFile(d,"html","shtml")?e="extFileHTMl":c.File.isSuffixFile(d,"txt")?e="extFileTXT":c.File.isSuffixFile(d,"ipa")&&(e="extFileIOS");if(!Ext.isEmpty(e))return e}return"extFile"};m.guessDateFormat=function(b){return c.Dates.guessDateFormat(b)};m.parseDate=function(b){return c.Dates.parseDate(b)};m.getUrlContentType=function(b,a){if(b&&a){var d=$.md5(b.toString()),e=c.Cache.getCache(d);
e?a(e):$.ajax({type:"HEAD",url:b,complete:function(f,g){c.Cache.setCache(d,f.getResponseHeader("content-type"));a(f.getResponseHeader("content-type"))},error:function(){c.Cache.setCache(d,"un-know");a("un-know")}})}};m.inputFocusEnd=function(b){try{b.focus();var a=b.value.length;if(document.selection){var d=b.createTextRange();d.moveStart("character",a);d.collapse();d.select()}else"number"==typeof b.selectionStart&&"number"==typeof b.selectionEnd&&(b.selectionStart=b.selectionEnd=a)}catch(e){console.error(e)}};
m.randomInt=function(b,a){return b===a?b:Math.floor(Math.random()*(a-b+1)+b)};m.getTargetElement=function(b){return c.Component.getTargetElement(b)};m.getTargetBodyElement=function(b){return c.Component.getTargetBodyElement(b)};m.isElementInViewport=function(b){try{var a=b.getBoundingClientRect();return 0>=a.width&&0>=a.height?!1:0<=a.top&&0<=a.left&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&a.right<=(window.innerWidth||document.documentElement.clientWidth)}catch(d){}return!1};
m.loadCssCode=function(b,a){var d=document.getElementsByTagName("head").item(0),e=document.createElement("style");e.type="text/css";e.styleSheet?e.styleSheet.cssText=b:e.innerHTML=b;null!=a&&a();d.appendChild(e)};m.dispatchTargetEvent=function(b,a,d){a&&b&&(b.createEvent?(b=b.createEvent("MouseEvents"),b.initEvent(d,!0,!1),a.dispatchEvent(b)):b.createEventObject&&a.fireEvent("on"+d))};m.buildUUID4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};m.buildUUID8=function(){return(4294967296*
(1+Math.random())|0).toString(16).substring(1)};m.buildUUID12=function(){return c.Base.buildUUID4()+c.Base.buildUUID8()};m.buildUUID16=function(){return c.Base.buildUUID8()+c.Base.buildUUID8()};m.getUrlParams=function(b,a){a=new RegExp(a+"\x3d([^\x26]*)(?:\x26)?");return b.match(a)&&b.match(a)[1]};m.toString=function(b,a){if(void 0===a||null===a)a=b;return Ext.isEmpty(b)?a:b.toString()};m.toInt=function(b,a){if(void 0===a||null===a)a=b;return Ext.isEmpty(b)||isNaN(b)?a:parseInt(b)};m.toMaxString=
function(b,a){b=c.Base.toString(b,"");return b.length>a?b.substring(0,a)+"\u2026":b};m.toPlanParams=function(b){for(var a=[],d=0;d<b.length;d++){var e=b[d];Ext.isString(e)?a.push('"'+e+'"'):a.push(e)}return a.join(",")};m.getEmptyPromise=function(){return new Ext.Promise(function(b,a){b()})};m.toByteUnit=function(b,a){Ext.isEmpty(a)&&(a=2);b=parseInt(b);return 0===b?"0":1073741824<b?(b/1073741824).toFixed(a)+"G":1048576<b?(b/1048576).toFixed(a)+"M":1024<b?(b/1024).toFixed(a)+"KB":b+"B"};return m}();
c.Base=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.buttonToMenuItem=function(b){if(b.hidden||Ext.isEmpty(b.text)||"\x26#160;"===b.text)return null;var a={icon:b.icon,iconCls:b.iconCls,text:b.text,subtext:b.subtext,handler:b.handler,disabled:b.disabled};if(null!=b.getMenu()){var d=[];b.getMenu().items.each(function(e,f){(e=c.Button.buttonToMenuItem(e))&&d.push(e)});a.menu=d}return a};m.checkGridToolbarButton=function(b){var a=b.up("grid,treepanel");if(a){if(!Ext.isEmpty(b.text)&&c.Base.toBool(b.contextMenu,
!0)){var d=c.Button.buttonToMenuItem(b);c.Grid.addGridContextMenu(a,d)}c.Button.buttonToBind(a,b)}};m.checkButtonBind=function(b,a){if(!b||!a)return!1;for(var d=0;d<b.length;d++)if(b[d].getId()===a.getId())return!0;return!1};m.setDisabled=function(b,a){b&&(b.setDisabled(a),b.overflowClone&&b.overflowClone.setDisabled(a))};m.buttonToBind=function(b,a){b.selectButtons||(b.selectButtons=[]);b.updateButtons||(b.updateButtons=[]);b.addButtons||(b.addButtons=[]);b.deleteButtons||(b.deleteButtons=[]);b.bindDetailButtons||
(b.bindDetailButtons=[]);b.entityCodeButtons||(b.entityCodeButtons=[]);var d=a.isHidden();c.Base.toBool(a.hiddenValid)&&(d=!1);a.checkSelect&&!d&&(c.Button.setDisabled(a,!0),c.Button.checkButtonBind(b.selectButtons,a)||b.selectButtons.push(a));!a.checkUpdate&&!a.entityUpdateButton||d||(c.Button.setDisabled(a,!0),c.Button.checkButtonBind(b.updateButtons,a)||b.updateButtons.push(a));a.entityAddButton&&!d&&(c.Button.checkButtonBind(b.addButtons,a)||b.addButtons.push(a));a.entityDeleteButton&&!d&&(c.Button.checkButtonBind(b.deleteButtons,
a)||b.deleteButtons.push(a));a.bindDetail&&Ext.isFunction(a.handler)&&!d&&(c.Button.checkButtonBind(b.bindDetailButtons,a)||b.bindDetailButtons.push(a));a.entityCode&&(c.Button.checkButtonBind(b.entityCodeButtons,a)||b.entityCodeButtons.push(a));Ext.isFunction(a.getMenu)&&null!=a.getMenu()&&a.getMenu().items.each(function(e,f){c.Button.buttonToBind(b,e)});null!=a.items&&a.items.each(function(e,f){c.Button.buttonToBind(b,e)})};return m}();c.Button=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.setCache=function(b,a){try{localStorage.setItem(b,JSON.stringify(a))}catch(d){}};m.getCache=function(b){try{return JSON.parse(localStorage.getItem(b))}catch(a){}return null};m.removeCache=function(b){localStorage.removeItem(b)};m.setEnumCache=function(b,a,d){this.memory.hasOwnProperty(b)||(this.memory[b]={});this.memory[b]||(this.memory[b]={});this.memory[b][a]=d};m.getEnumCache=function(b,a){this.memory.hasOwnProperty(b)||(this.memory[b]={});this.memory[b]||
(this.memory[b]={});return this.memory[b][a]};m.getEnumAllCache=function(b){this.memory.hasOwnProperty(b)||(this.memory[b]={});this.memory[b]||(this.memory[b]={});return this.memory[b]};m.existEnumCache=function(b,a){if(!this.memory.hasOwnProperty(b)||!this.memory[b])return!1;b=this.getEnumCache(b,a);return!Ext.isEmpty(b)};m.clearEnumCache=function(b){delete this.memory[b];this.memory[b]=null};m.memory={};return m}();c.Cache=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.getLoginCaptchaCmp=function(){return"normal"===c.System.getExt("login-type").value?{xtype:"label",hidden:!0}:window.showValidCaptcha&&Ext.isFunction(window.showValidCaptcha)?this.getClickCaptchaCmp():this.getNormalCaptchaCmp()};m.getNormalCaptchaCmp=function(){return{xtype:"fieldcontainer",labelWidth:0,anchor:"100%",itemId:"captcha",layout:{type:"hbox",align:"stretch"},refreshCode:function(){try{var b=this.query("#imgCode")[0],a=this.query("#validateCode")[0];
a&&(a.setValue(null),b.setSrc("showCaptcha?t\x3d"+Math.random()))}catch(d){console.error(d)}},items:[{xtype:"textfield",fieldLabel:'\x3csvg class\x3d"svgIcon" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extLoginCode"\x3e\x3c/use\x3e\x3c/svg\x3e',labelAlign:"right",labelWidth:2*c.Base.getNumberValue(c.System.fontSize),labelSeparator:"",labelStyle:"font-size: 20px !important;color: #888888;",margin:"10 10 0 0",allowBlank:!1,flex:1,name:"validateCode",itemId:"validateCode",letterKeyboard:!0,emptyText:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",
blankText:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"},{xtype:"image",margin:"10 10 0 0",width:74,cls:"validCodeImg",itemId:"imgCode",height:34,listeners:{click:{element:"el",fn:function(){this.component.up("#captcha").refreshCode()}}}}]}};m.getClickCaptchaCmp=function(){var b=2*c.Base.getNumberValue(c.System.fontSize),a=c.Base.buildOnlyCode("CK");return{xtype:"fieldcontainer",labelWidth:0,anchor:"100%",itemId:"captcha",layout:{type:"hbox",align:"stretch"},refreshCode:function(){var d=this.down("#validateCodeTip");
d&&(d.setValue(null),d.removeCls("validSuccess"),d.setFieldLabel('\x3csvg class\x3d"svgIcon" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extPower"\x3e\x3c/use\x3e\x3c/svg\x3e'))},showValid:function(){var d=this;window.showValidCaptcha(d,function(e){var f=d.down("#validateCodeTip");e.success?(f.setValue("\u5b89\u5168\u9a8c\u8bc1\u901a\u8fc7\uff01"),f.setFieldLabel('\x3csvg class\x3d"svgIcon extRole" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extLoginCode"\x3e\x3c/use\x3e\x3c/svg\x3e'),f.addCls("validSuccess"),
f.clearInvalid()):d.refreshCode()},a)},items:[{xtype:"hiddenfield",name:"captchaKey",value:a},{xtype:"textfield",fieldLabel:'\x3csvg class\x3d"svgIcon" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extPower"\x3e\x3c/use\x3e\x3c/svg\x3e',labelAlign:"right",labelWidth:b,labelSeparator:"",labelStyle:"font-size: 20px !important;color: #888888;",margin:"10 10 0 0",allowBlank:!1,flex:1,name:"@",itemId:"validateCodeTip",letterKeyboard:!0,emptyText:"\u8bf7\u60a8\u5b8c\u6210\u5b89\u5168\u9a8c\u8bc1",blankText:"\u8bf7\u60a8\u5148\u5b8c\u6210\u5b89\u5168\u9a8c\u8bc1",
triggers:{openValide:{cls:"extIcon extMouseClick",hideOnReadOnly:!1,handler:function(){Ext.isEmpty(this.getValue())?this.up("#captcha").showValid():c.Dialog.toast("\u60a8\u5df2\u901a\u8fc7\u5b89\u5168\u9a8c\u8bc1\uff0c\u65e0\u9700\u518d\u6b21\u9a8c\u8bc1\uff01")}}},listeners:{render:function(){Ext.isFunction(this.setReadOnlyAttr)&&this.setReadOnlyAttr(!0)}}}]}};return m}();c.Captcha=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.toColor=function(b,a){Ext.isEmpty(a)&&(a="#FFFFFF");if(Ext.isEmpty(b))return a;if(b.toString().startWith("#"))return b.toString();try{b=b.toString().replaceAll(" ","");var d=Ext.ux.colorpick.ColorUtils.parseColor(b);return"#"+Ext.ux.colorpick.ColorUtils.formats.HEX8(d)}catch(e){}return"#"+b};m.showColorPicker=function(b,a,d){Ext.isEmpty(a)&&(a="#42445a");return new Ext.Promise(function(e,f){var g=function(){c.Color.loadedPickrJs=!0;Ext.create("Ext.menu.Menu",
{showSeparator:!1,layout:"border",padding:"0 0 0 0",style:{background:"#ffffff"},alwaysOnTop:!0,width:250,height:320,listeners:{hide:function(h,k){h.close();c.Base.runCallBack(e)}},items:[{xtype:"container",region:"center",margin:"0 0 0 0",border:0,listeners:{afterrender:function(){(new Pickr({el:c.Base.getTargetBodyElement(this),theme:"monolith",inline:!0,default:a,showAlways:!0,useAsButton:!0,swatches:"rgba(244, 67, 54, 1);rgba(233, 30, 99, 0.95);rgba(156, 39, 176, 0.9);rgba(103, 58, 183, 0.85);rgba(63, 81, 181, 0.8);rgba(33, 150, 243, 0.75);rgba(3, 169, 244, 0.7);rgba(0, 188, 212, 0.7);rgba(0, 150, 136, 0.75);rgba(76, 175, 80, 0.8);rgba(139, 195, 74, 0.85);rgba(205, 220, 57, 0.9);rgba(255, 235, 59, 0.95);rgba(255, 193, 7, 1)".split(";"),
components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,input:!0,rgba:!0}}})).on("change",function(h,k,l){Ext.isFunction(d)&&d(h,k,l)})}}}]}).showBy(b)};c.Color.loadedPickrJs?g():c.System.addScript({src:c.Color.pickrJsPath},function(){c.System.addStylesheet({href:c.Color.pickrThemePath},g)})})};m.pickrJsPath="base/colorpicker/pickr.es5.min.js";m.pickrThemePath="base/colorpicker/monolith.min.css";return m}();c.Color=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.shakeComment=function(b,a,d){if(b){b.zIndexManager&&b.toFront(!0);d||(d=1588);try{var e=b.getX(),f=b.getY(),g=0,h=function(){clearInterval(k);b.setX(e);b.setY(f);Ext.isFunction(a)&&a()};var k=setInterval(function(){try{var l=g/180*Math.PI,n=6*Math.cos(l);b.setX(e+6*Math.sin(l));b.setY(f+n);(g+=90)>d&&h()}catch(p){h()}},30)}catch(l){}}};m.isCenterByContainer=function(b){var a=b.ownerCt;Ext.isEmpty(a)&&(a=b.container);b.constrain&&(a=b.constrainTo);if(a){var d=
parseInt(((a.getWidth()-b.getWidth())/2).toFixed(0));a=parseInt(((a.getHeight()-b.getHeight())/2).toFixed(0));console.log("preX",d,"preY",a);console.log("X",b.x,"Y",b.y);if(d==b.x&&a==b.y)return!0}return!1};m.isSameByContainer=function(b,a){var d=b.ownerCt;Ext.isEmpty(d)&&(d=b.container);b.constrain&&(d=b.constrainTo);b=a.ownerCt;Ext.isEmpty(b)&&(b=a.container);a.constrain&&(b=a.constrainTo);return d&&b?d.id==b.id:!1};m.futureQuery=function(b,a,d,e){Ext.isEmpty(d)&&(d=-1);Ext.isEmpty(e)&&(e=Ext.ComponentQuery);
var f="FutureQueryTimeout"+$.md5(b),g=function(h,k){c.Component[f]&&clearTimeout(c.Component[f]);h*k>=d&&0<d?a():c.Component[f]=setTimeout(function(){var l=e.query(b);l&&0<l.length&&a(l)||g(h+1,k+10*h)},k)};g(1,0)};m.countVisible=function(b){for(var a=0,d=0;d<b.length;d++)b[d].isHidden()||a++;return a};m.getMaxZIndex=function(b){for(var a=$("body").children(),d=0;d<a.length;d++)if($(a[d]).is(":visible")){var e=parseInt(a[d].style.zIndex||0);e!==c.Component.pageMaxZIndex&&(b=Math.max(b,e))}return b};
m.getTargetElement=function(b){if(b){if(Ext.isElement(b))return b;if(!Ext.isEmpty(b.xtype)&&b.getEl())return b.getEl().dom}return null};m.getTargetBodyElement=function(b){return b&&!Ext.isEmpty(b.xtype)&&b.body?b.body.dom:this.getTargetElement(b)};m.pageMaxZIndex=2147483647;return m}();c.Component=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){m.initDateFormatStore()}m.initDateFormatStore=function(){m.dateFormatStore["[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}"]="Y-m-d H:i:s";m.dateFormatStore["[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}:[0-9]{2}"]="Y-m-d H:i";m.dateFormatStore["[0-9]{4}-[0-9]{2}-[0-9]{2} [0-9]{2}"]="Y-m-d H";m.dateFormatStore["[0-9]{4}-[0-9]{2}-[0-9]{2}"]="Y-m-d";m.dateFormatStore["[0-9]{4}/[0-9]{2}/[0-9]{2} [0-9]{2}:[0-9]{2}:[0-9]{2}"]="Y/m/d H:i:s";m.dateFormatStore["[0-9]{4}/[0-9]{2}/[0-9]{2} [0-9]{2}:[0-9]{2}"]=
"Y/m/d H:i";m.dateFormatStore["[0-9]{4}/[0-9]{2}/[0-9]{2} [0-9]{2}"]="Y/m/d H";m.dateFormatStore["[0-9]{4}/[0-9]{2}/[0-9]{2}"]="Y/m/d";m.dateFormatStore["[0-9]{4}\u5e74[0-9]{2}\u6708[0-9]{2}\u65e5 [0-9]{2}:[0-9]{2}:[0-9]{2}"]="Y\u5e74m\u6708d\u65e5 H:i:s";m.dateFormatStore["[0-9]{4}\u5e74[0-9]{2}\u6708[0-9]{2}\u65e5 [0-9]{2}:[0-9]{2}"]="Y\u5e74m\u6708d\u65e5 H:i";m.dateFormatStore["[0-9]{4}\u5e74[0-9]{2}\u6708[0-9]{2}\u65e5 [0-9]{2}"]="Y\u5e74m\u6708d\u65e5 H";m.dateFormatStore["[0-9]{4}\u5e74[0-9]{2}\u6708[0-9]{2}\u65e5"]=
"Y\u5e74m\u6708d\u65e5"};m.formatMillisecond=function(b,a){return Ext.Date.format(new Date(b),a)};m.formatDateStr=function(b,a){return Ext.Date.format(c.Dates.parseDate(b),a)};m.guessDateFormat=function(b){if(!b||Ext.isDate(b))return"";b=b.toString().trim();b=b.trim("/");b=b.trim("-");for(var a in m.dateFormatStore)if((new RegExp("^"+a+"$")).test(b))return m.dateFormatStore[a];return""};m.parseDate=function(b){if(Ext.isEmpty(b))return null;var a=c.Dates.guessDateFormat(b);return Ext.Date.parse(b,
a)};m.showDatePicker=function(b,a,d){return new Ext.Promise(function(e,f){var g=(new Date).getTime();Ext.isEmpty(d)&&(d="Y-m-d H:i:s");f=[];for(var h=0;24>h;h++){var k=c.Base.prefixInteger(h,2);f.push({text:k})}var l=[];for(h=0;60>h;h++)k=c.Base.prefixInteger(h,2),l.push({text:k});var n;Ext.isEmpty(a)||(n=Ext.Date.parse(a,c.Dates.guessDateFormat(a)));n||(n=new Date);h=Ext.Date.format(n,"H");k=Ext.Date.format(n,"i");var p=Ext.Date.format(n,"s"),q=0,r=-1!==d.indexOf("d"),u=-1!==d.indexOf("H"),t=-1!==
d.indexOf("i"),w=-1!==d.indexOf("s");u&&q++;t&&q++;w&&q++;var z={xtype:"datepicker",id:"dateValue"+g,region:"center",showToday:!1,margin:"0 0 0 0",border:0,value:n};r||(z={xtype:"monthpicker",id:"dateValue"+g,region:"center",showButtons:!1,margin:"0 0 0 0",border:0,value:n});var x=Ext.create("Ext.menu.Menu",{showSeparator:!1,layout:"border",padding:"0 0 0 0",style:{background:"#ffffff"},alwaysOnTop:!0,width:330,height:400,listeners:{hide:function(y,A){c.Base.runCallBack(e);y.close()}},items:[z,{xtype:"container",
layout:"column",margin:"0 0 0 0",region:"south",border:0,items:[{xtype:"container",columnWidth:1,layout:"column",border:0,margin:"10 0 0 0",items:[{id:"hourValue"+g,columnWidth:1/q,emptyText:"\u65f6",minValue:0,margin:"0 0 0 5",maxValue:23,displayField:"text",valueField:"text",editable:!0,searchable:!0,hidden:!u,value:h,store:Ext.create("Ext.data.Store",{autoLoad:!0,data:f}),xtype:"combo"},{xtype:"displayfield",width:30,hidden:!u,value:"\x3cdiv align\x3d'center'\x3e\u65f6\x3c/div\x3e"},{id:"minuteValue"+
g,columnWidth:1/q,emptyText:"\u5206",minValue:0,maxValue:59,displayField:"text",valueField:"text",editable:!0,searchable:!0,value:k,hidden:!t,store:Ext.create("Ext.data.Store",{autoLoad:!0,data:l}),xtype:"combo"},{xtype:"displayfield",width:30,hidden:!t,value:"\x3cdiv align\x3d'center'\x3e\u5206\x3c/div\x3e"},{id:"secondsValue"+g,columnWidth:1/q,emptyText:"\u79d2",minValue:0,maxValue:59,displayField:"text",valueField:"text",editable:!0,searchable:!0,value:p,hidden:!w,store:Ext.create("Ext.data.Store",
{autoLoad:!0,data:l}),xtype:"combo"},{xtype:"displayfield",width:30,hidden:!w,value:"\x3cdiv align\x3d'center'\x3e\u79d2\x3c/div\x3e"}]},{xtype:"button",columnWidth:.3,margin:"5 0 5 5",iconCls:"extIcon extClose",text:"\u53d6\u6d88",handler:function(){x.hide()}},{xtype:"button",columnWidth:.7,margin:"5 5 5 5",iconCls:"extIcon extOk",text:"\u786e\u5b9a",handler:function(){var y=Ext.getCmp("dateValue"+g),A=Ext.getCmp("hourValue"+g),B=Ext.getCmp("minuteValue"+g),D=Ext.getCmp("secondsValue"+g);y=y.getValue();
Ext.isDate(y)?(y.setHours(parseInt(A.getValue())),y.setMinutes(parseInt(B.getValue())),y.setSeconds(parseInt(D.getValue())),c.Base.runCallBack(e,Ext.Date.format(y,d))):(A=new Date,A.setMonth(y[0]),A.setFullYear(y[1]),A.setDate(1),c.Base.runCallBack(e,Ext.Date.format(A,d)));x.close()}}]}]});x.showBy(b)})};m.formatDateTip=function(b,a,d){Ext.isEmpty(a)&&(a="Y-m-d H:i:s");var e=864E5,f=7*e,g=30*e,h=(new Date).getTime();if(!b)return null;var k=b.getTime(),l=Math.abs(h-k);h=h<k?"\u540e":"\u524d";k="";
var n=Ext.Date.format(b," H\u65f6i\u5206");d&&(k="\uff08\u5468"+"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split("")[b.getDay()]+"\uff09");if(6E4>=l)return"\u521a\u521a";if(2<=l/g)return Ext.Date.format(b,a);if(1<=l/g)return parseInt(String(l/g))+"\u4e2a\u6708"+h+k;if(1<=l/f)return b=parseInt(String(l/f)),b+"\u5468"+h+k;if(1<=l/e){b=parseInt(String(l/e));if(1==b){if("\u524d"==h)return"\u6628\u5929"+n+k;if("\u540e"==h)return"\u660e\u5929"+n+k}return b+"\u5929"+h+k}return 1<=l/36E5?parseInt(String(l/
36E5))+"\u5c0f\u65f6"+h+k:1<=l/6E4?parseInt(String(l/6E4))+"\u5206\u949f"+h+k:Ext.Date.format(b,a)};m.dateFormatStore={};return m}();c.Dates=v})(FastExt||(FastExt={}));var FastDefine;
(function(c){var v=function(){return function(){Ext.define("Fast.ext.EnumComboBox",{alias:["widget.enumcombobox","widget.enumcombo"],extend:"Ext.form.field.ComboBox",enumName:"NONE",enumValue:"id",enumText:"text",exclude:[],include:[],params:{},firstData:null,lastData:null,editable:!1,useCache:!0,searchable:!1,newable:!1,onFastContainerShow:function(){this.reloadEnum(!1)},onFastInputClick:function(){this.readOnly||this.disabled||this.toggle()},onFastEnumFilter:function(b){return this.exclude.exists(b.get(this.enumValue))?
!1:0<this.include.length?!!this.include.exists(b.get(this.enumValue)):!0},reloadEnum:function(b){var a=this;Ext.isEmpty(b)&&(b=!0);if(a.hasListener("beforeloadenum")&&!a.fireEvent("beforeloadenum",a))return!1;FastExt.Store.getEnumDataStore(a.enumName,a.firstData,a.lastData,a.params,a.useCache,b).then(function(d){a.setStore(d);d.filterBy(a.onFastEnumFilter,a)})},initComponent:function(){this.displayField=this.enumText;this.valueField=this.enumValue;this.emptyText="\u8bf7\u9009\u62e9";this.exclude||
(this.exclude=[]);this.include||(this.include=[]);this.callParent(arguments)},finishRender:function(){this.callParent(arguments);this.inputEl.on("click",this.onFastInputClick,this);var b=this.up("window");if(b&&!FastExt.Base.toBool(b.shown))b.on("show",this.onFastContainerShow,this,{single:!0});else this.reloadEnum(!1)}})}}();c.EnumComboBox=v;v=function(){return function(){Ext.define("Fast.ext.TagEnumComboBox",{alias:["widget.tagenumcombobox","widget.tagenumcombo"],extend:"Ext.form.field.Tag",enumName:"NONE",
enumValue:"id",enumText:"text",exclude:[],include:[],params:{},firstData:null,lastData:null,queryMode:"local",reloadEnum:function(b){var a=this;Ext.isEmpty(b)&&(b=!0);FastExt.Store.getEnumDataStore(a.enumName,a.firstData,a.lastData,a.params,a.useCache,b).then(function(d){a.setStore(d);a.getStore().filterBy(function(e){return a.exclude.exists(e.get(a.enumValue))?!1:0<a.include.length?!!a.include.exists(e.get(a.enumValue)):!0})})},initComponent:function(){this.displayField=this.enumText;this.valueField=
this.enumValue;this.emptyText="\u8bf7\u9009\u62e9";this.exclude||(this.exclude=[]);this.include||(this.include=[]);this.callParent(arguments)},onFastContainerShow:function(){this.reloadEnum(!1)},finishRender:function(){this.callParent(arguments);var b=this.up("window");if(b&&!FastExt.Base.toBool(b.shown))b.on("show",this.onFastContainerShow,this,{single:!0});else this.reloadEnum(!1)}})}}();c.TagEnumComboBox=v;v=function(){return function(){Ext.define("Fast.ext.FastFile",{extend:"Ext.form.field.Text",
alias:["widget.fastfile","widget.fastfilefield"],fileModules:[],editable:!1,onFileChange:function(b){},onFastInputClick:function(){this.readOnly||this.disabled||this.selectData()},finishRender:function(){this.callParent(arguments);this.inputEl.on("click",this.onFastInputClick,this)},onChange:function(b,a){this.callParent(arguments);Ext.isEmpty(b)?(this.getTrigger("open").hide(),this.getTrigger("close").hide()):(this.getTrigger("open").show(),this.getTrigger("close").show())},initComponent:function(){for(var b=
"",a=0;a<this.fileModules.length;a++)b=b+"\u6216"+this.fileModules[a].tipMsg;this.emptyText="\u8bf7\u4e0a\u4f20"+b.substring(1);this.editable=!1;this.callParent(arguments)},triggers:{open:{cls:"extIcon extEye",hidden:!0,handler:function(){var b=this;if(1===b.fileModules.length){if("images"===b.fileModules[0].type){b.getEditorMenu()&&(b.getEditorMenu().holdShow=!0);b.blur();FastExt.Dialog.showImage(b,b.getValue(),function(){b.getEditorMenu()&&(b.getEditorMenu().holdShow=!1)},!0);return}if("videos"===
b.fileModules[0].type){FastExt.Dialog.showVideo(this,b.getValue());return}}if(b.fileObj){var a=b.fileObj.name;if(FastExt.FileModule.image().match(a)){FastExt.Dialog.showImage(b,b.getValue(),null,!0);return}if(FastExt.FileModule.mp4().match(a)){FastExt.Dialog.showVideo(this,b.getValue());return}if(FastExt.FileModule.pdf().match(a)||FastExt.FileModule.word().match(a)||FastExt.FileModule.excel().match(a)||FastExt.FileModule.ppt().match(a)){FastExt.File.officeViewer(b.getValue());return}}location.href=
b.getValue()}},search:{cls:"extIcon extUpload",handler:function(){this.selectData()}},close:{cls:"text-clear",hidden:!0,handler:function(){this.clearData()}}},selectData:function(){var b=this;b.getEditorMenu()&&(b.getEditorMenu().holdShow=!0);FastExt.File.uploadFile(b,b.fileModules).then(function(a){b.getEditorMenu()&&(b.getEditorMenu().holdShow=!1);a&&(b.fileObj=a,b.setValue(a.url),b.onFileChange(a))})},clearData:function(){this.setValue(null)}})}}();c.FastFileField=v;v=function(){return function(){Ext.define("Fast.ext.FastFiles",
{alias:["widget.fastfiles","widget.fastfilesfield"],extend:"Ext.form.field.Text",editable:!1,fileModules:[],allowBlank:!0,autoUpdate:!1,showFileName:!1,showFileLength:!1,autoFileName:!0,submitArray:!1,triggers:{search:{cls:"text-search",handler:function(){this.showWindow(this)}}},finishRender:function(){this.callParent(arguments);this.inputEl.on("click",this.onFastInputClick,this)},onFastInputClick:function(){this.readOnly||this.disabled||this.showWindow(this)},initComponent:function(){for(var b=
"",a=0;a<this.fileModules.length;a++)b=b+"\u6216"+this.fileModules[a].tipMsg;this.emptyText="\u8bf7\u4e0a\u4f20"+b.substring(1);this.editable=!1;this.submitArray&&(b=this.up("form"))&&b.add({xtype:"hiddenfield",name:this.name+"@JsonArray",value:!0});this.callParent(arguments)},showWindow:function(b,a,d){var e=this;FastExt.File.showFiles(this,function(f){e.setValue(f);Ext.isFunction(a)&&a(e)},e.fileModules,e.getValue(),d,e.readOnly)}})}}();c.FastFilesField=v;v=function(){return function(){Ext.define("Fast.ext.Content",
{alias:["widget.content","widget.contentfield"],extend:"Ext.form.field.TextArea",height:220,emptyText:"\u8bf7\u586b\u5199\u2026\u2026",allowBlank:!0,buttons:[],getCode:function(){return $.md5(this.getName()+this.dataIndex+this.getFieldLabel())},showWindow:function(b,a,d){Ext.isEmpty(d)&&(d="\u7f16\u8f91\u5185\u5bb9");var e=Ext.create({xtype:"contentfield",value:this.value});e.oldValue=e.getValue();e.userCls="radiusNullField";for(var f=parseInt((.6*document.body.clientWidth).toFixed(0)),g=parseInt((.7*
document.body.clientHeight).toFixed(0)),h=0,k=e.buttons;h<k.length;h++)k[h].field=e;e.editorWin=Ext.create("Ext.window.Window",{title:d,iconCls:"extIcon extEdit",resizable:!0,maximizable:!0,height:g,width:f,minHeight:500,minWidth:600,layout:"fit",animateTarget:b,items:[e],modal:!0,unpin:!0,constrain:!0,listeners:{show:function(l){FastExt.Server.showExtConfig(e.getCode(),"TextEditorCache",function(n,p){n&&(e.setValue(p),FastExt.Dialog.toast("\u5df2\u6062\u590d\u6682\u5b58\u7684\u6570\u636e\uff01"))})}},
buttons:Ext.Array.insert([{text:"\u6e05\u9664\u6682\u5b58",iconCls:"extIcon extDelete whiteColor",handler:function(){FastExt.Dialog.showWait("\u6b63\u5728\u6e05\u9664\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");FastExt.Server.deleteExtConfig(e.getCode(),"TextEditorCache",function(l){FastExt.Dialog.hideWait();l&&FastExt.Dialog.toast("\u6e05\u9664\u6210\u529f\uff01")})}},"-\x3e",{text:"\u6682\u5b58",iconCls:"extIcon extSave whiteColor",handler:function(){FastExt.Dialog.showWait("\u6682\u5b58\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");
FastExt.Server.saveExtConfig(e.getCode(),"TextEditorCache",e.getValue(),function(l,n){FastExt.Dialog.hideWait();l?FastExt.Dialog.toast("\u6682\u5b58\u6210\u529f\uff01"):FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",n)})}},{text:"\u91cd\u7f6e",iconCls:"extIcon extReset",handler:function(){e.setValue(e.oldValue);FastExt.Server.deleteExtConfig(e.getCode(),"TextEditorCache")}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){FastExt.Dialog.showWait("\u8bf7\u7a0d\u540e\u2026\u2026");
FastExt.Server.deleteExtConfig(e.getCode(),"TextEditorCache",function(l){FastExt.Dialog.hideWait();Ext.isFunction(a)&&a(e);e.editorWin.close()})}}],2,this.buttons)});e.editorWin.show()}})}}();c.ContentField=v;v=function(){return function(){Ext.define("Fast.ext.HtmlContent",{alias:["widget.htmlcontent","widget.htmlcontentfield"],extend:"Ext.form.field.TextArea",buttons:[],initEditorConfig:function(b){return b},height:420,getCode:function(){return $.md5(this.getName()+this.dataIndex+this.getFieldLabel())},
getValue:function(){this.tinyEditor&&this.tinyEditor.save();return this.callParent(arguments)},getRawValue:function(){return this.tinyEditor?this.tinyEditor.getContent():this.callParent(arguments)},setValue:function(b){this.callParent(arguments);this.tinyEditor&&this.tinyEditor.setContent(b);return this},beforeDestroy:function(){try{this.releaseEditor()}finally{this.callParent(arguments)}},releaseEditor:function(){this.tinyEditor&&(this.tinyEditor.destroy(),this.tinyEditor=null)},initEditor:function(){var b=
this,a={selector:"#"+b.getInputId(),language:"zh-Hans",menubar:"file edit view insert format tools table tc",toolbar1:"fullscreen searchreplace undo redo  bold italic underline strikethrough  fontfamily fontsize blocks  alignleft aligncenter alignright alignjustify  outdent indent  numlist bullist checklist  forecolor backcolor casechange permanentpen formatpainter removeformat  pagebreak charmap emoticons  preview save print  image media pageembed template link anchor codesample insertdatetime  a11ycheck ltr rtl showcomments addcomment ",
toolbar_sticky:!0,forced_root_block:"div",branding:!1,resize:!1,convert_urls:!1,height:"100%",width:"100%",autosave_ask_before_unload:!1,powerpaste_allow_local_images:!0,spellchecker_dialog:!0,a11y_advanced_options:!0,image_advtab:!0,font_size_formats:"8pt 9pt 10pt 11pt 12pt 13pt 14pt 15pt 16pt 17pt 18pt 19pt 20pt 21pt 22pt 23pt 24pt 36pt",font_family_formats:"\u5fae\u8f6f\u96c5\u9ed1\x3d'\u5fae\u8f6f\u96c5\u9ed1';\u5b8b\u4f53\x3d'\u5b8b\u4f53';\u9ed1\u4f53\x3d'\u9ed1\u4f53';\u4eff\u5b8b\x3d'\u4eff\u5b8b';\u6977\u4f53\x3d'\u6977\u4f53';\u96b6\u4e66\x3d'\u96b6\u4e66';\u5e7c\u5706\x3d'\u5e7c\u5706';Andale Mono\x3dandale mono,times;Arial\x3darial,helvetica,sans-serif;Arial Black\x3darial black,avant garde;Book Antiqua\x3dbook antiqua,palatino;Comic Sans MS\x3dcomic sans ms,sans-serif;Courier New\x3dcourier new,courier;Georgia\x3dgeorgia,palatino;Helvetica\x3dhelvetica;Impact\x3dimpact,chicago;Symbol\x3dsymbol;Tahoma\x3dtahoma,arial,helvetica,sans-serif;Terminal\x3dterminal,monaco;Times New Roman\x3dtimes new roman,times;Trebuchet MS\x3dtrebuchet ms,geneva;Verdana\x3dverdana,geneva;Webdings\x3dwebdings;Wingdings\x3dwingdings",
pagebreak_separator:'\x3cdiv style\x3d"page-break-before: always;"\x3e\x3c/div\x3e',pagebreak_split_block:!0,file_picker_types:"file image media",automatic_uploads:!1,content_style:"tr {  page-break-inside: avoid; }",file_picker_callback:function(d,e,f){"file"===f.filetype?FastExt.File.uploadFile(null,[FastExt.FileModule.file()],!1,!1).then(function(g){g&&d(g.url,{text:g.name})}):"image"===f.filetype?FastExt.File.uploadFile(null,[FastExt.FileModule.image()],!1,!1).then(function(g){g&&d(g.url,{alt:g.name})}):
"media"===f.filetype&&FastExt.File.uploadFile(null,[FastExt.FileModule.mp4()],!1,!1).then(function(g){g&&d(g.url,{text:g.name})})},plugins:"advlist anchor autolink charmap emoticons importcss nonbreaking pagebreak visualchars codesample fullscreen image lists link media preview searchreplace table visualblocks wordcount insertdatetime directionality code".split(" ")};a=b.initEditorConfig(a);FastExt.Tinymce.initTinymce(a,function(d){b.tinyEditor=d[0];(d=b.up("window"))&&$(".tox-tinymce-aux").prependTo(d.getEl().dom);
b.ownerCt&&b.ownerCt.updateLayout();b.needFocus&&(b.tinyEditor.focus(!1),b.needFocus=!1);b.fireEvent("editorrender",b,b.tinyEditor)})},finishRender:function(){this.callParent(arguments);var b=this.up("window");if(b&&!FastExt.Base.toBool(b.shown))b.on("show",this.onFastContainerShow,this,{single:!0});else this.initEditor()},onFastContainerShow:function(){this.initEditor()},initComponent:function(){this.callParent(arguments)},showWindow:function(b,a,d){Ext.isEmpty(d)&&(d="\u7f16\u8f91\u5185\u5bb9");
var e=Ext.create({xtype:"htmlcontentfield",value:this.value});e.oldValue=e.value;for(var f=parseInt((.6*document.body.clientWidth).toFixed(0)),g=parseInt((.8*document.body.clientHeight).toFixed(0)),h=0,k=e.buttons;h<k.length;h++)k[h].field=e;e.editorWin=Ext.create("Ext.window.Window",{title:d,iconCls:"extIcon extEdit",resizable:!0,maximizable:!0,height:g,width:f,minHeight:500,minWidth:600,layout:"fit",animateTarget:b,items:[e],modal:!0,constrain:!0,unpin:!0,listeners:{show:function(){FastExt.Server.showExtConfig(e.getCode(),
"HtmlEditorCache",function(l,n){l&&(e.setValue(n),FastExt.Dialog.toast("\u5df2\u6062\u590d\u6682\u5b58\u7684\u6570\u636e\uff01"))})}},buttons:Ext.Array.insert([{text:"\u6e05\u9664\u6682\u5b58",iconCls:"extIcon extDelete whiteColor",handler:function(){FastExt.Dialog.showWait("\u6b63\u5728\u6e05\u9664\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");FastExt.Server.deleteExtConfig(e.getCode(),"HtmlEditorCache",function(l){FastExt.Dialog.hideWait();l&&FastExt.Dialog.toast("\u6e05\u9664\u6210\u529f\uff01")})}},
"-\x3e",{text:"\u6682\u5b58",iconCls:"extIcon extSave whiteColor",handler:function(){FastExt.Dialog.showWait("\u6682\u5b58\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");FastExt.Server.saveExtConfig(e.getCode(),"HtmlEditorCache",e.getValue(),function(l,n){FastExt.Dialog.hideWait();l?FastExt.Dialog.toast("\u6682\u5b58\u6210\u529f\uff01"):FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",n)})}},{text:"\u91cd\u7f6e",iconCls:"extIcon extReset",handler:function(){e.setValue(e.oldValue);FastExt.Server.deleteExtConfig(e.getCode(),
"HtmlEditorCache")}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){FastExt.Dialog.showWait("\u8bf7\u7a0d\u540e\u2026\u2026");FastExt.Server.deleteExtConfig(e.getCode(),"HtmlEditorCache",function(l){FastExt.Dialog.hideWait();Ext.isFunction(a)&&a(e);e.editorWin.close()})}}],2,e.buttons)});e.editorWin.show()},focus:function(){this.needFocus=!0;return this.callParent(arguments)}})}}();c.HtmlContentField=v;v=function(){return function(){Ext.define("Fast.ext.Link",{alias:["widget.link",
"widget.linkfield"],extend:"Ext.form.FieldContainer",entityId:null,entityIdDefaultValue:-1,entityText:null,entityCode:null,linkValue:{},editable:!1,allowBlank:!0,layout:"fit",multiSelect:!1,autoDisabled:!0,submitValue:!0,onBeforeSelect:null,onAfterSelect:null,onClearSelect:null,nullEntityCodeError:"\u8bf7\u914d\u7f6e\u7ec4\u4ef6\u7684entityCode\u5c5e\u6027\u503c\uff01",nullEntityIdError:"\u8bf7\u914d\u7f6e\u7ec4\u4ef6\u7684entityId\u5c5e\u6027\u503c\uff01",nullEntityTextError:"\u8bf7\u914d\u7f6e\u7ec4\u4ef6\u7684entityText\u5c5e\u6027\u503c\uff01",
binds:[],isValid:function(){var b=this.down("[name\x3d"+this.name+"Display]");b.allowBlank=this.allowBlank;return b.isValid()},getName:function(){return this.name},getValue:function(){return this.submitValue?this.down("[name\x3d"+this.name+"]").getValue():this.getText()},getText:function(){return this.down("[name\x3d"+this.name+"Display]").getValue()},setRecordValue:function(b){if(b&&(!Ext.isEmpty(this.getText())||!Ext.isEmpty(b.get(this.dataIndex)))){b.store&&(b.store.holdUpdate=!0);b.set(this.name,
this.getValue());b.set(this.dataIndex,this.getText());if(this.record)for(var a=0;a<this.binds.length;a++){var d=this.binds[a].toString().split("@");if(1<d.length)for(var e=this.record.get(d[0]),f=1;f<d.length;f++)b.set(d[f],e)}b.store&&(b.store.holdUpdate=!1,b.store.fireEvent("endupdate"))}},setValue:function(b,a){var d=this.down("[name\x3d"+this.name+"Display]");d&&d.setValue(b);a&&this.setRawValue(a.get(this.name));b||(this.setRawValue(-1),this.down("[name\x3d"+this.name+"MoreFields]").removeAll(!0));
return this},setHtml:function(b){this.setValue(b)},setMultiValue:function(b,a){this.setRawValue(b[0],b.slice(1));this.setValue(a.join("#"));this.autoDisabled&&this.down("[name\x3d"+this.name+"Display]").setDisabled(!0)},getMultiValue:function(){var b=[],a=this.down("[name\x3d"+this.name+"]");a&&b.push(a.getValue());this.down("[name\x3d"+this.name+"MoreFields]").items.each(function(d){b.push(d.getValue())});return b},setRawValue:function(b,a){var d=this.down("[name\x3d"+this.name+"]");d&&d.setValue(b);
b=this.down("[name\x3d"+this.name+"MoreFields]");b.removeAll(!0);if(a)for(d=0;d<a.length;d++){var e=Ext.create({xtype:"hiddenfield",name:this.name});e.setValue(a[d]);b.add(e)}if(this.record)for(d=0;d<this.binds.length;d++)if(a=this.binds[d].toString().split("@"),1<a.length)for(var f=this.record.get(a[0]),g=1;g<a.length;g++)e=Ext.create({xtype:"hiddenfield",name:a[g]}),e.setValue(f),b.add(e)},getRawValue:function(){var b=this.down("[name\x3d"+this.name+"]");return b?b.getValue():null},getTriggers:function(){return this.down("[name\x3d"+
this.name+"Display]").getTriggers()},selectData:function(b){var a=this;if(!Ext.isFunction(a.onBeforeSelect)||a.onBeforeSelect(a))if(a.getEditorMenu()&&(a.getEditorMenu().holdShow=!0),a.entityCode)if(a.entityId)if(a.entityText){var d=FastExt.System.getEntity(a.entityCode);if(d)if(d.js){var e=eval("new "+a.entityCode+"()");Ext.isFunction(e.showSelect)?(a.down("[name\x3d"+a.name+"Display]").blur(),d=d.shortName,a.fieldLabel&&(d=a.fieldLabel),a.config&&a.config.fieldLabel&&(d=a.config.fieldLabel),a.labelTitle&&
(d=a.labelTitle),Ext.isEmpty(a.selectGridTitle)&&(a.selectGridTitle="\u9009\u62e9"+d),d=a.multiSelect,FastExt.Base.toBool(a.fromColumn)&&(d=!1),FastExt.Cache.memory["GridSelectHistory"+$.md5(a.selectGridTitle)]=a.records,e.showSelect(this,a.selectGridTitle,a.linkValue.where,d).then(function(f){try{if(f)if(Ext.isFunction(b))b(f);else{a.records=f;if(1===f.length){var g=f[0];a.record=g;var h=g.get(a.entityText),k=g.get(a.entityId);Ext.isEmpty(h)&&(h=k);a.setValue(h);a.setRawValue(k)}else if(1<f.length){a.record=
f[0];g="";for(var l=[],n=0;n<f.length;n++)h=f[n].get(a.entityText),k=f[n].get(a.entityId),Ext.isEmpty(h)&&(h=k),g+="#"+h,l.push(k);a.setRawValue(l[0],l.slice(1));a.setValue(g.substring(1))}if(Ext.isFunction(a.onAfterSelect))a.onAfterSelect(a)}}finally{a.getEditorMenu()&&(a.getEditorMenu().holdShow=!1)}})):FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","'"+a.entityCode+"' JS\u5bf9\u8c61\u4e0d\u5b58\u5728\u51fd\u6570showSelect(obj,callBack)\uff01",function(){a.getEditorMenu()&&(a.getEditorMenu().holdShow=
!1)})}else FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u672a\u83b7\u53d6\u5230 '"+a.entityCode+"' JS\u5bf9\u8c61\uff01",function(){a.getEditorMenu()&&(a.getEditorMenu().holdShow=!1)});else FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u672a\u83b7\u53d6\u5230 '"+a.entityCode+"' \u5b9e\u4f53\u7c7b\uff01",function(){a.getEditorMenu()&&(a.getEditorMenu().holdShow=!1)})}else FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",a.nullEntityTextError,function(){a.getEditorMenu()&&(a.getEditorMenu().holdShow=
!1)});else FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",a.nullEntityIdError,function(){a.getEditorMenu()&&(a.getEditorMenu().holdShow=!1)});else FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",a.nullEntityCodeError,function(){a.getEditorMenu()&&(a.getEditorMenu().holdShow=!1)})},clearData:function(){this.setValue(null);this.setRawValue(-1);this.down("[name\x3d"+this.name+"MoreFields]").removeAll(!0);this.record=this.records=null;if(Ext.isFunction(this.onClearSelect))this.onClearSelect(this)},
onFastInputClick:function(){this.readOnly||this.disabled||this.editable||this.selectData()},initComponent:function(){var b=this;if(FastExt.Listeners.onInitLinkFieldDefaultValue){var a=FastExt.Listeners.onInitLinkFieldDefaultValue(b);a&&(b.linkValue=b.linkValue?FastExt.Json.mergeJson(b.linkValue,a):a)}b.linkValue||(b.linkValue={},b.linkValue[b.entityId]=b.entityIdDefaultValue,b.linkValue[b.entityText]=null);b.linkValue.hasOwnProperty(b.entityId)||(b.linkValue[b.entityId]=b.entityIdDefaultValue);Ext.isEmpty(b.linkValue[b.entityId])&&
(b.linkValue[b.entityId]=b.entityIdDefaultValue);Ext.isEmpty(b.name)&&(b.name="LinkField"+Ext.now());a=b.linkValue[b.entityText];Ext.isEmpty(a)&&(a=b.value);a===this.entityIdDefaultValue&&(a="");for(var d=[],e=0;e<b.binds.length;e++){var f=b.binds[e].toString().split("@");if(1<f.length)for(var g=b.linkValue[f[0]],h=1;h<f.length;h++)d.push({xtype:"hiddenfield",name:f[h],value:g})}b.items=[{xtype:"hiddenfield",name:b.name,value:b.linkValue[b.entityId]},{xtype:"fieldcontainer",name:b.name+"MoreFields",
hidden:!0,items:d},{xtype:"textfield",name:b.name+"Display",editable:b.editable,parentXtype:b.xtype,value:a,disabled:!Ext.isEmpty(a)&&b.autoDisabled&&!FastExt.Base.toBool(b.fromHeadSearch,!1),hideLabel:!0,fieldLabel:b.fieldLabel,allowBlank:b.allowBlank,emptyText:b.selectGridTitle?b.selectGridTitle:"\u8bf7\u9009\u62e9"+FastExt.Base.toString(b.config.fieldLabel,""),listeners:{afterrender:function(k){k.inputEl.on("click",b.onFastInputClick,b)}},triggers:{close:{cls:"text-clear",handler:function(){b.clearData();
if(Ext.isFunction(b.onClearValue))b.onClearValue()}},search:{cls:"text-search",handler:function(){b.selectData();this.inputEl.blur()}}}}];b.callParent(arguments)}})}}();c.LinkField=v;v=function(){return function(){Ext.define("Fast.ext.Target",{alias:["widget.target","widget.targetfield"],extend:"Ext.form.FieldContainer",layout:"column",labelWidth:null,targetType:null,targetTypeReadOnly:!1,targetTypeEnum:null,targetId:null,targetValue:{},targetFunction:"getTargetEntity",targetEnumValue:"id",targetEnumText:"text",
include:[],exclude:[],onChangeTypeSelect:null,linkfieldConfig:{},enumcomboConfig:{},defaults:{labelWidth:84,margin:"5 5 5 5",labelAlign:"right",allowBlankTip:!0,allowBlank:!1,emptyText:"default"},hideLabel:!0,getValue:function(){return this.down("[name\x3d"+this.targetId+"]").getText()},setValue:function(b,a){var d=this.down("[name\x3d"+this.targetId+"]");d&&d.setValue(b);a&&(this.targetValue={},this.targetValue[this.targetType]=a.get(this.targetType),this.targetValue[this.targetId]=a.get(this.targetId),
this.holdIdValue=this.getTargetTypeValue()!=a.get(this.targetType),this.setTargetIdValue(a.get(this.targetId)),this.setTargetTypeValue(a.get(this.targetType)))},setHtml:function(b){this.setValue(b)},getSearchField:function(){},setRecordValue:function(b){b&&(b.store&&(b.store.holdUpdate=!0),this.targetId&&b.set(this.targetId,this.getTargetIdValue()),this.targetType&&b.set(this.targetType,this.getTargetTypeValue()),this.targetText&&this.targetText!=this.dataIndex&&b.set(this.targetText,this.getValue()),
b.set(this.dataIndex,this.getValue()),b.store&&(b.store.holdUpdate=!1,b.store.fireEvent("endupdate")))},setTargetTypeValue:function(b){var a=this.down("[name\x3d"+this.targetType+"]");a&&a.setValue(b)},getTargetTypeValue:function(){var b=this.down("[name\x3d"+this.targetType+"]");return b?b.getValue():0},setTargetIdValue:function(b){var a=this.down("[name\x3d"+this.targetId+"]");a&&a.setRawValue(b)},getTargetIdValue:function(){var b=this.down("[name\x3d"+this.targetId+"]");return b?b.getRawValue():
-1},getTargetEntity:function(b){if(0>b)return null;Ext.isEmpty(b)&&(b=0);var a=window[this.targetFunction](b,this.targetType);return a?a:(console.error("\u672a\u83b7\u53d6\u5230TargetType\u4e3a\uff1a"+b+"\u7684\u5b9e\u4f53\u914d\u7f6e\uff01"),null)},showWindow:function(b,a,d){Ext.isEmpty(d)&&(d="\u7f16\u8f91\u76ee\u6807\u6570\u636e");var e=Ext.create({xtype:"targetfield",targetType:this.targetType,targetTypeReadOnly:this.targetTypeReadOnly,targetTypeEnum:this.targetTypeEnum,targetId:this.targetId,
targetValue:this.targetValue,targetFunction:this.targetFunction,targetEnumValue:this.targetEnumValue,targetEnumText:this.targetEnumText,include:this.include,exclude:this.exclude});e.editorWin=Ext.create("Ext.window.Window",{title:d,height:200,width:400,layout:"fit",resizable:!1,modal:!0,constrain:!0,iconCls:"extIcon extLink",items:[e],animateTarget:b,buttons:[{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){e.editorWin.close()}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){e.editorWin.close();
Ext.isFunction(a)&&a(e)}}]});e.editorWin.show()},initComponent:function(){var b=this,a=b.fieldLabel;Ext.isEmpty(a)&&(a="\u76ee\u6807\u7c7b\u578b");b.fieldLabel="";b.margin="0 0 0 0";var d={};if(Ext.isFunction(window[b.targetFunction])){b.targetValue||(b.targetValue={},b.targetValue[b.targetType]=-1);b.targetValue[b.targetType]||(b.targetValue[b.targetType]=-1);b.targetEnum&&(b.targetTypeEnum=b.targetEnum);b.targetTypeEnum||(b.targetTypeEnum=b.targetType.replace(b.targetType[0],b.targetType[0].toUpperCase())+
"Enum");var e=b.targetValue[b.targetType],f=b.getTargetEntity(e),g="";f&&(g=f.entityComment,d[f.entityId]=b.targetValue[b.targetId],d[f.entityText]=b.targetValue.targetText);Ext.isEmpty(g)&&(g="");e={name:b.targetType,xtype:"enumcombo",fieldLabel:a,columnWidth:1,value:0<=e?e:null,emptyText:"\u8bf7\u9009\u62e9"+a,enumValue:b.targetEnumValue,enumText:b.targetEnumText,readOnly:b.targetTypeReadOnly,enumName:b.targetTypeEnum,exclude:b.exclude,include:b.include,parentXtype:b.xtype,listeners:{change:function(k,
l,n){if(n=b.getTargetEntity(l)){l=b.down("[name\x3d"+b.targetId+"]");l.entityCode=n.entityCode;l.entityId=n.entityId;l.entityText=n.entityText;if(b.holdIdValue){b.holdIdValue=!1;return}(n=b.down("[name\x3d"+b.targetId+"Display]"))&&n.setEmptyText("\u8bf7\u9009\u62e9"+k.getDisplayValue());l.selectGridTitle="\u8bf7\u9009\u62e9"+k.getDisplayValue();l.clearData()}if(Ext.isFunction(b.onChangeTypeSelect))b.onChangeTypeSelect(b);b.hasListener("change")&&b.fireEvent("change")}}};var h=b.fieldLabel2;Ext.isEmpty(h)&&
(h="\u76ee\u6807\u6570\u636e");a={name:b.targetId,xtype:"linkfield",fieldLabel:h,columnWidth:1,nullEntityCodeError:"\u8bf7\u5148\u9009\u62e9"+a,entityCode:f?f.entityCode:null,entityId:f?f.entityId:null,entityText:f?f.entityText:null,linkValue:d,selectGridTitle:"\u8bf7\u9009\u62e9"+g,multiSelect:b.multiSelect};b.items=[FastExt.Json.mergeJson(e,b.enumcomboConfig),FastExt.Json.mergeJson(a,b.linkfieldConfig)]}else FastExt.Dialog.showAlert("\u76ee\u6807\u7ec4\u4ef6\u9519\u8bef","\u672a\u68c0\u6d4b\u5230\u65b9\u6cd5"+
b.targetFunction+"!");b.callParent(arguments)}})}}();c.TargetField=v;v=function(){return function(){Ext.define("Fast.ext.Map",{alias:["widget.map","widget.mapfield"],extend:"Ext.form.FieldContainer",lngName:"lnt",latName:"lat",proName:null,cityName:null,areaName:null,editable:!1,allowBlank:!0,layout:"fit",submitValue:!0,isValid:function(){return this.down("[name\x3d"+this.name+"]").isValid()},getName:function(){return this.name},getValue:function(){return this.down("[name\x3d"+this.name+"]").getValue()},
setValue:function(b,a){var d=this.down("[name\x3d"+this.name+"]");d&&d.setValue(b);a&&(this.latName&&this.setLatValue(a.get(this.latName)),this.lngName&&this.setLngValue(a.get(this.lngName)),this.proName&&this.setProValue(a.get(this.proName)),this.cityName&&this.setCityValue(a.get(this.cityName)),this.areaName&&this.setAreaValue(a.get(this.areaName)))},setRecordValue:function(b){b&&(b.store&&(b.store.holdUpdate=!0),this.latName&&b.set(this.latName,this.getLatValue()),this.lngName&&b.set(this.lngName,
this.getLngValue()),this.proName&&b.set(this.proName,this.getProValue()),this.cityName&&b.set(this.cityName,this.getCityValue()),this.areaName&&b.set(this.areaName,this.getAreaValue()),b.set(this.name,this.getValue()),b.store&&(b.store.holdUpdate=!1,b.store.fireEvent("endupdate")))},setLatValue:function(b){var a=this.down("[name\x3d"+this.latName+"]");a&&a.setValue(b)},setLngValue:function(b){var a=this.down("[name\x3d"+this.lngName+"]");a&&a.setValue(b)},setProValue:function(b){var a=this.down("[name\x3d"+
this.proName+"]");a&&a.setValue(b)},setCityValue:function(b){var a=this.down("[name\x3d"+this.cityName+"]");a&&a.setValue(b)},setAreaValue:function(b){var a=this.down("[name\x3d"+this.areaName+"]");a&&a.setValue(b)},getLatValue:function(){var b=this.down("[name\x3d"+this.latName+"]");return b?b.getValue():0},getLngValue:function(){var b=this.down("[name\x3d"+this.lngName+"]");return b?b.getValue():0},getProValue:function(){var b=this.down("[name\x3d"+this.proName+"]");return b?b.getValue():null},
getCityValue:function(){var b=this.down("[name\x3d"+this.cityName+"]");return b?b.getValue():null},getAreaValue:function(){var b=this.down("[name\x3d"+this.areaName+"]");return b?b.getValue():null},selectData:function(){var b=this;b.getEditorMenu()&&(b.getEditorMenu().holdShow=!0);b.down("[name\x3d"+b.name+"]").blur();FastExt.Map.selAddressInMap(b,b.getLngValue(),b.getLatValue(),b.getValue()).then(function(a){a&&(b.setLatValue(a.lat),b.setLngValue(a.lng),b.setProValue(a.pro),b.setAreaValue(a.area),
b.setCityValue(a.city),b.setValue(a.addr));b.getEditorMenu()&&(b.getEditorMenu().holdShow=!1)})},clearData:function(){this.setValue(null);this.setLatValue(0);this.setLngValue(0)},onFastInputClick:function(){this.readOnly||this.disabled||this.editable||this.selectData()},initComponent:function(){var b=this;b.name||(b.name=b.dataIndex);Ext.isEmpty(b.name)&&(b.name="MapField"+Ext.now());b.items=[{xtype:"hiddenfield",name:b.lngName,value:0},{xtype:"hiddenfield",name:b.latName,value:0},{xtype:"hiddenfield",
name:b.proName},{xtype:"hiddenfield",name:b.cityName},{xtype:"hiddenfield",name:b.areaName},{xtype:"textfield",name:b.name,editable:b.editable,fieldLabel:b.fieldLabel,hideLabel:!0,allowBlank:b.allowBlank,emptyText:b.emptyText,parentXtype:b.xtype,listeners:{afterrender:function(a){a.inputEl.on("click",b.onFastInputClick,b)}},triggers:{close:{cls:"text-clear",handler:function(){b.clearData();if(Ext.isFunction(b.onClearValue))b.onClearValue()}},search:{cls:"text-search",handler:function(){b.selectData();
this.inputEl.blur()}}}}];b.callParent(arguments)}})}}();c.MapField=v;v=function(){return function(){Ext.define("Fast.ext.DateRange",{alias:["widget.daterange","widget.daterangefield"],extend:"Ext.form.field.Text",beginDate:null,endDate:null,editable:!0,allowBlank:!0,maxRangeDate:-1,maxRangeMonth:-1,maxRangeYear:-1,layout:"column",format:"Y-m-d",submitValue:!0,onAfterSelect:null,onClearValue:null,selectData:function(){var b=this;b.getEditorMenu()&&(b.getEditorMenu().holdShow=!0);var a=Ext.now(),d=
Ext.create("Ext.menu.Menu",{floating:!0,editorMenu:!0,items:[{xtype:"container",padding:"10 10 10 10",layout:"column",style:{background:"#ffffff",borderWidth:1,borderColor:"#ffffff",color:"#eeeee"},border:0,items:[{xtype:"combo",fieldLabel:"\u5feb\u901f\u9009\u62e9",valueField:"value",labelWidth:60,margin:"5 5 5 5",editable:!1,columnWidth:1,triggers:{close:{cls:"text-clear",handler:function(){this.setValue(null);b.clearData()}}},listeners:{change:function(e,f,g,h){f&&(b.endDate=Ext.Date.format(new Date,
b.format),6===f?b.beginDate=Ext.Date.format(new Date,b.format):1===f?b.beginDate=Ext.Date.format(Ext.Date.add(new Date,Ext.Date.DAY,-7),b.format):2===f?b.beginDate=Ext.Date.format(Ext.Date.add(new Date,Ext.Date.MONTH,-1),b.format):3===f?b.beginDate=Ext.Date.format(Ext.Date.add(new Date,Ext.Date.MONTH,-3),b.format):4===f?b.beginDate=Ext.Date.format(Ext.Date.add(new Date,Ext.Date.MONTH,-6),b.format):5===f&&(b.beginDate=Ext.Date.format(Ext.Date.add(new Date,Ext.Date.YEAR,-1),b.format)),(f=b.refreshValue())?
(FastExt.Dialog.toast(f),e.setValue(null),b.clearData(),FastExt.Component.shakeComment(d)):((e=Ext.getCmp("beginDate"+a))&&e.setValue(b.beginDate),(e=Ext.getCmp("endDate"+a))&&e.setValue(b.endDate)))}},store:Ext.create("Ext.data.Store",{data:[{text:"\u4eca\u5929",value:6},{text:"\u8fd1\u4e00\u5468",value:1},{text:"\u8fd1\u4e00\u4e2a\u6708",value:2},{text:"\u8fd1\u4e09\u4e2a\u6708",value:3},{text:"\u8fd1\u516d\u4e2a\u6708",value:4},{text:"\u8fd1\u4e00\u5e74",value:5}]})},{fieldLabel:"\u5f00\u59cb\u65e5\u671f",
margin:"5 5 5 5",xtype:"datefield",id:"beginDate"+a,columnWidth:1,labelWidth:60,format:b.format,value:b.beginDate,emptyText:"\u5f00\u59cb\u65e5\u671f"},{fieldLabel:"\u7ed3\u675f\u65e5\u671f",margin:"5 5 5 5",xtype:"datefield",id:"endDate"+a,columnWidth:1,labelWidth:60,format:b.format,value:b.endDate,emptyText:"\u7ed3\u675f\u65e5\u671f"},{xtype:"container",layout:"hbox",columnWidth:1,border:0,items:[{xtype:"button",text:"\u786e\u5b9a",margin:"5 5 5 5",flex:.42,handler:function(){var e=Ext.getCmp("beginDate"+
a).getValue(),f=Ext.getCmp("endDate"+a).getValue();b.beginDate=Ext.util.Format.date(e,b.format);b.endDate=Ext.util.Format.date(f,b.format);Ext.isEmpty(b.beginDate)&&(b.beginDate=Ext.Date.format(new Date(0),b.format));Ext.isEmpty(b.endDate)&&(b.endDate=Ext.Date.format(new Date,b.format));if(e=b.refreshValue())FastExt.Dialog.toast(e),FastExt.Component.shakeComment(d);else{if(Ext.isFunction(b.onAfterSelect))b.onAfterSelect(b);d.close()}}}]}]}],listeners:{hide:function(e,f){e.close()}}});d.setWidth(Math.max(this.getWidth(),
200));d.showBy(this,"tl-bl?")},clearData:function(){this.setValue(null);this.endDate=this.beginDate=null},refreshValue:function(){this.setValue(null);var b=Ext.Date.parse(this.beginDate,this.format),a=Ext.Date.parse(this.endDate,this.format);if(b>a)return this.clearData(),"\u5f00\u59cb\u65e5\u671f\u5fc5\u987b\u5c0f\u4e8e\u7b49\u4e8e\u7ed3\u675f\u65e5\u671f\uff01";if(0<this.maxRangeDate){var d=Ext.Date.add(b,Ext.Date.DAY,this.maxRangeDate);if(!Ext.Date.between(a,b,d))return this.clearData(),"\u65e5\u671f\u8303\u56f4\u533a\u95f4\u5fc5\u987b\u5728"+
this.maxRangeDate+"\u5929\u4ee5\u5185\uff01"}if(0<this.maxRangeMonth&&(d=Ext.Date.add(b,Ext.Date.MONTH,this.maxRangeMonth),!Ext.Date.between(a,b,d)))return this.clearData(),"\u65e5\u671f\u8303\u56f4\u533a\u95f4\u5fc5\u987b\u5728"+this.maxRangeMonth+"\u4e2a\u6708\u4ee5\u5185\uff01";if(0<this.maxRangeYear&&(d=Ext.Date.add(b,Ext.Date.YEAR,this.maxRangeYear),!Ext.Date.between(a,b,d)))return this.clearData(),"\u65e5\u671f\u8303\u56f4\u533a\u95f4\u5fc5\u987b\u5728"+this.maxRangeYear+"\u5e74\u4ee5\u5185\uff01";
this.setValue(this.beginDate+" \u81f3 "+this.endDate);Ext.Date.isEqual(b,a)&&this.setValue("\u4eca\u5929");return null},triggers:{close:{cls:"text-clear",handler:function(){this.clearData();if(Ext.isFunction(this.onClearValue))this.onClearValue()}},search:{cls:"text-search",handler:function(){this.selectData();this.inputEl.blur()}}},initComponent:function(){this.editable=!1;this.refreshValue();this.callParent(arguments)}})}}();c.DateRangeField=v;v=function(){return function(){Ext.define("Fast.ext.Date",
{alias:["widget.date","widget.datefield"],extend:"Ext.form.field.Text",format:"Y-m-d H:i:s",strict:!0,isValid:function(){return this.callParent(arguments)?Ext.isEmpty(this.getValue())||FastExt.Base.toBool(this.fromHeadSearch,!1)||Ext.Date.parse(this.getValue(!0),this.format)?!0:(this.invalidText="\u65e5\u671f\u683c\u5f0f\u9519\u8bef\uff01\u683c\u5f0f\u5fc5\u987b\u4e3a\uff1a"+this.format,this.markInvalid(this.invalidText),!1):!1},setValue:function(b){if(this.strict&&!Ext.isEmpty(b)){var a=FastExt.Base.guessDateFormat(b);
(a=Ext.Date.parse(b,a))&&(arguments[0]=Ext.Date.format(a,this.format))}return this.callParent(arguments)},getValue:function(b){var a=this.callParent(arguments);if(this.strict&&!FastExt.Base.toBool(b,!1)){var d=FastExt.Base.guessDateFormat(a);if("Y-m"===d)return a+"-01";if("Y/m"===d)return a+"/01";if("Y"===d)return a+"-01-01"}return a},selectData:function(){var b=this;null!=b.getEditorMenu()&&(b.getEditorMenu().holdShow=!0);b.pickerShown=!0;FastExt.Dialog.showFastDatePicker(b.bodyEl,b.getValue(),this.format).then(function(a){null!=
b.getEditorMenu()&&(b.getEditorMenu().holdShow=!1);b.resetPickerShowTask.delay(100);a&&b.setValue(a)})},toggleSelectData:function(){this.pickerShown?this.pickerShown=!1:this.selectData()},endEdit:function(){this.firstValue=null},onFastInputClick:function(){this.readOnly||this.disabled||this.strict&&this.toggleSelectData()},triggers:{search:{cls:"extIcon extDatePicker",handler:function(){this.toggleSelectData()}}},finishRender:function(){this.callParent(arguments);this.inputEl.on("click",this.onFastInputClick,
this)},initComponent:function(){this.resetPickerShowTask=new Ext.util.DelayedTask(function(){this.pickerShown=!1},this);this.callParent(arguments)}})}}();c.DateField=v;v=function(){return function(){Ext.define("Fast.ext.ColorField",{extend:"Ext.form.field.Text",alias:["widget.colorfield"],editable:!1,beforeBodyEl:['\x3cdiv class\x3d"'+Ext.baseCSSPrefix+'colorpicker-field-swatch" style\x3d"z-index: 9;"\x3e\x3cdiv id\x3d"{id}-swatchEl" data-ref\x3d"swatchEl" class\x3d"'+Ext.baseCSSPrefix+'colorpicker-field-swatch-inner"\x3e\x3c/div\x3e\x3c/div\x3e'],
cls:Ext.baseCSSPrefix+"colorpicker-field",childEls:["swatchEl"],setValue:function(b){this.swatchEl&&this.swatchEl.setStyle("background",b);this.callParent(arguments);return this},triggers:{search:{cls:"extIcon extSearch",handler:function(){this.toggleSelectData()}}},onFastInputClick:function(){this.readOnly||this.disabled||this.toggleSelectData()},selectData:function(){var b=this;null!=b.getEditorMenu()&&(b.getEditorMenu().holdShow=!0);b.pickerShown=!0;FastExt.Dialog.showFastColorPicker(b.inputEl,
b.getValue(),function(a){b.setValue(a.toRGBA().toString(0))}).then(function(a){null!=b.getEditorMenu()&&(b.getEditorMenu().holdShow=!1);b.resetPickerShowTask.delay(100)})},clearData:function(){this.setValue(null)},toggleSelectData:function(){this.pickerShown?this.pickerShown=!1:this.selectData()},initComponent:function(){this.resetPickerShowTask=new Ext.util.DelayedTask(function(){this.pickerShown=!1},this);this.callParent(arguments)},finishRender:function(){this.callParent(arguments);this.inputEl.on("click",
this.onFastInputClick,this);var b=FastExt.Color.toColor(this.getValue(),"#00000000");this.setValue(b)}})}}();c.ColorField=v;v=function(){return function(){Ext.define("Fast.ext.SVGIcon",{extend:"Ext.Component",alias:["widget.svgicon"],iconId:"",iconCls:"",initComponent:function(){this.callParent(arguments)},finishRender:function(){this.callParent(arguments);this.update('\x3csvg class\x3d"svgIconFill '+this.iconCls+'" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"'+this.iconId+'"\x3e\x3c/use\x3e\x3c/svg\x3e')}})}}();
c.SVGIcon=v;v=function(){return function(){Ext.define("Fast.ext.Lottie",{extend:"Ext.Component",alias:["widget.lottie"],jsonPath:"",initComponent:function(){this.callParent(arguments)},destroy:function(){FastExt.Lottie.unloadJsonAnim(this);this.callParent(arguments)},finishRender:function(){this.callParent(arguments);var b=this.up("window");if(b&&!FastExt.Base.toBool(b.shown))b.on("show",this.onFastContainerShow,this,{single:!0});else this.loadJson()},onFastContainerShow:function(){this.loadJson()},
loadJson:function(){FastExt.Lottie.loadJsonAnim(this,this.jsonPath)}})}}();c.Lottie=v;v=function(){return function(){Ext.define("Fast.ext.FastMonaco",{extend:"Ext.form.field.TextArea",alias:["widget.fastmonaco","widget.fastmonacofield"],editable:!1,language:"plaintext",finishRender:function(){this.callParent(arguments);this.inputEl.on("click",this.onFastInputClick,this)},onFastInputClick:function(){this.readOnly||this.disabled||this.showMonacoEditor()},initComponent:function(){this.editable=!1;this.callParent(arguments)},
showMonacoEditor:function(){var b=this;b.getEditorMenu()&&(b.getEditorMenu().holdShow=!0);FastExt.MonacoEditor.showEditor(this,b.getValue(),b.language).then(function(a){a&&b.setValue(a);b.getEditorMenu()&&(b.getEditorMenu().holdShow=!1)})},clearData:function(){this.setValue(null)},showWindow:function(b,a,d){var e=this;e.getEditorMenu()&&(e.getEditorMenu().holdShow=!0);FastExt.MonacoEditor.showEditor(b,e.getValue(),e.language).then(function(f){f&&Ext.isFunction(a)&&a(e);e.getEditorMenu()&&(e.getEditorMenu().holdShow=
!1)})}})}}();c.MonacoField=v;for(var m in c)c[m]()})(FastDefine||(FastDefine={}));
(function(c){var v=function(){function m(){}m.initSystem=function(){c.Dialog.hideWait();var b=c.System.getBodyContainer();b.removeAll();var a=c.Color.toColor(c.System["theme-color"].value),d={background:"#ffffff"};c.Desktop.desktopPanel=Ext.create("Ext.panel.Panel",{layout:{type:"hbox",align:"stretch"},bodyStyle:{background:"transparent",borderWidth:0},border:0,region:"center",anchor:"100% 100%",bbar:{xtype:"toolbar",overflowHandler:"menu",itemId:"DesktopToolBar",items:[{xtype:"button",overflowText:"\u7cfb\u7edf\u83dc\u5355",
iconCls:"extIcon extMore whiteColor",cls:"fast-desktop-toolbar-btn",help:c.System.getPlainIconMenuHtmlBySVG({iconCls:"extMore",text:"\u7cfb\u7edf\u83dc\u5355"}),style:{background:a},focusCls:"fast-desktop-toolbar-btn-focus",helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.bottom,reorderable:!1,handler:function(){c.Desktop.toggleStartMenu(this)}},{xtype:"tbseparator",reorderable:!1},{xtype:"tbspacer",reorderable:!1,desktopFixedMenuAnchor:!0},{xtype:"tbfill",reorderable:!1,
desktopMenuAnchor:!0},{xtype:"button",iconCls:"extIcon extTip blackColor",cls:"fast-desktop-toolbar-btn",overflowText:"\u7cfb\u7edf\u5f85\u529e\u4e8b\u9879",reorderable:!1,help:c.System.getPlainIconMenuHtmlBySVG({iconCls:"extTip",text:"\u7cfb\u7edf\u5f85\u529e\u4e8b\u9879"}),style:d,helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.bottom,handler:function(){c.Desktop.showWindowPanel(this,"\u7cfb\u7edf\u5f85\u529e\u4e8b\u9879",c.System.getSystemWaitNotice(!1))}},{xtype:"button",
iconCls:"extIcon extLog blackColor",cls:"fast-desktop-toolbar-btn",overflowText:"\u7cfb\u7edf\u64cd\u4f5c\u65e5\u5fd7",help:c.System.getPlainIconMenuHtmlBySVG({iconCls:"extLog",text:"\u7cfb\u7edf\u64cd\u4f5c\u65e5\u5fd7"}),style:d,helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.bottom,reorderable:!1,handler:function(){c.Desktop.showWindowPanel(this,"\u7cfb\u7edf\u64cd\u4f5c\u65e5\u5fd7",c.System.getSystemOperate(!1))}},{xtype:"tbseparator",reorderable:!1},{xtype:"button",
iconCls:"extIcon extVersion blackColor",cls:"fast-desktop-toolbar-btn",overflowText:"\u7cfb\u7edf\u57fa\u672c\u4fe1\u606f",reorderable:!1,help:c.System.getPlainIconMenuHtmlBySVG({iconCls:"extVersion",text:"\u7cfb\u7edf\u57fa\u672c\u4fe1\u606f"}),style:d,helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.bottom,handler:function(){c.Desktop.showWindowPanel(this,"\u7cfb\u7edf\u57fa\u672c\u4fe1\u606f",c.System.getSystemVersion(!1))}},{xtype:"button",iconCls:"extIcon extMonitor blackColor",
cls:"fast-desktop-toolbar-btn",reorderable:!1,overflowText:"\u7cfb\u7edf\u76d1\u63a7\u4fe1\u606f",help:c.System.getPlainIconMenuHtmlBySVG({iconCls:"extMonitor",text:"\u7cfb\u7edf\u76d1\u63a7\u4fe1\u606f"}),style:d,helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.bottom,handler:function(){c.Desktop.showWindowPanel(this,"\u7cfb\u7edf\u76d1\u63a7\u4fe1\u606f",c.System.getSystemMonitor(!1))}},{xtype:"button",iconCls:"extIcon extSet blackColor",cls:"fast-desktop-toolbar-btn",
reorderable:!1,overflowText:"\u7cfb\u7edf\u5168\u5c40\u8bbe\u7f6e",help:c.System.getPlainIconMenuHtmlBySVG({iconCls:"extSet",text:"\u7cfb\u7edf\u5168\u5c40\u8bbe\u7f6e"}),style:d,helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.bottom,handler:function(){c.Desktop.showWindowPanel(this,"\u7cfb\u7edf\u5168\u5c40\u8bbe\u7f6e",c.System.getSystemConfig(!1))}}],userCls:"fast-desktop-tool-bar",plugins:[{ptype:"boxreorderer",listeners:{StartDrag:c.DesktopEvent.onFastToolbarStartDrag,
Drop:c.DesktopEvent.onFastToolbarDrop}}],listeners:{afterlayout:function(){this.getEl().on("dblclick",function(){c.Desktop.hideAllDesktopWin()});this.getEl().on("contextmenu",function(e){e.stopEvent()})}}},addDesktopItem:function(e,f){f?f.addDesktopItem(e):c.Desktop.checkMenuFolder(e)?this.child("[alignRight\x3dfalse]").addDesktopItem(e):this.child("[alignRight\x3dtrue]").addDesktopItem(e)},removeDesktopItem:function(e){for(var f=this.query("[desktopItemContainer\x3dtrue]"),g=0;g<f.length&&!c.Base.toBool(f[g].folderLocked,
!1);g++)f[g].removeDesktopItem(e)},checkMuuriGridReady:function(){var e=this.query("[desktopItemContainer\x3dtrue]");if(0<e.length){for(var f=0;f<e.length;f++)if(!c.Base.toBool(e[f].muuriReady,!1))return!1;return!0}return!1},rebindMuuriGrid:function(){var e=this.query("[desktopItemContainer\x3dtrue]");if(0<e.length)for(var f=0;f<e.length;f++)e[f].bindMuuriGrid()},resetDesktop:function(e){try{this.removeAll();c.Desktop.removeAllDesktopToolbarFixedButton();this.configMenus=e;var f=c.Desktop.getAllDesktopMenuInfo(e);
e=[];var g=[],h=[],k;for(k in f){var l=f[k];c.Desktop.checkMenuInFolder(l)||l.desktop&&(Ext.isEmpty(l.desktop_align)?c.Desktop.checkMenuFolder(l)?g.push(l):e.push(l):"right"===l.desktop_align?e.push(l):g.push(l));l.desktop_fixed&&h.push(l)}e.sort(function(n,p){return n.desktop_index-p.desktop_index});g.sort(function(n,p){return n.desktop_index-p.desktop_index});h.sort(function(n,p){return n.desktop_fixed_index-p.desktop_fixed_index});this.add(c.Desktop.buildDesktopItemPanel(g,!1,!0,!1),c.Desktop.buildDesktopItemPanel(e,
!0,!0,!1));c.Desktop.addDesktopToolbarFixedButton(h,!0)}finally{this.rebindMuuriGrid(),c.Dialog.hideWait(),f=c.System.getMenuIdFromLocation(),(f=c.Desktop.getMenu(f))&&c.Desktop.showWindowMenu(null,f,!0),c.Desktop.desktopInitFinish=!0}},reorderDesktop:function(){try{this.removeAll();var e=c.Desktop.getAllDesktopMenuInfo(this.configMenus),f=[],g=[],h;for(h in e){var k=e[h];c.Desktop.checkMenuInFolder(k)||k.desktop&&(c.Desktop.checkMenuFolder(k)?g.push(k):f.push(k))}f.sort(function(l,n){return l.desktop_index-
n.desktop_index});g.sort(function(l,n){return l.desktop_index-n.desktop_index});this.add(c.Desktop.buildDesktopItemPanel(g,!1,!0,!1),c.Desktop.buildDesktopItemPanel(f,!0,!0,!1))}finally{this.rebindMuuriGrid()}},listeners:{afterrender:function(){this.getEl().on("contextmenu",c.DesktopEvent.onFastDesktopContextMenu,this);c.Desktop.restoreSystemDesktopMenus()}}});a=c.Objects.safeObject(c.System["desktop-bg-image"]).value;Ext.isEmpty(a)&&(a="base/desktop/desktop_bg_img_default.jpg");c.Desktop.desktopContainer=
Ext.create("Ext.container.Container",{layout:"border",border:0,style:{backgroundImage:"url('"+a+"')",backgroundSize:"cover"},items:[c.System.getSystemHeaderPanel(["headContainer","fast-desktop-header-container"]),c.Desktop.desktopPanel]});b.add(c.Desktop.desktopContainer)};m.getMenu=function(b){return c.Desktop.desktopAllMenusInfo.hasOwnProperty(b)?c.Desktop.desktopAllMenusInfo[b]:c.System.getMenu(b)};m.getMenuByMuuriGridItem=function(b){b=$(b.getElement());var a=b.attr("data-menu-id");b.attr("data-menu-type");
return Ext.isEmpty(a)?null:c.Desktop.getMenu(a)};m.restoreSystemDesktopMenus=function(){window.indexLottie&&(window.indexLottie.destroy(),window.indexLottie=null);Ext.MessageBox.updateProgress(1,"\u5373\u5c06\u5b8c\u6210\u64cd\u4f5c\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85","\u7cfb\u7edf\u521d\u59cb\u5316\u6210\u529f\uff01\u83b7\u53d6\u83dc\u5355\u4e2d\u2026");if(c.Base.toBool(c.Objects.safeObject(c.System["desktop-menu-record"]).value,!0))c.Desktop.restoreMenu().then(function(b){c.Desktop.desktopPanel.resetDesktop(c.Json.jsonToObject(b));
if(c.Listeners.onFinishSystem)c.Listeners.onFinishSystem()});else if(c.Desktop.desktopPanel.resetDesktop({}),c.Listeners.onFinishSystem)c.Listeners.onFinishSystem()};m.getAllDesktopMenuInfo=function(b){for(var a=function(l,n){for(var p=[],q=0;q<n.length;q++){var r=Ext.clone(n[q]);r.parent=l;r.desktop=c.Base.toBool(r.desktop,1===r.depth);r.desktop_fixed=c.Base.toBool(r.desktop_fixed);if(r.desktop||r.desktop_fixed)r.leaf||(r.desktop_type="folder"),p.push(r);r.children&&(r=a(r,r.children),p=p.concat(r))}return p},
d=a(null,c.System.menus),e=0;e<d.length;e++){var f=d[e],g=c.Objects.safeObject(c.Desktop.desktopAllMenusInfo[f.id]);c.Desktop.desktopAllMenusInfo[f.id]=Ext.Object.merge(g,f)}d=[];if(b)for(var h in b)d.push(b[h]);for(e=0;e<d.length;e++){b=d[e];(g=c.Desktop.desktopAllMenusInfo[b.id])||(g=c.System.getMenu(b.id));if(!g)if("user"===c.Base.toString(b.desktop_from,"none"))g={};else continue;c.Desktop.desktopAllMenusInfo[b.id]=Ext.Object.merge(g,b)}for(var k in c.Desktop.desktopAllMenusInfo)e=c.Desktop.desktopAllMenusInfo[k],
Ext.isEmpty(e.desktop_folder_id)&&(e.desktop_folder_id="desktop"),Ext.isEmpty(e.treeGroup)&&(e.treeGroup=c.Base.buildOnlyCode("F"));return c.Desktop.desktopAllMenusInfo};m.buildDesktopItemPanel=function(b,a,d,e){var f="muuri-grid-container-"+c.Desktop.muuriContainerIdIndex++;return{xtype:"container",layout:"fit",border:0,desktopItemContainer:!0,alignRight:a,horizontal:d,flex:1,anchor:"100% 100%",configMenus:b,muuriReady:!1,muuriGridContainerId:f,html:"\x3cdiv id\x3d'"+f+"-root' style\x3d'width: 100%;height: 100%;display: flex;justify-content:"+
(a?"end":"start")+"; overflow: "+(e?"auto":"hidden")+";padding: 5px;'\x3e\x3cdiv id\x3d'"+f+"' style\x3d'width: 100%;height: 100%; position: relative;' \x3e\x3c/div\x3e\x3c/div\x3e",listeners:{destroy:function(){c.MuuriTool.releaseMuuriGrid(this);c.Desktop.refreshMuuriGridContainers()}},getMuuriGridContainerId:function(){return this.muuriGridContainerId},bindMuuriGrid:function(g){var h=this;c.MuuriTool.justBindToContainer(this,{dragEnabled:!c.Base.toBool(this.folderLocked,!1),dragContainer:document.body,
layout:{alignRight:this.alignRight,horizontal:this.horizontal,fillGaps:!0,rounding:!0},dragStartPredicate:c.DesktopEvent.onFastMuuriGridDragStartPredicate,dragSort:c.DesktopEvent.onFastMuuriGridDragSort,dragSortPredicate:c.DesktopEvent.onFastMuuriGridDragSortPredicate},function(k){h.configMenus&&h.addDesktopItems(h.configMenus);h.muuriReady=!0;k.containerId=h.getId();k.on("dragReleaseEnd",c.DesktopEvent.onFastMuuriGridDragEnd);k.on("add",c.DesktopEvent.onFastMuuriGridChange);k.on("remove",c.DesktopEvent.onFastMuuriGridChange);
k.on("dragInit",c.DesktopEvent.onFastMuuriGridDragInit);k.on("send",c.DesktopEvent.onFastMuuriGridSend);c.Desktop.refreshMuuriGridContainers();h.ownerCt&&h.ownerCt.updateLayout();g&&g()})},addDesktopItems:function(g){if(g){var h=c.MuuriTool.getMuuriGrid(this);if(h){for(var k=[],l=0;l<g.length;l++){var n=g[l];c.Base.toBool(n.desktop_temp,!1)||(n.desktop=!0,c.Desktop.desktopAllMenusInfo[n.id]=n);k.push(c.Desktop.buildDesktopItem(n))}0<k.length&&h.add(k)}}},addDesktopItem:function(g){if(g)if(Ext.isArray(g))this.addDesktopItems(g);
else{var h=c.MuuriTool.getMuuriGrid(this);h&&(c.Base.toBool(g.desktop_temp,!1)||(g.desktop=!0,c.Desktop.desktopAllMenusInfo[g.id]=g),h.add(c.Desktop.buildDesktopItem(g)))}},removeDesktopItem:function(g){if(g){var h=c.MuuriTool.getMuuriGrid(this);if(h){for(var k=$("#"+this.muuriGridContainerId).find("[data-menu-id\x3d"+g.id+"]"),l=[],n=0;n<k.length;n++){var p=h.getItem(k[n]);p&&l.push(p)}c.Desktop.desktopAllMenusInfo.hasOwnProperty(g.id)&&(c.Desktop.desktopAllMenusInfo[g.id].desktop=!1);h.remove(l,
{removeElements:!0})}}},removeAllDesktopItem:function(){var g=c.MuuriTool.getMuuriGrid(this);if(g){for(var h=g.getItems(),k=[],l=0;l<h.length;l++){k.push(h[l]);var n=$(h[l].getElement()).attr("data-menu-id");c.Desktop.desktopAllMenusInfo.hasOwnProperty(n)&&(c.Desktop.desktopAllMenusInfo[n].desktop=!1)}g.remove(k,{removeElements:!0})}},getAllDesktopItemMenus:function(){var g=c.MuuriTool.getMuuriGrid(this);if(!g)return[];g=g.getItems();for(var h=[],k=0;k<g.length;k++){var l=g[k].getElement(),n=$(l);
l=n.attr("data-menu-id");n=n.attr("data-menu-type");!Ext.isEmpty(l)&&(l=c.Desktop.getMenu(l))&&(c.Base.toBool(this.alignRight,!1)?l.desktop_align="right":l.desktop_align="left",l.desktop_type=n,l.desktop_index=k,h.push(l))}return h},muuriGridLayout:function(){var g=c.MuuriTool.getMuuriGrid(this);g&&g.layout()}}};m.buildDesktopItem=function(b){var a=c.Desktop.getDesktopButtonMaxWidth(),d=c.Desktop.getDesktopButtonTitleMaxWidth();if(0===Object.keys(b).length)return $("\x3cdiv style\x3d'width: "+a+"px;position: absolute;margin: 5px;background:transparent;pointer-events: none;'\x3e\x3cdiv \x3e \x3cdiv   style\x3d'height:"+
2*a+"px;'\x3e\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e")[0];Ext.isEmpty(b.desktop_type)&&(b.desktop_type="item");var e=c.Desktop.safeGetMenuColor(b),f=b.color5,g=c.Base.toBool(b.desktop_locked,!1),h=c.Desktop.checkMenuFolder(b);Ext.isEmpty(f)&&(f=c.Desktop.checkMenuFolder(b)?"#FFEE99":"#f0f0f0");var k=[b.icon];if(h){k=[];for(var l=c.Desktop.getFolderChildMenus(b.id),n=0;n<l.length&&(k.push(c.Desktop.safeGetMenuIcon(l[n])),4!==k.length);n++);}n=e;c.System.isThemeWrap()&&(n="linear-gradient(0deg,"+e+", "+
f+");");a="\x3cdiv data-desktop-menu-item\x3d'true' data-menu-id\x3d'"+b.id+"' data-menu-type\x3d'"+b.desktop_type+"'  style\x3d'position: absolute;background:transparent;display: flex;align-items: center;justify-content: center;'\x3e\x3cdiv class\x3d'fast-desktop-item' style\x3d'padding: 5px;'\x3e \x3cdiv data-menu-bg\x3d'true' class\x3d'"+(h?"fast-desktop-item-icon-grid":"fast-desktop-item-icon")+"' style\x3d'height:"+a+"px;background:"+n+";width:"+a+"px; box-shadow: "+(h?"0px 0px 1px 1px black;":
"0px 1px 1px black;")+"'\x3e";for(n=0;n<k.length;n++)a+="\x3cimg data-menu-icon\x3d'true' src\x3d'"+c.System.takeIcon(k[n],"#ffffff")+"'  alt\x3d'"+b.text+"' /\x3e";a+=(g?"\x3cdiv style\x3d'background: black;width:5px;height:5px;position: absolute;left: 13px;top: 8px;border-radius: 5px;'\x3e\x3c/div\x3e":"")+"\x3c/div\x3e \x3cdiv data-menu-text\x3d'true' style\x3d'width: "+d+"px;' class\x3d'fast-desktop-item-title'\x3e"+b.text+"\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e";b=$(a);b.on("click",c.DesktopEvent.onFastDesktopItemClick);
b.on("contextmenu",c.DesktopEvent.onFastDesktopItemContextMenu);return b[0]};m.getDesktopButtonMaxWidth=function(){Ext.isEmpty(c.Desktop.desktopButtonMaxWidth)&&(c.Desktop.desktopButtonMaxWidth=parseInt((document.body.clientWidth/36).toFixed(0)));return c.Desktop.desktopButtonMaxWidth};m.getDesktopButtonTitleMaxWidth=function(){return c.Desktop.getDesktopButtonMaxWidth()+10};m.toggleStartMenu=function(b){if(!c.Desktop.startMenu){b=parseInt((.25*document.body.clientWidth).toFixed(0));var a=Ext.create("Ext.panel.Panel",
{border:0,region:"center",bodyStyle:{borderWidth:0},cls:"treelist-with-nav",scrollable:"y",items:[{xtype:"treelist",id:"leftTreeList",reference:"treelist",expanderOnly:!1,singleExpand:!1,ui:"nav",scrollable:"y",expanderFirst:!1,selectOnExpander:!0,highlightPath:!0,store:{type:"tree",root:{expanded:!0,children:c.System.menus}},listeners:{itemclick:function(e,f,g){f.node.data.leaf&&c.Desktop.showWindowMenu("button",f.node.data)},itemcontextmenu:function(e,f,g){c.DesktopEvent.onFastMenuItemContextMenu(e,
f.getNode().data,g)}}}],listeners:{resize:function(e,f,g,h,k,l){e=128>=f;g=Ext.getCmp("leftTreeList");h=g.ownerCt.ownerCt;g.setMicro(e);e?h.setWidth(44):h.setWidth(f)}}});a=Ext.create("Ext.panel.Panel",{layout:"border",region:"center",border:0,bodyStyle:{borderWidth:0},width:b,minWidth:44,maxWidth:500,subtitle:"\u5de6\u4fa7\u83dc\u5355",split:!0,style:{background:"#32404e"},items:[a]});var d=parseInt((.8*document.body.clientHeight).toFixed(0));c.Desktop.startMenu=Ext.create("Ext.menu.Menu",{showSeparator:!1,
layout:"border",padding:"0 0 0 0",border:0,style:{background:"#32404e",borderWidth:0},userCls:"desktop-start-menu",width:b,height:d,items:[a],listeners:{hide:function(e,f){}}})}c.Desktop.startMenu.showBy(c.Desktop.desktopPanel.down("#DesktopToolBar"))};m.hideAllDesktopWin=function(){for(var b=Ext.ComponentQuery.query("[desktopWin\x3dtrue]"),a=0;a<b.length;a++){var d=b[a];d.hideAction&&"destroy"===d.hideAction?d.hide(d.animateTarget,d.destroy,d):d.hide()}};m.closeAllDesktopWin=function(){for(var b=
Ext.ComponentQuery.query("[desktopWin\x3dtrue]"),a=0;a<b.length;a++)b[a].close()};m.getInsertMenuButtonIndex=function(){var b=c.Desktop.desktopPanel.down("#DesktopToolBar"),a=b.down("[desktopMenuAnchor\x3dtrue]");return a?b.items.indexOf(a):1};m.getInsertFixedButtonIndex=function(){var b=c.Desktop.desktopPanel.down("#DesktopToolBar"),a=b.down("[desktopFixedMenuAnchor\x3dtrue]");return a?b.items.indexOf(a):1};m.showWindowMenu=function(b,a,d){if(!c.Desktop.muuriDragging&&a&&!c.Desktop.hasWindowMenu(a))if(c.Desktop.checkMenuFolder(a))c.Desktop.showFolder(b,
a,d);else{var e=parseInt((.8*document.body.clientWidth).toFixed(0)),f=parseInt((.9*document.body.clientHeight).toFixed(0)),g=Ext.create("Ext.window.Window",{title:c.Desktop.getMenuPath(a,"#ffffff","20px"),realTitle:a.text,menuId:a.id,menuData:a,menuContainer:!0,height:f,width:e,minHeight:500,minWidth:800,layout:"fit",resizable:!0,constrainHeader:!0,maximizable:!0,entityWindow:!0,desktopWin:!0,tools:[{type:"minus",callback:function(h){h.hide()}}],listeners:{show:function(h){h.shown=!0;h.methodInvoked&&
!c.System.silenceGlobalSave||c.System.asyncMethod(a.method).then(function(k){if(null!=k){var l=k.down("[entityList\x3dtrue]");l&&(l.where=c.Json.mergeJson({},l.where),l.code=$.md5(a.id),l.buildCodeText=a.text);h.add(k);h.methodInvoked=!0}});c.Desktop.refreshActiveToolbarButton()},destroy:c.DesktopEvent.onFastWindowMenuDestroy,activate:c.Desktop.refreshActiveToolbarButton,hide:c.Desktop.refreshActiveToolbarButton,close:c.Desktop.refreshActiveToolbarButton,drag:function(){c.Desktop.disabledMenuPathClick=
!0},dragend:function(h,k){(new Ext.util.DelayedTask(function(){c.Desktop.disabledMenuPathClick=!1},this)).delay(100)}}});c.Desktop.addDesktopToolbarButton(a);d&&c.Desktop.activeToolbarButton(a.id);Ext.isObject(b)&&(g.animateTarget=b);(b=c.Desktop.desktopPanel.down("#DesktopToolBar"))?(e=(document.body.clientWidth-e)/2,f=(document.body.clientHeight-b.getHeight()-f)/2,g.showAt(e,f)):g.show()}};m.closeToolbarMenuButton=function(b){if(b&&b.menuWin)b.menuWin.close(),b.menuWin=null;else{var a=c.Desktop.desktopPanel.down("#DesktopToolBar");
a&&a.remove(b,!0)}};m.closeOtherToolbarMenuButton=function(b,a){var d=c.Desktop.desktopPanel.down("#DesktopToolBar");if(d){d=d.query("[desktopMenuButton\x3dtrue]");for(var e=-1,f=0;f<d.length;f++)b.getId()===d[f].getId()?e=f:"all"===a?c.Desktop.closeToolbarMenuButton(d[f]):"right"===a&&0<=e?c.Desktop.closeToolbarMenuButton(d[f]):"left"===a&&0>e&&c.Desktop.closeToolbarMenuButton(d[f])}};m.closeAllToolbarMenuButton=function(){var b=c.Desktop.desktopPanel.down("#DesktopToolBar");if(b){b=b.query("[desktopMenuButton\x3dtrue]");
for(var a=0;a<b.length;a++)c.Desktop.closeToolbarMenuButton(b[a])}};m.showWindowPanel=function(b,a,d){b||(b={getId:function(){return(new Date).getTime()}});if(d){var e=Ext.ComponentQuery.query("[buttonId\x3d"+b.getId()+"]");if(0<e.length)c.Component.shakeComment(e[0]),d&&d.destroy();else{e=parseInt((.4*document.body.clientWidth).toFixed(0));var f=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:a,height:f,width:e,minHeight:500,minWidth:800,iconCls:b.iconCls,
layout:"fit",buttonId:b.getId(),hideAction:"destroy",desktopWin:!0,resizable:!0,constrainHeader:!0,maximizable:!0,items:[d],listeners:{show:c.Desktop.refreshActiveToolbarButton,activate:c.Desktop.refreshActiveToolbarButton,close:c.Desktop.refreshActiveToolbarButton}}).show()}}};m.refreshActiveToolbarButton=function(){if(c.Desktop.desktopInitFinish){var b=c.Desktop.getTopDesktopWindow();b?(Ext.isEmpty(c.Desktop.lastActiveMenuId)||b.menuId===c.Desktop.lastActiveMenuId||c.Desktop.deactiveToolbarButton(c.Desktop.lastActiveMenuId),
c.Desktop.activeToolbarButton(b.menuId),c.System.pushLocationHistory({text:b.realTitle||b.title,id:b.menuId})):(Ext.isEmpty(c.Desktop.lastActiveMenuId)||c.Desktop.deactiveToolbarButton(c.Desktop.lastActiveMenuId),c.System.pushLocationHistory({text:"\u9996\u9875"}))}};m.activeToolbarButton=function(b){var a=c.Desktop.desktopPanel.down("[menuButtonId\x3d"+b+"]");a&&a.addCls("fast-desktop-toolbar-btn-active");c.Desktop.lastActiveMenuId=b};m.deactiveToolbarButton=function(b){(b=c.Desktop.desktopPanel.down("[menuButtonId\x3d"+
b+"]"))&&b.removeCls("fast-desktop-toolbar-btn-active")};m.getTopDesktopWindow=function(){for(var b=Ext.ComponentQuery.query("[desktopWin\x3dtrue]"),a=null,d=0;d<b.length;d++){var e=b[d];if(e.isVisible()){var f=e.getEl().getZIndex(),g=0;a&&(g=a.getEl().getZIndex());f>g&&(a=e)}}return a};m.addDesktopButton=function(b,a){c.Desktop.checkDesktopButton(b)?c.Dialog.toast("\u684c\u9762\u5df2\u5b58\u5728\uff01"):(c.Desktop.desktopPanel.addDesktopItem(b),a||c.Dialog.toast("\u6dfb\u52a0\u6210\u529f\uff01"))};
m.removeDesktopButton=function(b,a){c.Desktop.desktopPanel.removeDesktopItem(b);a||c.Dialog.toast("\u79fb\u9664\u6210\u529f\uff01")};m.checkDesktopButton=function(b){return b?c.Base.toBool(b.desktop):!1};m.buildToolbarButton=function(b,a){var d={xtype:"button",helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.bottom,userCls:"fast-desktop-toolbar-btn",focusCls:"fast-desktop-toolbar-btn-focus",handler:c.DesktopEvent.onFastToolBarMenuButtonClick,updateMenu:function(e){this.desktopFixedMenuButton?
this.setText(null):this.setText(e.text);this.setIcon(c.System.takeIcon(c.Desktop.safeGetMenuIcon(e),"#ffffff"));this.overflowText=e.text;this.menuData=e;this.help=c.System.getPlainIconMenu(e," \x3e\x3e ");this.menuButtonId=e.id;c.Base.toBool(e.leaf,!1)||(this.menuButtonGroup=e.treeGroup);this.setStyle("background",c.Desktop.safeGetMenuColor(e))},listeners:{afterrender:function(){this.updateMenu(b);this.getEl().on("contextmenu",c.DesktopEvent.onFastToolbarMenuButtonContextMenu,this)}}};a?d.desktopFixedMenuButton=
!0:d.desktopMenuButton=!0;return d};m.removeAllDesktopToolbarFixedButton=function(){var b=c.Desktop.desktopPanel.down("#DesktopToolBar");if(b){var a=[];b.items.each(function(e){e.desktopFixedMenuButton&&a.push(e)});Ext.suspendLayouts();for(var d=0;d<a.length;d++)b.remove(a[d]);Ext.resumeLayouts()}};m.addDesktopToolbarFixedButton=function(b,a){try{var d=c.Desktop.desktopPanel.down("#DesktopToolBar");if(d){var e=[];Ext.isArray(b)?e=b:e.push(b);b=[];for(var f=0;f<e.length;f++){var g=e[f];c.Desktop.desktopAllMenusInfo.hasOwnProperty(g.id)||
(c.Desktop.desktopAllMenusInfo[g.id]=g);c.Desktop.desktopAllMenusInfo[g.id].desktop_fixed=!0;var h=c.Desktop.getDesktopToolbarButton(g);if(h)if(h.desktopFixedMenuButton)continue;else d.remove(h);b.push(c.Desktop.buildToolbarButton(g,!0))}d.insert(c.Desktop.getInsertFixedButtonIndex(),b);a||(c.Dialog.toast("\u5df2\u56fa\u5b9a\u5230\u5de5\u5177\u680f\u4e2d\uff01"),c.Desktop.recordMenu())}}finally{c.Desktop.refreshActiveToolbarButton()}};m.removeDesktopToolbarFixedButton=function(b){try{var a=c.Desktop.desktopPanel.down("#DesktopToolBar");
if(a){var d=[];Ext.isArray(b)?d=b:d.push(b);for(b=0;b<d.length;b++){var e=d[b];c.Desktop.desktopAllMenusInfo.hasOwnProperty(e.id)||(c.Desktop.desktopAllMenusInfo[e.id]=e);c.Desktop.desktopAllMenusInfo[e.id].desktop_fixed=!1;var f=c.Desktop.getDesktopToolbarButton(e);f&&f.desktopFixedMenuButton&&a.remove(f);c.Desktop.getWindowMenu(e)&&c.Desktop.addDesktopToolbarButton(e)}c.Desktop.recordMenu();c.Dialog.toast("\u5df2\u4ece\u5de5\u5177\u680f\u4e2d\u53d6\u6d88\u56fa\u5b9a\uff01")}}finally{c.Desktop.refreshActiveToolbarButton()}};
m.checkDesktopToolbarFixedButton=function(b){return b?(b=c.Desktop.getDesktopToolbarButton(b))?b.desktopFixedMenuButton:!1:!1};m.addDesktopToolbarButton=function(b){if(b){var a=c.Desktop.desktopPanel.down("#DesktopToolBar");if(a){var d=[];Ext.isArray(b)?d=b:d.push(b);b=[];for(var e=0;e<d.length;e++){var f=d[e];c.Desktop.getDesktopToolbarButton(f)||b.push(c.Desktop.buildToolbarButton(f,!1))}0<b.length&&a.insert(c.Desktop.getInsertMenuButtonIndex(),b)}}};m.removeDesktopToolbarButton=function(b){if(b){var a=
c.Desktop.desktopPanel.down("#DesktopToolBar");if(a){var d=[];Ext.isArray(b)?d=b:d.push(b);for(b=0;b<d.length;b++){var e=c.Desktop.getDesktopToolbarButton(d[b]);c.Base.toBool(e.desktopFixedMenuButton)||a.remove(e)}}}};m.getDesktopToolbarButton=function(b){if(b){var a=c.Desktop.desktopPanel.down("#DesktopToolBar");return a?a.down("[menuButtonId\x3d"+b.id+"]"):null}};m.getDesktopToolbarButtonByGroup=function(b){if(b){var a=c.Desktop.desktopPanel.down("#DesktopToolBar");return a?a.down("[menuButtonGroup\x3d"+
b.treeGroup+"]"):null}};m.outDesktopMenuFolder=function(b){b&&(c.Desktop.disabledRecordMenu=!0,c.Desktop.desktopAllMenusInfo.hasOwnProperty(b.id)&&(c.Desktop.desktopAllMenusInfo[b.id].desktop_folder_id="desktop"),c.Desktop.removeDesktopButton(b,!0),c.Desktop.disabledRecordMenu=!1,c.Desktop.addDesktopButton(b,!0),c.Dialog.toast("\u5df2\u79fb\u51fa\u6587\u4ef6\u5939\uff01"))};m.recordMenu=function(){if(!c.Desktop.disabledRecordMenu){c.Desktop.refreshMuuriGridMenuIndex();try{var b={},a;for(a in c.Desktop.desktopAllMenusInfo){var d=
c.Desktop.desktopAllMenusInfo[a];if(!c.Base.toBool(d.desktop_temp,!1)){b.hasOwnProperty(d.id)||(b[d.id]={id:d.id,text:d.text});var e=b[d.id];e.desktop=d.desktop;e.desktop_align=d.desktop_align;e.desktop_index=d.desktop_index;e.desktop_type=d.desktop_type;e.desktop_folder_id=d.desktop_folder_id;e.desktop_fixed=d.desktop_fixed;e.desktop_fixed_index=d.desktop_fixed_index;e.desktop_from=d.desktop_from;e.desktop_locked=d.desktop_locked}}c.Server.setSilence(!0);c.Server.saveExtConfig($.md5("SystemDesktopMenus"),
"DesktopMenu",c.Json.objectToJson(b),function(f,g){c.Server.setSilence(!1)})}catch(f){}}};m.restoreMenu=function(){return new Ext.Promise(function(b,a){try{c.Server.showExtConfig($.md5("SystemDesktopMenus"),"DesktopMenu",function(d,e){b(e)})}catch(d){a(d)}})};m.showDesktopBackgroundImages=function(b){var a=c.System.getExt("desktopBgImages");if(a){b||(b={getId:function(){return(new Date).getTime()}});var d=Ext.ComponentQuery.query("[buttonId\x3d"+b.getId()+"]");if(0<d.length)c.Component.shakeComment(d[0]);
else{d=c.Json.jsonToObject(a.value);a=[];for(var e=0;e<d.length;e++)a.push({xtype:"image",src:d[e],height:100,margin:5,width:100,style:{objectFit:"cover"},listeners:{afterrender:function(f){f.getEl().on("click",c.DesktopEvent.onFastDesktopImageClick,f)}}});d=parseInt((.6*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:"\u9009\u62e9\u684c\u9762\u80cc\u666f\u56fe\u7247",height:d,width:565,iconCls:b.iconCls,layout:"fit",buttonId:b.getId(),hideAction:"destroy",desktopWin:!0,
resizable:!1,constrain:!0,maximizable:!1,items:[{xtype:"container",layout:"column",scrollable:!0,margin:5,items:a}],listeners:{show:function(f){c.Desktop.refreshActiveToolbarButton()}}}).show()}}else c.Dialog.toast("\u6682\u65e0\u53ef\u7528\u56fe\u7247\u9009\u62e9\uff01")};m.showFolderByMenuId=function(b,a){(a=c.Desktop.getMenu(a))&&c.Desktop.showFolder(b,a)};m.showFolder=function(b,a,d){c.Desktop.hasWindowMenu(a)||(b=Ext.ComponentQuery.query("[menuWindowGroup\x3d"+a.treeGroup+"]"),0<b.length?(b[0].updateFolderMenu(a,
!1),b[0].show()):(b=parseInt((.4*document.body.clientHeight).toFixed(0)),b=Ext.create("Ext.window.Window",{layout:"fit",title:"\u6587\u4ef6\u5939",height:b,width:6*(c.Desktop.getDesktopButtonTitleMaxWidth()+10)+10,minHeight:100,minWidth:100,menuData:a,desktopWin:!0,resizable:!0,constrainHeader:!0,maximizable:!0,userCls:"fast-ext-folder-window",items:[c.Desktop.buildDesktopItemPanel([],!1,!1,!0)],tools:[{itemId:"edit",iconCls:"extIcon extEdit whiteColor",hidden:!c.Desktop.checkMenuByUserFolder(a),
callback:function(e){c.Desktop.showEditFolderName(e.menuData)}}],listeners:{afterrender:function(){if(!c.Desktop.checkSystemLockedFolderMenu(this.menuData))this.getEl().on("contextmenu",c.DesktopEvent.onFastDesktopFolderContextMenu,this)},show:function(e){var f=this.getMuuriGridContainer();f&&(f.folder=!0,f.folderId=this.menuData.id,f.folderLocked=c.Desktop.checkSystemLockedFolderMenu(this.menuData),f.bindMuuriGrid(function(){e.updateFolderMenu(e.menuData,!1)}));c.Desktop.refreshActiveToolbarButton()},
resize:function(){var e=this.getMuuriGridContainer();e&&e.muuriGridLayout()},beforedestroy:c.Desktop.recordMenu,destroy:c.DesktopEvent.onFastWindowMenuDestroy,activate:c.Desktop.refreshActiveToolbarButton,hide:c.Desktop.refreshActiveToolbarButton,close:c.Desktop.refreshActiveToolbarButton},bbar:{xtype:"container",border:0,padding:"5 5 5 5",itemId:"menuPathContainer",style:{background:"#f0f0f0"}},setFolderTitle:function(e){this.setTitle(c.Desktop.checkSystemLockedFolderMenu(e)?e.text+"\x3cspan style\x3d'font-size: xx-small'\x3e\u3010\u5df2\u9501\u5b9a\u3011\x3c/span\x3e":
e.text);this.realTitle=e.text},getMuuriGridContainer:function(){return this.down("[desktopItemContainer\x3dtrue]")},updateFolderMenu:function(e,f){f||(f=this.getMuuriGridContainer(),f.removeAllDesktopItem(),f.addDesktopItems(c.Desktop.getFolderChildMenus(e.id)));(f=this.down("#menuPathContainer"))&&f.update(c.Desktop.getMenuPath(e,null,"16px"));this.setFolderTitle(e);this.setIcon(c.System.takeIcon(c.Desktop.safeGetMenuIcon(e),"#ffffff"));this.menuData=e;this.menuId=e.id;this.menuWindowGroup=e.treeGroup;
(f=c.Desktop.getDesktopToolbarButtonByGroup(e))&&f.updateMenu(e);c.Desktop.refreshActiveToolbarButton()}}),c.Desktop.addDesktopToolbarButton(a),d&&c.Desktop.activeToolbarButton(a.id),c.Desktop.desktopPanel.add(b),b.show()))};m.getFolderChildMenus=function(b){var a=c.System.getMenuData(b);if(c.Desktop.checkSystemLockedFolderMenu(a)){for(b=0;b<a.children.length;b++){var d=a.children[b];d.desktop_temp=!0;c.Base.toBool(d.leaf,!0)||(d.desktop_type="folder")}return a.children}a=[];for(d in c.Desktop.desktopAllMenusInfo){var e=
c.Desktop.desktopAllMenusInfo[d];e.desktop_folder_id===b&&c.Base.toBool(e.desktop,!0)&&a.push(e)}a.sort(function(f,g){return f.desktop_index-g.desktop_index});return a};m.checkMuuriGridContainer=function(b,a){for(var d=0;d<c.Desktop.muuriGridContainers.length;d++){var e=c.Desktop.muuriGridContainers[d];if(!c.Base.toBool(e.folderLocked,!1)&&!e.getRegion(!1,!1).isOutOfBound({x:b,y:a}))return e}return null};m.buildFolderMenu=function(b){if(Ext.isEmpty(b))return null;var a=c.Objects.safeSplit(b,"@");
b=$.md5("Folder"+b);c.Desktop.desktopAllMenusInfo[b]={id:b,text:a[a.length-1],icon:c.Desktop.folderIcon,color:c.Desktop.folderColor,desktop_type:"folder",desktop_from:"user",treeGroup:c.Base.buildOnlyCode("F")};return c.Desktop.desktopAllMenusInfo[b]};m.refreshMuuriGridContainers=function(){c.Desktop.muuriGridContainers=c.Desktop.desktopPanel.query("[desktopItemContainer\x3dtrue]");c.Desktop.muuriGridContainers.sort(function(b,a){var d=b.up("window");d||(d=b);(b=a.up("window"))||(b=a);a=c.Base.toInt(d.getEl().getZIndex(),
0);return c.Base.toInt(b.getEl().getZIndex(),0)-a})};m.refreshMuuriGridMenuIndex=function(){for(var b=c.Desktop.desktopPanel.query("[desktopFixedMenuButton\x3dtrue]"),a=0;a<b.length;a++){var d=b[a];d.menuData&&(d.menuData.desktop_fixed=!0,d.menuData.desktop_fixed_index=a)}for(a=0;a<c.Desktop.muuriGridContainers.length;a++)c.Desktop.muuriGridContainers[a].getAllDesktopItemMenus()};m.checkMenuInFolder=function(b){return b?!Ext.isEmpty(b.desktop_folder_id)&&"desktop"!==b.desktop_folder_id&&(b=c.Desktop.getMenu(b.desktop_folder_id))?
c.Desktop.checkSystemLockedFolderMenu(b)?!1:c.Base.toBool(b.desktop):!1:!1};m.checkMenuByUserFolder=function(b){return"user"===c.Base.toString(b.desktop_from,"system")&&"folder"===b.desktop_type};m.checkMenuFolder=function(b){return b?"folder"===b.desktop_type||c.Desktop.checkSystemLockedFolderMenu(b)?!0:!1:!1};m.checkMenuLocked=function(b){return c.Base.toBool(b.desktop_locked,!1)};m.updateDesktopMenuButton=function(b){if(b){var a=c.Desktop.checkMenuFolder(b),d=[b.icon];if(a){d=[];var e=c.Desktop.getFolderChildMenus(b.id);
for(a=0;a<e.length&&(d.push(c.Desktop.safeGetMenuIcon(e[a])),4!==d.length);a++);}e="";for(a=0;a<d.length;a++)e+="\x3cimg data-menu-icon\x3d'true' src\x3d'"+c.System.takeIcon(d[a],"#ffffff")+"'  alt\x3d'"+b.text+"' /\x3e";d=$("[data-menu-id\x3d"+b.id+"]");d.find("[data-menu-text]").text(b.text);d.find("[data-menu-bg]").html(e)}};m.updateMenuInfo=function(b){c.Desktop.updateDesktopMenuButton(b);var a=c.Desktop.getWindowMenu(b);a&&a.updateFolderMenu(b,!0)};m.showEditFolderName=function(b){c.Dialog.showPrompt("\u91cd\u547d\u540d\u6587\u4ef6\u5939",
"\u8bf7\u8f93\u5165\u65b0\u7684\u6587\u4ef6\u5939\u540d",function(a,d){"ok"===a&&(b.text=d,c.Desktop.updateMenuInfo(b),c.Desktop.recordMenu())},!1,b.text)};m.checkSystemLockedFolderMenu=function(b){return b?b.webMenu&&b.children&&!c.Base.toBool(b.leaf,!0):!1};m.updateFolderGridMenu=function(b){b&&(b=Ext.getCmp(b.containerId))&&b.folder&&c.Desktop.updateDesktopMenuButton(c.Desktop.getMenu(b.folderId))};m.switchMuuriGrid=function(b,a,d){if(b=Ext.getCmp(b.containerId))if(a=a.getElement(),d=$(a),a=d.attr("data-menu-id"),
d=d.attr("data-menu-type"),a=c.Desktop.getMenu(a))a.desktop_folder_id=b.folder?b.folderId:"desktop",c.Base.toBool(b.alignRight,!1)?a.desktop_align="right":a.desktop_align="left",a.desktop_type=d};m.safeGetMenuIcon=function(b){if(!b)return null;var a=b.icon;Ext.isEmpty(a)&&(a=c.Desktop.checkMenuFolder(b)?c.Desktop.folderIcon:"icons/icon_function.svg",b.icon=a);return a};m.safeGetMenuColor=function(b){var a=b.color;Ext.isEmpty(a)&&(a=c.Desktop.checkMenuFolder(b)?c.Desktop.folderColor:c.Color.toColor(c.System["theme-color"].value));
return a};m.showDeleteFolder=function(){if(!(0<Ext.ComponentQuery.query("[deleteFolderWin\x3dtrue]").length)){var b=Ext.create("Ext.window.Window",{height:120,width:120,layout:"absolute",deleteFolderWin:!0,frame:!0,header:!1,shadow:!1,animateDisable:!0,style:{background:"transparent"},bodyStyle:{background:"transparent"},items:[c.Desktop.buildDesktopItemPanel([],!1,!1,!1),{xtype:"container",anchor:"100% 100%",html:"\x3cdiv style\x3d'width: 100%;height: 100%;display: flex;align-items: center;justify-content: center;font-size: xxx-large;'\x3e\x3cspan class\x3d'extIcon extDelete' style\x3d'font-size: 80px;text-shadow: 0px 0px 20px red;color: #ff3200;'\x3e\x3c/span\x3e\x3c/div\x3e"}],
listeners:{show:function(a){if(a=this.getMuuriGridContainer())a.deleteFolder=!0,a.bindMuuriGrid()}},getMuuriGridContainer:function(){return this.down("[desktopItemContainer\x3dtrue]")}});c.Desktop.desktopPanel.add(b);b.show()}};m.hideDeleteFolder=function(){for(var b=Ext.ComponentQuery.query("[deleteFolderWin\x3dtrue]"),a=0;a<b.length;a++){var d=b[a];d.getMuuriGridContainer().removeAllDesktopItem();d.close()}c.Desktop.recordMenu()};m.getMenuPath=function(b,a,d){b=c.System.getPathMenu(b);for(var e=
'\x3cdiv style\x3d"display: flex;align-items: center;" \x3e',f=0;f<b.length;f++){var g=b[f];g="\x3cdiv data-menu-id\x3d'"+g.id+"' onclick\x3d\""+(f!==b.length-1?"FastExt.DesktopEvent.onFastWindowMenuClick(this)":"")+'"  style\x3d"display: flex;align-items: center;" class\x3d\''+(f!==b.length-1?"fast-desktop-menu-path-click":"")+"'\x3e \x3cimg src\x3d\""+c.System.takeIcon(g.icon,a)+"\"  width\x3d'"+d+"' height\x3d'"+d+'\' /\x3e\x3cspan style\x3d"margin-left: 5px;"\x3e'+g.text+"\x3c/span\x3e \x3c/div\x3e";
0!=f&&(g="\x3cspan style\x3d'font-size: 12px;margin: 0 5px;color: #cbcbcb;' class\x3d'extIcon extArrowRight2'\x3e\x3c/span\x3e"+g);e+=g}return e+"\x3c/div\x3e"};m.getWindowMenu=function(b){b=Ext.ComponentQuery.query("[menuId\x3d"+b.id+"]");return 0<b.length?b[0]:null};m.hasWindowMenu=function(b){var a=c.Desktop.getWindowMenu(b);if(a){if(b=c.Desktop.getDesktopToolbarButton(b))a.animateTarget=b;a.isVisible()?c.Component.shakeComment(a):a.show();return!0}return!1};m.resetWindowMenuAnimTarget=function(b,
a){if(b=c.Desktop.getWindowMenu(b))b.animateTarget=a};m.muuriContainerIdIndex=1;m.lastActiveMenuId=null;m.lastSelectDesktopImageId=null;m.muuriGridContainers=null;m.folderIcon="icons/icon_system_file.svg";m.folderColor="#FFBB00";m.desktopAllMenusInfo={};m.disabledRecordMenu=!1;m.disabledMenuPathClick=!1;return m}();c.Desktop=v;v=function(){function m(){}m.onFastWindowMenuDestroy=function(){c.Desktop.removeDesktopToolbarButton(this.menuData);this.menuData=null};m.onFastToolBarMenuButtonClick=function(){var b=
this.menuData;if(b){var a=c.Desktop.getWindowMenu(b);a?(a.animateTarget=this,a.isVisible()?(b=c.Desktop.getTopDesktopWindow())&&b.getId()!==a.getId()?Ext.WindowManager.bringToFront(a,!0):a.hide():a.show()):c.Desktop.showWindowMenu(this,b)}};m.onFastToolbarMenuButtonContextMenu=function(b){var a=this;b=c.Desktop.checkDesktopButton(a.menuData);var d=c.Desktop.checkDesktopToolbarFixedButton(a.menuData);Ext.create("Ext.menu.Menu",{items:[{text:"\u5173\u95ed\u5f53\u524d",iconCls:"extIcon extClose",handler:function(){c.Desktop.closeToolbarMenuButton(a)}},
"-",{text:"\u5173\u95ed\u6240\u6709",iconCls:"extIcon extCloseAll",handler:function(){c.Desktop.closeAllToolbarMenuButton()}},{text:"\u5173\u95ed\u5de6\u4fa7",iconCls:"extIcon extCloseOther",handler:function(){c.Desktop.closeOtherToolbarMenuButton(a,"left")}},{text:"\u5173\u95ed\u5176\u4ed6",iconCls:"extIcon extCloseOther",handler:function(){c.Desktop.closeOtherToolbarMenuButton(a,"all")}},{text:"\u5173\u95ed\u53f3\u4fa7",iconCls:"extIcon extCloseOther",handler:function(){c.Desktop.closeOtherToolbarMenuButton(a,
"right")}},"-",{text:"\u6dfb\u52a0\u5feb\u6377\u65b9\u5f0f",iconCls:"extIcon extLinks editColor",hidden:b,handler:function(){c.Desktop.addDesktopButton(a.menuData)}},{text:"\u79fb\u9664\u5feb\u6377\u65b9\u5f0f",iconCls:"extIcon extLinks redColor",hidden:!b,handler:function(){c.Desktop.removeDesktopButton(a.menuData)}},"-",{text:"\u56fa\u5b9a\u5230\u5de5\u5177\u680f",iconCls:"extIcon extTags editColor",hidden:d,handler:function(){c.Desktop.addDesktopToolbarFixedButton(a.menuData)}},{text:"\u53d6\u6d88\u5de5\u5177\u680f\u56fa\u5b9a",
iconCls:"extIcon extTags redColor",hidden:!d,handler:function(){c.Desktop.removeDesktopToolbarFixedButton(a.menuData)}}],listeners:{hide:function(){this.delayClose(100)}}}).showBy(a)};m.onFastDesktopItemClick=function(b){b.preventDefault();b.stopPropagation();b=$(this);var a=b.attr("data-menu-id");c.Desktop.showWindowMenu(b[0],c.Desktop.getMenu(a))};m.onFastMenuItemContextMenu=function(b,a,d){var e=b.up("menu");e&&(e.holdShow=!0);b=a.leaf;var f=c.Desktop.getMenu(a.id);b||(f.desktop_type="folder");
b=c.Desktop.checkDesktopButton(f);var g=c.Desktop.checkDesktopToolbarFixedButton(f),h=c.Desktop.checkMenuInFolder(f);a=c.Desktop.checkMenuLocked(a);a=Ext.create("Ext.menu.Menu",{items:[{text:"\u6253\u5f00\u529f\u80fd",iconCls:"extIcon extMouseClick searchColor",handler:function(){c.Desktop.showWindowMenu(this,f)}},"-",{text:"\u6dfb\u52a0\u5feb\u6377\u65b9\u5f0f",iconCls:"extIcon extLinks editColor",hidden:a||b,handler:function(){c.Desktop.addDesktopButton(f)}},{text:"\u79fb\u9664\u5feb\u6377\u65b9\u5f0f",
iconCls:"extIcon extLinks redColor",hidden:a||h||!b,handler:function(){c.Desktop.removeDesktopButton(f)}},{text:"\u79fb\u51fa\u6587\u4ef6\u5939",iconCls:"extIcon extFolder redColor",hidden:a||!h,handler:function(){c.Desktop.outDesktopMenuFolder(f)}},"-",{text:"\u56fa\u5b9a\u5230\u5de5\u5177\u680f",iconCls:"extIcon extTags editColor",hidden:a||g,handler:function(){c.Desktop.addDesktopToolbarFixedButton(f)}},{text:"\u53d6\u6d88\u5de5\u5177\u680f\u56fa\u5b9a",iconCls:"extIcon extTags redColor",hidden:a||
!g,handler:function(){c.Desktop.removeDesktopToolbarFixedButton(f)}}],listeners:{hide:function(){e&&(e.holdShow=!1);this.delayClose(100)}}});c.Menu.refreshItem(a);a.showAt(d.getXY())};m.onFastDesktopContextMenu=function(b){Ext.create("Ext.menu.Menu",{items:[{text:"\u65b0\u5efa\u6587\u4ef6\u5939",iconCls:"extIcon extFolder color38",handler:function(){c.Dialog.showPrompt("\u65b0\u5efa\u6587\u4ef6\u5939","\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0",function(a,d){"ok"===a&&c.Desktop.desktopPanel.addDesktopItem(c.Desktop.buildFolderMenu(d),
c.Desktop.checkMuuriGridContainer(b.clientX,b.clientY))})}},"-",{text:"\u8bbe\u7f6e\u684c\u9762\u80cc\u666f",iconCls:"extIcon extImages greenColor",handler:function(){c.Desktop.showDesktopBackgroundImages(this)}},{text:"\u81ea\u52a8\u6574\u7406\u684c\u9762",iconCls:"extIcon extTable color9",handler:function(){c.Desktop.desktopPanel.reorderDesktop();c.Desktop.recordMenu();c.Dialog.toast("\u6574\u7406\u6210\u529f\uff01")}},"-",{text:"\u670d\u52a1\u5668CPU\u76d1\u63a7",iconCls:"extIcon extCPU color129",
handler:function(){c.System.showMonitorChart("\u670d\u52a1\u5668CPU\u76d1\u63a7\u3010\u5b9e\u65f6\u76d1\u63a7\u4e2d\u3011",0)}},{text:"\u670d\u52a1\u5668\u5185\u5b58\u76d1\u63a7",iconCls:"extIcon extMemory color61",handler:function(){c.System.showMonitorChart("\u670d\u52a1\u5668\u5185\u5b58\u76d1\u63a7\u3010\u5b9e\u65f6\u76d1\u63a7\u4e2d\u3011",1)}},{text:"\u7cfb\u7edfJVM\u76d1\u63a7",iconCls:"extIcon extJVM color144",handler:function(){c.System.showMonitorChart("\u7cfb\u7edfJVM\u76d1\u63a7\u3010\u5b9e\u65f6\u76d1\u63a7\u4e2d\u3011",
2)}},{text:"\u670d\u52a1\u5668\u66f4\u591a\u76d1\u63a7",iconCls:"extIcon extMonitor color25",handler:function(){c.Desktop.showWindowPanel(this,"\u7cfb\u7edf\u76d1\u63a7\u4fe1\u606f",c.System.getSystemMonitor(!1))}},"-",{text:"\u7cfb\u7edf\u5168\u5c40\u8bbe\u7f6e",iconCls:"extIcon extSet color12",handler:function(){c.Desktop.showWindowPanel(this,"\u7cfb\u7edf\u5168\u5c40\u8bbe\u7f6e",c.System.getSystemConfig(!1))}}],listeners:{hide:function(){this.delayClose(100)}}}).showAt(b.getXY())};m.onFastDesktopItemContextMenu=
function(b){b.stopPropagation();var a=$(this),d=a.attr("data-menu-id"),e=c.Desktop.getMenu(d);d=c.Desktop.checkMenuInFolder(e);var f=c.Desktop.checkDesktopButton(e),g=c.Desktop.checkDesktopToolbarFixedButton(e),h=c.Desktop.checkMenuByUserFolder(e),k=c.Desktop.checkMenuLocked(e);d=Ext.create("Ext.menu.Menu",{items:[{text:"\u6253\u5f00\u529f\u80fd",iconCls:"extIcon extMouseClick searchColor",handler:function(){c.Desktop.showWindowMenu(a[0],e)}},{text:"\u91cd\u547d\u540d\u6587\u4ef6\u5939",iconCls:"extIcon extEdit color68",
hidden:!h,handler:function(){c.Desktop.showEditFolderName(e)}},"-",{text:"\u6dfb\u52a0\u5feb\u6377\u65b9\u5f0f",iconCls:"extIcon extLinks editColor",hidden:k||f,handler:function(){c.Desktop.addDesktopButton(e)}},{text:"\u79fb\u9664\u5feb\u6377\u65b9\u5f0f",iconCls:"extIcon extLinks redColor",hidden:k||d||!f,handler:function(){c.Desktop.removeDesktopButton(e)}},{text:"\u79fb\u51fa\u6587\u4ef6\u5939",iconCls:"extIcon extFolder redColor",hidden:k||!d,handler:function(){c.Desktop.outDesktopMenuFolder(e)}},
"-",{text:"\u56fa\u5b9a\u5230\u5de5\u5177\u680f",iconCls:"extIcon extTags editColor",hidden:k||g,handler:function(){c.Desktop.addDesktopToolbarFixedButton(e)}},{text:"\u53d6\u6d88\u5de5\u5177\u680f\u56fa\u5b9a",iconCls:"extIcon extTags redColor",hidden:k||!g,handler:function(){c.Desktop.removeDesktopToolbarFixedButton(e)}}],listeners:{hide:function(){this.delayClose(100)}}});c.Menu.refreshItem(d);d.showAt(b.clientX,b.clientY);return!1};m.onFastMuuriGridSend=function(b){c.Desktop.switchMuuriGrid(b.toGrid,
b.item,!1);c.Desktop.updateFolderGridMenu(b.toGrid);c.Desktop.updateFolderGridMenu(b.fromGrid)};m.onFastMuuriGridDragInit=function(){c.Desktop.showDeleteFolder();c.Desktop.refreshMuuriGridContainers()};m.onFastMuuriGridDragSort=function(){for(var b=[],a=0;a<c.Desktop.muuriGridContainers.length;a++){var d=c.Desktop.muuriGridContainers[a];d.folderLocked||b.push(c.MuuriTool.getMuuriGrid(d))}return b};m.onFastMuuriGridDragStartPredicate=function(b,a){var d=c.Desktop.getMenuByMuuriGridItem(b);return d&&
c.Base.toBool(d.desktop_locked,!1)?!1:Muuri.ItemDrag.defaultStartPredicate(b,a,{distance:10,delay:50})};m.onFastMuuriGridDragSortPredicate=function(b,a){if(a=c.Desktop.checkMuuriGridContainer(a.clientX,a.clientY)){a=c.MuuriTool.getMuuriGrid(a);var d=b.getGrid();if(a&&d&&d._id!==a._id)return{grid:a,index:-1,action:"move"}}return(b=Muuri.ItemDrag.defaultSortPredicate(b,{threshold:50,action:"move",migrateAction:"move"}))&&(a=c.Desktop.getMenuByMuuriGridItem(b.grid.getItem(b.index)))&&c.Base.toBool(a.desktop_locked,
!1)?!1:b};m.onFastMuuriGridDragEnd=function(b){c.DesktopEvent.onFastMuuriGridChange(b);c.Desktop.hideDeleteFolder()};m.onFastMuuriGridChange=function(b){var a=[];Ext.isArray(b)?a=b:a.push(b);c.Desktop.refreshMuuriGridMenuIndex();for(b=0;b<a.length;b++){var d=a[b],e=d.getGrid();e&&e.containerId&&(c.Desktop.switchMuuriGrid(e,d,!1),c.Desktop.updateFolderGridMenu(e))}c.Desktop.recordMenu()};m.onFastToolbarStartDrag=function(b,a,d,e,f){if(b=c.Desktop.desktopPanel.down("#DesktopToolBar")){d=c.Base.toBool(d.desktopFixedMenuButton,
!1);e=b.query("[desktopMenuButton\x3dtrue]");for(a=0;a<e.length;a++)e[a].reorderable=!d;b=b.query("[desktopFixedMenuButton\x3dtrue]");for(a=0;a<b.length;a++)b[a].reorderable=d}};m.onFastToolbarDrop=function(){var b=c.Desktop.desktopPanel.down("#DesktopToolBar");if(b){for(var a=b.query("[desktopMenuButton\x3dtrue]"),d=0;d<a.length;d++)a[d].reorderable=!0;b=b.query("[desktopFixedMenuButton\x3dtrue]");for(d=0;d<b.length;d++)b[d].reorderable=!0}c.Desktop.recordMenu()};m.onFastDesktopImageClick=function(){if(c.Desktop.lastSelectDesktopImageId){var b=
Ext.getCmp(c.Desktop.lastSelectDesktopImageId);b&&b.setStyle("border","0")}this.setStyle("border","2px solid red");c.Desktop.lastSelectDesktopImageId=this.getId();c.Desktop.desktopContainer.setStyle({backgroundImage:"url('"+this.getSrc()+"')",backgroundSize:"cover"});c.System["desktop-bg-image"].value=this.getSrc();c.Server.saveSystemConfig("desktop-bg-image",this.getSrc())};m.onFastDesktopFolderContextMenu=function(b){Ext.create("Ext.menu.Menu",{items:[{text:"\u65b0\u5efa\u6587\u4ef6\u5939",iconCls:"extIcon extFolder color38",
handler:function(){c.Dialog.showPrompt("\u7cfb\u7edf\u63d0\u9192","\u8bf7\u8f93\u5165\u6587\u4ef6\u5939\u540d\u79f0",function(a,d){"ok"===a&&c.Desktop.desktopPanel.addDesktopItem(c.Desktop.buildFolderMenu(d),c.Desktop.checkMuuriGridContainer(b.clientX,b.clientY))})}}],listeners:{hide:function(){this.delayClose(100)}}}).showAt(b.getXY())};m.onFastWindowMenuClick=function(b){c.Desktop.disabledMenuPathClick||c.Desktop.showFolderByMenuId(b,$(b).attr("data-menu-id"))};return m}();c.DesktopEvent=v})(FastExt||
(FastExt={}));
(function(c){var v=function(){function m(){}m.showWait=function(b){Ext.MessageBox.show({modal:!0,title:"\u7cfb\u7edf\u63d0\u9192",msg:b,iconCls:"extIcon extTimer",progressText:"\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u5373\u5c06\u5b8c\u6210\u64cd\u4f5c",progress:!0,closable:!1});var a=0,d=function(){Ext.MessageBox.isHidden()||(a+=.5,130===a&&(a=0),Ext.MessageBox.updateProgress(a/100,"\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u5373\u5c06\u5b8c\u6210\u64cd\u4f5c"),Ext.MessageBox.timeoutProcess=setTimeout(d,
5))};Ext.MessageBox.timeoutProcess&&clearTimeout(Ext.MessageBox.timeoutProcess);Ext.MessageBox.timeoutProcess=setTimeout(d,5)};m.hideWait=function(){Ext.MessageBox.isVisible()&&Ext.MessageBox.close()};m.toast=function(b){var a=parseInt((.7*document.body.clientWidth).toFixed(0)),d=2E3,e=$("\x3cdiv\x3e"+b+"\x3c/div\x3e").text().length;8<e&&(d=3E3);50<e&&(d=5E3);80<e&&(d=8E3);Ext.toast({html:b,closable:!0,align:"t",slideInDuration:200,slideBackDuration:200,minWidth:180,autoCloseDelay:d,maxWidth:a,justTop:!0,
unpin:!1,slideBackAnimation:"easeOut",iconCls:"extIcon extInfo",title:"\u6d88\u606f\u63d0\u793a"})};m.showHtml=function(b,a,d,e){b=parseInt((.6*document.body.clientWidth).toFixed(0));var f=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.isEmpty(e)&&(e=!0);Ext.create("Ext.window.Window",{title:a,layout:"fit",height:f,width:b,minHeight:500,minWidth:600,constrain:!0,resizable:!0,maximizable:!0,modal:e,maximized:!1,iconCls:"extIcon extSee",draggable:!0,scrollable:!0,html:d,toFrontOnShow:!0}).show()};
m.showLink=function(b,a,d,e,f){b=parseInt((.6*document.body.clientWidth).toFixed(0));var g=parseInt((.7*document.body.clientHeight).toFixed(0)),h="iFrameLink"+(new Date).getTime(),k="iFrameLoadDone"+(new Date).getTime(),l=Ext.create("Ext.container.Container",{layout:"border",region:"center",border:0,iframePanel:!0});window[k]=function(){l.setLoading(!1);Ext.isFunction(f)&&f(h);window[k]=null};Ext.create("Ext.window.Window",c.Json.mergeJson({title:a,layout:"fit",height:g,width:b,minHeight:500,minWidth:600,
resizable:!0,maximizable:!0,modal:!0,constrain:!0,maximized:!1,iconCls:"extIcon extSee",draggable:!0,scrollable:!1,toFrontOnShow:!0,items:[l],listeners:{show:function(){l.setLoading("\u6b63\u5728\u52aa\u529b\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");l.update("\x3ciframe name\x3d'"+h+"' onload\x3d'"+k+"()' src\x3d'"+d+"'  width\x3d'100%' height\x3d'100%' frameborder\x3d'0'\x3e")},close:function(){window[k]=null}}},e)).show()};m.showEditorHtml=function(b,a,d,e){b=parseInt((.6*document.body.clientWidth).toFixed(0));
e=parseInt((.8*document.body.clientHeight).toFixed(0));var f="ShowEditorFrame"+(new Date).getTime(),g=Ext.create("Ext.container.Container",{layout:"border",region:"center",border:0,iframePanel:!0});Ext.create("Ext.window.Window",{title:a,layout:"fit",height:e,width:b,minHeight:500,minWidth:600,resizable:!0,maximizable:!0,modal:!0,constrain:!0,maximized:!1,iconCls:"extIcon extSee",draggable:!0,scrollable:!1,toFrontOnShow:!0,items:[g],listeners:{show:function(h,k){h=c.System.formatUrlVersion("base/editor/show.html");
window[f+"ShowEditorDone"]=function(){window[f].window.showContent(d)};g.update("\x3ciframe name\x3d'"+f+"' src\x3d'"+h+"'  width\x3d'100%' height\x3d'100%' frameborder\x3d'0'\x3e")},destroy:function(){window[f]=null;window[f+"ShowEditorDone"]=null}},buttons:[{text:"\u6253\u5370",iconCls:"extIcon extPrint",handler:function(){window[f].window.print()}}]}).show()};m.showContent=function(b,a,d,e){this.showText(b,null,a,d,e)};m.showText=function(b,a,d,e,f){var g=parseInt((.6*document.body.clientWidth).toFixed(0)),
h=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.isEmpty(a)&&(a="extIcon extSee");Ext.isEmpty(f)&&(f=!0);Ext.create("Ext.window.Window",{title:d,icon:a,iconCls:a,maximizable:!0,height:h,width:g,minHeight:500,minWidth:600,resizable:!0,layout:"fit",animateTarget:b,items:[{xtype:"textarea",value:e}],modal:f,constrain:!0}).show()};m.showCode=function(b,a,d,e){try{b&&Ext.isFunction(b.blur)&&b.blur();Ext.isEmpty(e)&&(e="");var f=parseInt((.6*document.body.clientWidth).toFixed(0)),g=parseInt((.7*
document.body.clientHeight).toFixed(0)),h=Ext.create("Ext.window.Window",{title:"\u67e5\u770b\u5185\u5bb9",height:g,width:f,minHeight:500,minWidth:600,animateTarget:b,resizable:!0,layout:"fit",maximizable:!0,iconCls:"extIcon extSee",autoScroll:!0,modal:!0,constrain:!0,bodyStyle:{background:"#000000"},listeners:{show:function(k){PR.prettyPrint()}}});d?h.update("\x3cpre class\x3d'prettyprint "+e+" linenums windowpre'\x3e"+a+"\x3c/pre\x3e"):h.update("\x3cpre class\x3d'prettyprint "+e+" windowpre'\x3e"+
a+"\x3c/pre\x3e");h.show()}catch(k){c.Dialog.showText(b,null,"\u67e5\u770b\u5185\u5bb9",a)}};m.showSql=function(b,a){try{a=sqlFormatter.format(a),c.Dialog.showCode(b,a,!1,"lang-sql")}catch(d){c.Dialog.showText(b,null,"\u67e5\u770b\u5185\u5bb9",a)}};m.showException=function(b,a){if(b){c.Dialog.hideWait();if(c.Base.toBool(c.System.getExt("debug").value,!1)){var d=b;b instanceof Error&&(d=b.stack,d=d.replace(/\n/g,"\x3cbr/\x3e").replace(/\t/g,"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;").replace(/ /g,"\x26nbsp;\x26nbsp;"));
a=null!=a?a+("\uff0c\u6765\u81ea"+a):"";var e=Ext.create("Ext.window.Window",{title:"\u7cfb\u7edf\u5f02\u5e38",height:180,width:270,layout:"fit",resizable:!1,maximizable:!1,constrain:!0,fixed:!0,modal:!0,draggable:!1,iconCls:"extIcon extError",html:"\x3cdiv  style\x3d'padding:15px;background: #fff;' align\x3d'center'\x3e\u3010"+a+"\u3011\u7cfb\u7edf\u53d1\u751f\u5f02\u5e38\uff0c\u8bf7\u53ca\u65f6\u544a\u77e5\u7cfb\u7edf\u7ba1\u7406\u5458\uff01\x3c/div\x3e",buttons:[{text:"\u4e0b\u6b21\u518d\u8bf4",
flex:1,iconCls:"extIcon extClose whiteColor",handler:function(){e.close()}},{text:"\u67e5\u770b\u9519\u8bef",flex:1,iconCls:"extIcon extException whiteColor",handler:function(){c.Dialog.showCode(this,d,!0)}}]});e.show()}0<=c.Base.toString(a,"").indexOf("\u8bf7\u6c42\u5f02\u5e38")||console.error(b)}};m.showAlert=function(b,a,d,e,f){Ext.isEmpty(e)&&(e=!0);c.Dialog.hideWait();a=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",layout:{type:"vbox",pack:"center",align:"middle"},
defaults:{margin:"5 5 5 5"},border:0,items:[{xtype:"label",maxWidth:380,html:a}]});var g=Ext.create("Ext.window.Window",{title:b,iconCls:"extIcon extInfo2",maxWidth:500,maxHeight:800,minWidth:220,layout:{type:"vbox",pack:"center",align:"middle"},constrain:!0,resizable:!1,unpin:!1,items:[a],modal:e,animateDisable:f,listeners:{show:function(h){h.focus()},render:function(h,k){new Ext.util.KeyMap({target:h.getEl(),key:13,fn:function(l,n){g.close();Ext.isFunction(d)&&d("ok")},scope:this})}},buttons:["-\x3e",
{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){var h=this.up("window");h&&h.close();Ext.isFunction(d)&&d("ok")}},"-\x3e"]});g.show()};m.showImage=function(b,a,d,e){c.Cache.memory.hasOwnProperty(a)&&(a=c.Cache.memory[a]);c.Image.showImage(b,a,d,e)};m.showVideo=function(b,a){b&&Ext.isFunction(b.blur)&&b.blur();Ext.create("Ext.window.Window",{title:"\u64ad\u653e\u89c6\u9891",layout:"fit",height:620,width:700,resizable:!1,constrain:!0,maximizable:!1,modal:!0,maximized:!1,iconCls:"extIcon extSee",
draggable:!0,scrollable:!1,toFrontOnShow:!0,listeners:{show:function(){var d=c.System.formatUrlVersion("base/video/player.html");window.getVideoUrl=function(){return a};this.update("\x3ciframe allowfullscreen\x3d'allowfullscreen' mozallowfullscreen\x3d'mozallowfullscreen' msallowfullscreen\x3d'msallowfullscreen' oallowfullscreen\x3d'oallowfullscreen' webkitallowfullscreen\x3d'webkitallowfullscreen' style\x3d'background-color: black;' name\x3d'showVideoFrame' src\x3d'"+d+"'  width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' \x3e")}}}).show()};
m.showEditor=function(b,a,d,e){b&&Ext.isFunction(b.blur)&&b.blur();var f="PublicTextArea"+(new Date).getTime(),g=parseInt((.6*document.body.clientWidth).toFixed(0)),h=parseInt((.7*document.body.clientHeight).toFixed(0)),k=Ext.create("Ext.window.Window",{title:a,iconCls:"extIcon extEdit",resizable:!0,maximizable:!0,height:h,width:g,minHeight:500,minWidth:600,layout:"fit",animateTarget:b,items:[{id:f,emptyText:"\u8bf7\u8f93\u5165\u5185\u5bb9\u2026\u2026",value:e,xtype:"textarea"}],modal:!0,constrain:!0,
unpin:!0,listeners:{show:function(l){c.Server.showExtConfig("PublicEditor","TextEditorCache",function(n,p){var q=Ext.getCmp(f);q&&(n&&q.setValue(p),q.focus())})}},buttons:[{text:"\u6682\u5b58",iconCls:"extIcon extSave whiteColor",handler:function(){c.Dialog.showWait("\u6682\u5b58\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.saveExtConfig("PublicEditor","TextEditorCache",Ext.getCmp(f).getValue(),function(l,n){c.Dialog.hideWait();l?c.Dialog.toast("\u6682\u5b58\u6210\u529f\uff01"):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",
n)})}},{text:"\u91cd\u7f6e",iconCls:"extIcon extReset",handler:function(){var l=Ext.getCmp(f);l&&l.setValue(null);c.Server.deleteExtConfig("PublicEditor","TextEditorCache")}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){c.Dialog.showWait("\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.deleteExtConfig("PublicEditor","TextEditorCache",function(l){c.Dialog.hideWait();Ext.isFunction(d)&&d(Ext.getCmp(f).getValue());k.close()})}}]});k.show()};m.showJson=function(b,a,d){c.Json.showFormatJson(b,
d,a)};m.showFormatJson=function(b,a){c.Json.showFormatJson(b,a)};m.showLottie=function(b,a){c.Lottie.showLottie(b,a)};m.showFastDatePicker=function(b,a,d){return c.Dates.showDatePicker(b,a,d)};m.showFastColorPicker=function(b,a,d){return c.Color.showColorPicker(b,a,d)};m.showMusic=function(b,a){b&&Ext.isFunction(b.blur)&&b.blur();var d=(new Date).getTime();Ext.create("Ext.window.Window",{title:"\u64ad\u653e\u97f3\u9891",layout:"fit",height:230,width:700,resizable:!1,constrain:!0,maximizable:!1,modal:!0,
maximized:!1,iconCls:"extIcon extSee",draggable:!0,scrollable:!1,toFrontOnShow:!0,items:[{xtype:"container",layout:"border",iframePanel:!0,itemId:"playerPanel"}],listeners:{show:function(e){var f=this.down("#playerPanel");f.setLoading("\u52a0\u8f7d\u97f3\u9891\u6587\u4ef6\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");var g=c.System.formatUrlVersion("base/music/player.html");f.update("\x3ciframe allowfullscreen\x3d'allowfullscreen' mozallowfullscreen\x3d'mozallowfullscreen' msallowfullscreen\x3d'msallowfullscreen' oallowfullscreen\x3d'oallowfullscreen' webkitallowfullscreen\x3d'webkitallowfullscreen' style\x3d'background-color: black;' name\x3d'showMusicFrame' src\x3d'"+
g+"'  width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' \x3e");window.getMusicUrl=function(){return a};window.onMusicChange=function(h,k){if("ready"===h)e.getComponent("playerPanel").setLoading(!1),k.play();else if("play"===h)Ext.getCmp("btnPlay"+d).setIconCls("extIcon extPause");else if("pause"===h)Ext.getCmp("btnPlay"+d).setIconCls("extIcon extPlay");else if("finish"===h)k.seekTo(0);else if("mute"===h)k.getMute()?Ext.getCmp("btnMute"+d).setIconCls("extIcon extMute"):Ext.getCmp("btnMute"+
d).setIconCls("extIcon extUnmute");else if("loading"===h)e.getComponent("playerPanel").setLoading("\u52a0\u8f7d\u97f3\u9891\u6587\u4ef6\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");else if("audioprocess"===h||"seek"===h)h=c.Dates.formatMillisecond(1E3*k.getCurrentTime(),"i:s"),k=c.Dates.formatMillisecond(1E3*k.getDuration(),"i:s"),e.setTitle("\u64ad\u653e\u97f3\u4e50  "+h+" / "+k)}}},bbar:{xtype:"toolbar",dock:"bottom",layout:{type:"hbox",align:"middle",pack:"center"},items:[{xtype:"button",id:"btnPlay"+
d,iconCls:"extIcon extPlay",action:"play",handler:function(){window.showMusicFrame.window.switchPlay()}},{xtype:"button",id:"btnStop"+d,iconCls:"extIcon extStop",handler:function(){window.showMusicFrame.window.stop()}},{xtype:"button",id:"btnMute"+d,iconCls:"extIcon extUnmute",handler:function(){window.showMusicFrame.window.switchMute()}}]}}).show()};m.showDeleteDataAlert=function(b,a,d,e){Ext.isEmpty(e)&&(e="\u5220\u9664");a=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",
layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"5 5 5 5"},border:0,items:[{xtype:"lottie",width:150,height:120,jsonPath:"base/lottie/amazed.json"},{xtype:"label",maxWidth:250,text:a},{xtype:"checkboxfield",boxLabel:"\u6211\u5df2\u4e86\u89e3\u6b64\u64cd\u4f5c\u662f\u6c38\u4e45\u6027\u4e14\u65e0\u6cd5\u64a4\u9500",listeners:{change:function(g,h){f.down("#deleteBtn").setDisabled(!h)}}}]});var f=Ext.create("Ext.window.Window",{title:b,iconCls:"extIcon extDelete",width:280,layout:{type:"vbox",
pack:"center",align:"middle"},constrain:!0,resizable:!1,unpin:!1,items:[a],modal:!0,buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){f.close()}},{text:e,itemId:"deleteBtn",disabled:!0,iconCls:"extIcon extOk",handler:function(){f.close();Ext.isFunction(d)&&d()}},"-\x3e"]});f.show()};m.showConfirm=function(b,a,d){c.Dialog.hideWait();a=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"5 5 5 5"},
border:0,items:[{xtype:"lottie",width:150,height:120,jsonPath:"base/lottie/question.json"},{xtype:"label",maxWidth:300,margin:"5 5 10 5",html:a}]});var e=Ext.create("Ext.window.Window",{title:b,iconCls:"extIcon extQuestion2",width:320,layout:{type:"vbox",pack:"center",align:"middle"},constrain:!0,resizable:!1,items:[a],modal:!0,unpin:!1,buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){e.close();Ext.isFunction(d)&&d("no")}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",
handler:function(){e.close();Ext.isFunction(d)&&d("yes")}},"-\x3e"]});e.show()};m.showPrompt=function(b,a,d,e,f){c.Dialog.hideWait();f={xtype:"textfield",itemId:"inputContent",value:f};e&&(f.xtype="textareafield",f.grow=!0,f.growMax=320);a=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",layout:{type:"vbox",pack:"center",align:"stretch"},defaults:{margin:"5 5 5 5"},border:0,items:[{xtype:"label",html:a},f]});var g=Ext.create("Ext.window.Window",{title:b,iconCls:"extIcon extEdit",
width:280,layout:{type:"vbox",pack:"center",align:"stretch"},constrain:!0,resizable:!1,items:[a],modal:!0,listeners:{show:function(h){setTimeout(function(){h.query("#inputContent")[0].focus()},200)}},buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){g.close();Ext.isFunction(d)&&d("no")}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){g.close();Ext.isFunction(d)&&d("ok",g.query("#inputContent")[0].getValue())}},"-\x3e"]});g.show()};return m}();c.Dialog=
v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.loadECharts=function(b,a){var d=function(){if(b.echarts)b.echarts.hideLoading(),b.echarts.setOption(a);else{var e=c.Base.getTargetBodyElement(b);if(e){var f="";if(Ext.isEmpty(c.ECharts.echartsThemeFile)){f=c.ECharts.echartsThemeFile.lastIndexOf("/");var g=c.ECharts.echartsThemeFile.lastIndexOf(".");f=c.ECharts.echartsThemeFile.substring(f+1,g)}b.echarts=echarts.init(e,f);b.echarts.setOption(a);b.on("destroy",function(h){c.ECharts.getECharts(h)&&(c.ECharts.getECharts(h).dispose(),
h.echarts=null)});b.on("resize",function(h){c.ECharts.getECharts(h)&&c.ECharts.getECharts(h).resize({animation:{duration:1E3}})})}else console.error("\u52a0\u8f7dECharts\u5931\u8d25\uff01\u65e0\u6cd5\u83b7\u53d6\u76ee\u6807\u63a7\u4ef6\u7684BodyElement\uff01")}};this.loadedEChartsJs?d():c.System.addScript({src:c.ECharts.echartsJsFile},function(){Ext.isEmpty(c.ECharts.echartsThemeFile)?d():c.System.addScript({src:c.ECharts.echartsThemeFile},d)})};m.getECharts=function(b){if(b.echarts)return b.echarts;
console.error("\u83b7\u53d6ECharts\u5931\u8d25\uff01\u76ee\u6807\u63a7\u4ef6\u672a\u52a0\u8f7decharts\uff01");return null};m.hasECharts=function(b){return!!b.echarts};m.showECharts=function(b,a,d){var e=parseInt((.6*document.body.clientWidth).toFixed(0)),f=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:b,iconCls:"extIcon extReport whiteColor",height:f,width:e,layout:"border",resizable:!0,maximizable:!0,constrain:!0,modal:d,padding:"10 10 10 10",bodyStyle:{background:"#ffffff"},
listeners:{show:function(g){c.ECharts.loadECharts(g,a)}}}).show()};m.echartsJsFile="base/echarts/echarts.min.js";m.echartsThemeFile="";return m}();c.ECharts=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function b(){}b.showEditor=function(a,d,e){return new Ext.Promise(function(f,g){var h=Ext.create("Ext.container.Container",{layout:"border",region:"center",iframePanel:!0,border:0,iframeName:"MonacoEditorFrame"+(new Date).getTime(),loadEditor:function(){var n=this;n.setLoading("\u52a0\u8f7d\u7f16\u8f91\u5668\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");window[this.iframeName+"LoadDone"]=function(){n.loadExtLib();n.setValue(d,e);n.setLoading(!1)};var p=c.System.formatUrlVersion("base/monaco-editor/index.html",
{});this.update("\x3ciframe name\x3d'"+this.iframeName+"'  src\x3d'"+p+"' width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' /\x3e")},setValue:function(n,p){window[this.iframeName].window.createEditor({value:n,language:p,automaticLayout:!0,accessibilitySupport:"on",autoClosingBrackets:"always",autoClosingDelete:"always",autoClosingOvertype:"always",autoClosingQuotes:"always",renderLineHighlight:"gutter",scrollBeyondLastLine:!1})},getValue:function(){return window[this.iframeName].window.getValue()},
loadExtLib:function(){}});g=parseInt((.7*document.body.clientWidth).toFixed(0));var k=parseInt((.9*document.body.clientHeight).toFixed(0)),l=Ext.create("Ext.window.Window",{title:"\u7f16\u8f91\u5185\u5bb9",height:k,width:g,minHeight:500,minWidth:600,iconCls:"extIcon extConvertCode",layout:"fit",resizable:!0,maximizable:!0,animateTarget:a,constrain:!0,items:[h],modal:!0,unpin:!0,listeners:{show:function(){h.loadEditor()},close:function(n){c.Base.runCallBack(f);window[h.iframeName]=null;window[h.iframeName+
"LoadDone"]=null}},buttons:[{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){l.close()}},{text:"\u4fdd\u5b58",iconCls:"extIcon extSave whiteColor",handler:function(){c.Base.runCallBack(f,h.getValue());l.close()}}]});l.show()})};b.showDiffEditor=function(a,d,e,f,g){Ext.isEmpty(g)&&(g="");return new Ext.Promise(function(h,k){var l=Ext.create("Ext.container.Container",{layout:"border",region:"center",iframePanel:!0,border:0,iframeName:"MonacoEditorFrame"+(new Date).getTime(),loadEditor:function(){var q=
this;q.setLoading("\u52a0\u8f7d\u7f16\u8f91\u5668\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");window[this.iframeName+"LoadDone"]=function(){q.loadExtLib();q.setValue(d,e,f);q.setLoading(!1)};var r=c.System.formatUrlVersion("base/monaco-editor/index.html",{});this.update("\x3ciframe name\x3d'"+this.iframeName+"'  src\x3d'"+r+"' width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' /\x3e")},setValue:function(q,r,u){window[this.iframeName].window.createDiffEditor(q,r,u)},getValue:function(){return window[this.iframeName].window.getValue()},
loadExtLib:function(){}});k=parseInt((.7*document.body.clientWidth).toFixed(0));var n=parseInt((.9*document.body.clientHeight).toFixed(0)),p=Ext.create("Ext.window.Window",{title:"\u7f16\u8f91\u5185\u5bb9"+g,height:n,width:k,minHeight:500,minWidth:600,iconCls:"extIcon extConvertCode",layout:"fit",resizable:!0,maximizable:!0,animateTarget:a,constrain:!0,items:[l],modal:!0,unpin:!0,listeners:{show:function(){l.loadEditor()},close:function(q){c.Base.runCallBack(h);window[l.iframeName]=null;window[l.iframeName+
"LoadDone"]=null}},buttons:[{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){p.close()}},{text:"\u4fdd\u5b58",iconCls:"extIcon extSave whiteColor",handler:function(){c.Base.runCallBack(h,l.getValue());p.close()}}]});p.show()})};return b}();c.MonacoEditor=v;v=function(){function b(){}b.showEditor=function(a,d){c.Dialog.showWait("\u83b7\u53d6\u6e90\u7801\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.loadSource(d,function(e,f,g){c.Dialog.hideWait();e?c.MonacoEditor.showEditor(a,
g,m.JavaScript).then(function(h){c.Dialog.showWait("\u4fdd\u5b58\u6e90\u7801\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.saveSource(d,h,function(k,l){c.Dialog.hideWait();k?c.Dialog.toast(l):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",l)})}):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",f)})};return b}();c.MonacoEditorEntity=v;var m;(function(b){b.TypeScript="typescript";b.JavaScript="javascript";b.CSS="css";b.LESS="less";b.SCSS="scss";b.JSON="json";b.HTML="html";b.JAVA="java";b.SQL="sql";
b.MySql="mysql";b.XML="xml";b.INI="ini";b.Text="plaintext";b.MarkDown="markdown"})(m=c.MonacoEditorLanguage||(c.MonacoEditorLanguage={}))})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.loadTinymceJs=function(b){c.Tinymce.loadedTinymce?b():c.System.addScript({src:c.Tinymce.tinymceJsPath},function(){c.Tinymce.loadedTinymce=!0;b()})};m.initTinymce=function(b,a){c.Tinymce.loadTinymceJs(function(){tinymce.init(b).then(function(d){a(d)})})};m.tinymceJsPath="base/tinymce/tinymce.min.js";m.loadedTinymce=!1;return m}();c.Tinymce=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.getEntity=function(b){for(var a=0;a<c.System.entities.length;a++){var d=c.System.entities[a];if(d.entityCode===b)return d}return null};m.isFulltextColumn=function(b,a){if(b=c.Entity.getEntity(b))if(b=b.fulltextColumns)for(var d=0;d<b.length;d++)if(b[d].name===a)return!0;return!1};m.wrapConfigs=function(b){for(var a=[],d=1;d<arguments.length;d++)a[d-1]=arguments[d];d=[];for(var e=0;e<a.length;e++)d.push(c.Entity.wrapConfig(b,a[e]));return d};m.wrapConfig=
function(b,a){if(Ext.isEmpty(b)||Ext.isEmpty(a))return null;if(!Ext.isObject(a))return a;if(a.hasOwnProperty("fieldLabel")){var d=c.Entity.getRealAttr(a);if(Ext.isEmpty(d))return a;var e=c.Entity.getEditorField(b,d);if(!e||a.hasOwnProperty("xtype")&&a.xtype!==e.xtype)return a;a=Ext.Object.merge(e,a)}else if(a.hasOwnProperty("dataIndex")){d=c.Entity.getRealAttr(a);if(Ext.isEmpty(d))return a;e=c.Entity.getEditorField(b,d);if(!e)return a;e.name=d;Ext.isEmpty(a.field)&&(a.field={});Ext.isString(a.field)&&
(a.field={xtype:a.field});var f=!0;a.field.hasOwnProperty("xtype")&&a.field.xtype!==e.xtype&&(f=!1);Ext.isObject(a.field)&&f&&(a.field=Ext.Object.merge(e,a.field));Ext.isEmpty(a.renderer)&&(a.renderer=c.Entity.getColumnRender(b,d));a.configField=a.field}return a};m.getEditorField=function(b,a){return Ext.isEmpty(b)?null:Ext.isFunction(b.getEditorField)?b.getEditorField(a):null};m.getEditorFieldObject=function(b,a){return(b=c.Entity.getEditorField(b,a))?Ext.create(b):null};m.getColumnRender=function(b,
a){return Ext.isEmpty(b)?null:Ext.isFunction(b.getColumnRender)?b.getColumnRender(a):null};m.getRealAttr=function(b){return b?Ext.isObject(b.field)&&b.field.hasOwnProperty("name")?b.field.name:b.hasOwnProperty("columnName")?b.columnName:b.hasOwnProperty("dataIndex")?b.dataIndex:c.Base.toString(b.name,"").replace("data.",""):null};m.getEditorFieldByColumn=function(b,a){return Ext.isEmpty(b)?Ext.isObject(a.field)?a.field:{xtype:a.field}:Ext.isFunction(b.getEditorField)?b.getEditorField(c.Entity.getRealAttr(a)):
null};return m}();c.Entity=v})(FastExt||(FastExt={}));var FastEnum;
(function(c){(function(v){v._blank="_blank";v._self="_self";v._parent="_parent";v._top="_top";v.framename="framename"})(c.Target||(c.Target={}));(function(v){v.left="left";v.right="right"})(c.AppendPosition||(c.AppendPosition={}));(function(v){v.sum="sum";v.avg="avg";v.min="min";v.max="max"})(c.ComputeType||(c.ComputeType={}));(function(v){v[v.mouse_right_click=0]="mouse_right_click";v[v.mouse_in_out=1]="mouse_in_out"})(c.HelpEnumType||(c.HelpEnumType={}));(function(v){v.left="left";v.top="top";v.right=
"right";v.bottom="bottom"})(c.TooltipAnchorType||(c.TooltipAnchorType={}));(function(v){v.gridcolumn="gridcolumn";v.button="button";v.menuitem="menuitem"})(c.PowerType||(c.PowerType={}))})(FastEnum||(FastEnum={}));
(function(c){var v=function(){function m(){m.initErrorHandler()}m.geErrorInfo=function(b){return b?b.error&&b.error.stack?b.error.stack:b.stack?b.stack:b.message?b.message:b.reason?b.reason:b.toString():""};m.initErrorHandler=function(){window.addEventListener("error",function(a){try{console.error(a)}catch(d){console.error(d)}});window.addEventListener("unhandledrejection",function(a){try{console.error(a)}catch(d){console.error(d)}});var b=console.error;console.error=function(a){c.Server.reportException(c.ErrorHandler.geErrorInfo(a));
b.apply(this,arguments)}};return m}();c.ErrorHandler=v})(FastExt||(FastExt={}));(function(c){var v=function(){function m(){}m.runObject=function(b,a){if(Ext.isEmpty(a))return a;for(var d=RegExp("\\${([^{}]*)}","g"),e,f=[];e=d.exec(a);)f.push(e[1]);window.RunObject=b;for(b=0;b<f.length;b++)d=f[b],e=eval("RunObject."+d),a=a.replace(new RegExp("\\${"+d+"}","g"),e);return a};return m}();c.Eval=v})(FastExt||(FastExt={}));var FastExtend;
(function(c){var v=function(){return function(){String.prototype.endWith=function(b){return!b||""===b||0===this.length||b.length>this.length?!1:this.substring(this.length-b.length)===b};String.prototype.startWith=function(b){return!b||""===b||0===this.length||b.length>this.length?!1:this.substr(0,b.length)===b};String.prototype.trim=function(b,a){return b?"left"===a||"l"===a?this.replace(new RegExp("^\\"+b+"+","g"),""):"right"===a||"r"===a?this.replace(new RegExp("\\"+b+"+$","g"),""):this.replace(new RegExp("^\\"+
b+"+|\\"+b+"+$","g"),""):this.replace(/^\s+|\s+$/g,"")};String.prototype.firstUpperCase=function(){return this.replace(/^\S/,function(b){return b.toUpperCase()})};String.prototype.truthLength=function(){return this.replace(/[\u0391-\uFFE5]/g,"aa").length};String.prototype.trimAllSymbol=function(){return this.replace(/[ |~|`|!|@|#|\$|%|\^|&|\*|\(|\)|\-|_|\+|=|\||\\|\[|\]|\{|\}|;|:|"|'|,|<|\.|>|\/|\?/\uff0c/\u3002/\uff1b/\uff1a/\u201c/\u201d/\u300b/\u300a/\|/\{/\}/\u3001/!/~/`]/g,"")};String.prototype.replaceAll=
function(b,a){return this.replace(new RegExp(b,"g"),a)}}}();c.StringExtend=v;v=function(){return function(){Array.prototype.exists=function(b){for(var a=0;a<this.length;a++)if(this[a]===b)return!0;return!1}}}();c.ArrayExtend=v;v=function(){return function(){this.iframePanel=!1;this.helpAnchorOffset=-1;Ext.Component.prototype.getEditorMenu=function(){try{return this.up("menu[editorMenu\x3dtrue]")}catch(b){console.error(b)}}}}();c.ComponentExtend=v;v=function(){return function(){this.contextMenu=!0;
this.entityAddButton=this.entityDeleteButton=this.entityUpdateButton=this.bindDetail=!1}}();c.ButtonExtend=v;v=function(){return function(){this.firstLoadedData=this.menuPanelList=!1;this.showUpdateButton=this.defaultToolBarMore=this.defaultToolBarLink=this.defaultToolBar=!0}}();c.GridExtend=v;v=function(){return function(){Ext.form.FormPanel.prototype.setFieldValue=function(b,a){(b=this.getForm().findField(b))&&b.setValue(a)};Ext.form.FormPanel.prototype.getFieldValue=function(b){return(b=this.getForm().findField(b))?
b.getValue():null};Ext.form.FormPanel.prototype.getField=function(b){return this.getForm().findField(b)};Ext.form.FormPanel.prototype.submitForm=function(b,a,d,e,f){var g=this;a||(a={});d||(d="\u6b63\u5728\u63d0\u4ea4\u4e2d\u2026\u2026");Ext.isEmpty(e)&&(e="toast");Ext.isEmpty(f)&&(f=!0);return g.submiting?new Ext.Promise(function(h,k){k({success:!1,message:"\u6570\u636e\u6b63\u5728\u63d0\u4ea4\u4e2d\uff0c\u4e0d\u53ef\u91cd\u590d\u63d0\u4ea4\uff01"})}):new Ext.Promise(function(h,k){k={submitEmptyText:!1,
params:a,success:function(n,p){g.submiting=!1;FastExt.Dialog.hideWait();"alert"===e?Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",p.result.message,function(q){"ok"===q&&h(p.result)}):("toast"===e&&FastExt.Dialog.toast(p.result.message),h(p.result))},failure:function(n,p){g.submiting=!1;FastExt.Dialog.hideWait();f&&p.result&&Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",p.result.message)}};b&&(k.params.entityCode=b.entityCode,b.menu&&(k.params.menu=FastExt.Store.getStoreMenuText({entity:b})));var l=g.getForm();
l.isValid()?(g.submiting=!0,FastExt.Dialog.showWait(d),l.submit(k)):g.submiting=!1})};Ext.form.FormPanel.prototype.saveCache=function(b){Ext.isEmpty(b)&&(b=this.cacheKey);var a={};this.getForm().getFields().each(function(d,e){Ext.isDate(d.getValue())?a[d.getName()]=Ext.Date.format(d.getValue(),d.format):a[d.getName()]=d.getValue()});b={configKey:b,configType:"FormPanelCache",configValue:Ext.encode(a)};FastExt.Dialog.showWait("\u6682\u5b58\u6570\u636e\u4e2d\u2026\u2026");$.post("ext/config/saveExtConfig",
b,function(d){FastExt.Dialog.hideWait();d.success?FastExt.Dialog.toast("\u6682\u5b58\u6210\u529f\uff01"):FastExt.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",d.message)})};Ext.form.FormPanel.prototype.restoreCache=function(b){Ext.isEmpty(b)&&(b=this.cacheKey);var a=this;$.post("ext/config/showExtConfig",{configKey:b,configType:"FormPanelCache"},function(d){if(d.success){var e=Ext.decode(d.data.configValue);a.getForm().getFields().each(function(f,g){e.hasOwnProperty(f.getName())&&f.setValue(e[f.getName()])})}})};
Ext.form.FormPanel.prototype.deleteCache=function(b){Ext.isEmpty(b)&&(b=this.cacheKey);$.post("ext/config/deleteExtConfig",{configKey:b,configType:"FormPanelCache"},function(a){})}}}();c.FormPanelExtend=v;v=function(){return function(){this.multiple=!1}}();c.FileFieldExtend=v;v=function(){return function(){this.fromHeadSearch=!1;Ext.form.field.Base.prototype.blur=function(){try{this.inputEl&&this.inputEl.blur()}catch(b){console.error(b)}};Ext.form.field.Base.prototype.addTriggers=function(b){try{if(Ext.isFunction(this.getTriggers)&&
Ext.isFunction(this.setTriggers)){var a=this.getTriggers();a?this.setTriggers(FastExt.Json.mergeJson(a,b)):this.setTriggers(b)}}catch(d){console.error(d)}}}}();c.FieldExtend=v;v=function(){return function(){this.useHistory=!1}}();c.TextFieldExtend=v;v=function(){return function(){this.searchable=!1}}();c.ComboBoxFieldExtend=v;v=function(){return function(){this.excelHeader=this.excelOutHeader=this.search=!0}}();c.ColumnExtend=v;v=function(){return function(){this.holdShow=!1}}();c.MenuExtend=v;v=
function(){return function(){this.actionTimer=this.actionCopy=this.actionDeleteAll=!0}}();c.EntityExtend=v;for(var m in c)if(Ext.isFunction(c[m]))c[m]()})(FastExtend||(FastExtend={}));
(function(c){var v=function(){function m(){}m.formatLength=function(b){return 1024>b?b+"B":1048576>b?(b/1024).toFixed(2)+"KB":(b/1024/1024).toFixed(2)+"M"};m.isSuffixFile=function(b){for(var a=[],d=1;d<arguments.length;d++)a[d-1]=arguments[d];d=b.substring(b.lastIndexOf("/")+1).toString().toLowerCase();for(var e=0;e<a.length;e++){var f=a[e].replace(".","").toLowerCase();if(d.endWith("."+f)||d.startWith(f+"-"))return!0}return!1};m.officeViewer=function(b,a){if(a)a=c.Form.buildForm("officeViewer",{url:b},
FastEnum.Target._blank),a.submit(),$(a).remove();else{a=parseInt((.8*document.body.clientWidth).toFixed(0));var d=parseInt((.9*document.body.clientHeight).toFixed(0)),e="officeViewerLoadDone"+(new Date).getTime(),f=Ext.create("Ext.container.Container",{layout:"border",region:"center",border:0,iframePanel:!0,listeners:{afterrender:function(g,h){this.setLoading("\u6b63\u5728\u8bfb\u53d6\u6587\u6863\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");var k=this;c.Server.saveCache(b,function(l,n,p){l?k.update("\x3ciframe onload\x3d'"+
e+"()' src\x3d'officeViewer?cache\x3d"+p+"'  width\x3d'100%' height\x3d'100%' frameborder\x3d'0'\x3e"):(c.Dialog.hideWait(),c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",n))})}}});window[e]=function(){f.setLoading(!1)};Ext.create("Ext.window.Window",{title:"\u9884\u89c8\u6587\u6863",iconCls:"extIcon extSee",maximizable:!0,height:d,width:a,minHeight:500,minWidth:600,resizable:!0,layout:"fit",items:[f],constrain:!0,justTop:!0,listeners:{close:function(){window[e]=null}}}).show()}};m.uploadFile=function(b,
a,d,e){return new Ext.Promise(function(f,g){g="\u4e0a\u4f20\u6587\u4ef6";var h="files",k=-1,l=-1,n="file";if(c.FileModule.validate(a,"fileModules")){1===a.length&&(g="\u4e0a\u4f20"+a[0].tipMsg,h=a[0].type,k=a[0].width,l=a[0].height);Ext.isEmpty(e)&&(e=!0);b&&(b.name&&(n=b.name),b.dataIndex&&(n=b.dataIndex));var p=Ext.create("Ext.form.FormPanel",{url:"upload",method:"POST",margin:"5",fileUpload:!0,width:400,callBacked:!1,border:0,layout:"column",items:[{xtype:"filefield",fieldLabel:g,labelWidth:60,
labelAlign:"right",buttonText:"\u9009\u62e9\u6587\u4ef6",allowBlank:!1,name:n,multiple:d,columnWidth:1,listeners:{change:function(u,t,w){if(null!=t&&0!==t.length){u="";for(w=0;w<a.length;w++){var z=a[w];if(z.match(t)){p.doSubmit();return}u=u+"\u6216"+z.tipMsg}p.form&&p.form.reset();Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u8bf7\u4e0a\u4f20\u6709\u6548\u7684"+u.substring(1))}}}},{xtype:"hiddenfield",name:"type",value:h},{xtype:"hiddenfield",name:"file.width",value:k},{xtype:"hiddenfield",name:"file.height",
value:l}],doSubmit:function(){var u=p.form;if(u.isValid()){var t=new Ext.LoadMask({msg:"\u6b63\u5728\u4e0a\u4f20\u9644\u4ef6\u4e2d\u2026",target:r});t.show();var w=function(){u.submit({success:function(x,y){c.Dialog.toast("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\uff01");f.called||(f.called=!0,f(y.result.data));r.close()},failure:function(x,y){t.destroy();y.result&&Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u4e0a\u4f20\u5931\u8d25\uff01"+y.result.message)}})},z=function(x){if(x>=a.length)w();else{var y=
a[x];Ext.isFunction(y.onFileSelect)?y.onFileSelect(p.getForm().findField(n)).then(function(A){Ext.isEmpty(A)?z(x+1):(t.destroy(),p.form&&p.form.reset(),Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",A))}):z(x+1)}};z(0)}},listeners:{render:function(u){try{new Ext.util.KeyMap({target:u.getEl(),key:13,fn:p.doSubmit,scope:Ext.getBody()})}catch(t){console.error(t)}}}}),q="btnSubmit"+(new Date).getTime(),r=Ext.create("Ext.window.Window",{title:g,layout:"fit",resizable:!1,scrollable:!1,width:500,items:p,modal:!0,
iconCls:"extIcon extUpload",animateTarget:b,constrain:!0,toFrontOnShow:!0,buttons:[{text:"\u4f7f\u7528\u5730\u5740",iconCls:"extIcon extEdit",hidden:!e,handler:function(){Ext.Msg.prompt("\u4f7f\u7528\u81ea\u5b9a\u4e49\u7684\u6587\u4ef6\u5730\u5740","\u586b\u5199\u81ea\u5b9a\u4e49\u7684\u6587\u4ef6\u8def\u5f84\uff08http\uff09\uff1a",function(u,t){"ok"!==u||Ext.isEmpty(t)||(f.called||(f.called=!0,f({url:t})),r.close())})}},{text:"\u7f51\u7edc\u540c\u6b65",iconCls:"extIcon extLink",handler:function(){Ext.Msg.prompt("\u4ece\u7f51\u7edc\u4e2d\u4e0b\u8f7d\u6587\u4ef6",
"\u586b\u5199\u7f51\u7edc\u6587\u4ef6\u8def\u5f84\uff08http\uff09\uff1a",function(u,t){"ok"===u&&(c.Dialog.showWait("\u6b63\u5728\u540c\u6b65\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026"),$.post("upload",{url:t,__accept:"application/json"},function(w){c.Dialog.hideWait();w.success?(c.Dialog.toast("\u6587\u4ef6\u4e0a\u4f20\u6210\u529f\uff01"),f.called||(f.called=!0,f(w.data)),r.close()):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u4e0a\u4f20\u5931\u8d25\uff01"+w.message)}))})}},"-\x3e",{text:"\u91cd\u7f6e",
width:88,iconCls:"extIcon extReset",handler:function(){p.form&&p.form.reset()}},{text:"\u4e0a\u4f20",width:88,id:q,iconCls:"extIcon extOk",handler:function(){p.doSubmit()}}],listeners:{show:function(u,t){p.getForm().findField(n).fileInputEl.dom.click();Ext.getCmp(q).focus()},close:function(u,t){f.called||(f.called=!0,f())}}});r.show()}})};m.showFiles=function(b,a,d,e,f,g,h,k){if(c.FileModule.validate(d,"fileModules")){var l=!0;b&&Ext.isFunction(b.blur)&&(b.blur(),l=c.Base.toBool(b.autoFileName,!0));
var n=[],p=c.Renders.file();1===d.length?(p=eval(d[0].renderer),f||(f=d[0].tipMsg+g?"\u67e5\u770b":"\u7ba1\u7406")):f||(f="\u9644\u4ef6\u7ba1\u7406");if(!Ext.isEmpty(e)){var q=e;Ext.isString(e)&&(q=Ext.JSON.decode(e));for(e=0;e<q.length;e++){var r=q[e].split("@"),u=r[0],t=u.substring(u.lastIndexOf("/")+1),w=-1;1<r.length&&(t=r[1]);2<r.length&&(w=r[2]);n.push({url:u,name:t,length:w})}}q=[];q.push({header:"\u6587\u4ef6",dataIndex:"url",flex:1,align:"center",renderer:p});if(b.showFileName||h)q.push({header:"\u6587\u4ef6\u540d",
dataIndex:"name",width:150,align:"center",field:g?null:{xtype:"textfield",listeners:{change:function(){x.modify=!0}}},renderer:c.Renders.normal()}),(b.showFileLength||k)&&q.push({header:"\u5927\u5c0f",dataIndex:"length",width:100,align:"center",field:g?null:{xtype:"numberfield",listeners:{change:function(){x.modify=!0}}},renderer:c.Renders.fileSize()});var z=Ext.now(),x=Ext.create("Ext.data.Store",{autoLoad:!0,data:n}),y=Ext.create("Ext.grid.Panel",{selModel:c.Grid.getGridSelModel(),store:x,columnLines:!0,
cellTip:!0,columns:q,plugins:[Ext.create("Ext.grid.plugin.CellEditing",{clicksToEdit:2})],selType:"cellmodel",tbar:g?null:[{xtype:"button",border:1,text:"\u5220\u9664",id:"btnDeleteFile"+z,iconCls:"extIcon extDelete",disabled:!0,handler:function(){var B=y.getSelectionModel().getSelection();0===B.length?c.Dialog.toast("\u8bf7\u60a8\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u6587\u4ef6\uff01"):Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u60a8\u786e\u5b9a\u7acb\u5373\u5220\u9664\u9009\u4e2d\u7684\u9644\u4ef6\u5417\uff1f",
function(D,G){if("yes"===D){var C={};Ext.Array.each(B,function(E,F){C["path["+F+"]"]=E.get("url")});c.Dialog.showWait("\u6b63\u5728\u5220\u9664\u4e2d\u2026\u2026");c.Server.deleteAttach(C,function(E,F){c.Dialog.hideWait();E?(y.getSelectionModel().deselectAll(),c.Dialog.toast("\u5220\u9664\u6210\u529f\uff01"),Ext.Array.each(B,function(H,I){x.remove(H);x.modify=!0})):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",F)})}})}},{xtype:"button",border:1,text:"\u4e0a\u4f20",iconCls:"extIcon extUpload",handler:function(){c.File.uploadFile(this,
d,!0).then(function(B){if(B){if(Ext.isArray(B))for(var D=0;D<B.length;D++)l||(B[D].name=""),x.add(B[D]);else l||(B.name=""),x.add(B);x.modify=!0}})}}],listeners:{selectionchange:function(){var B=this.getSelectionModel().getSelection(),D=Ext.getCmp("btnDeleteFile"+z);D&&D.setDisabled(!(0<B.length))}}}),A=Ext.create("Ext.window.Window",{title:f,height:400,width:500,minWidth:400,minHeight:300,layout:"fit",resizable:!0,modal:!0,constrain:!0,iconCls:"extIcon extFolder",animateTarget:b,items:[y],buttons:g?
null:[{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){var B=[],D=!1;x.each(function(G,C){var E=G.get("url");if(b.showFileName){E=E+"@"+G.get("name");if(Ext.isEmpty(G.get("name")))return c.Dialog.toast("\u7b2c"+(C+1)+"\u6761\u9644\u4ef6\uff0c\u8bf7\u7f16\u8f91\u6587\u4ef6\u540d\uff01"),D=!0,c.Component.shakeComment(A),!1;if(b.showFileLength&&(E=E+"@"+G.get("length"),Ext.isEmpty(G.get("length"))))return c.Dialog.toast("\u7b2c"+(C+1)+"\u6761\u9644\u4ef6\uff0c\u8bf7\u7f16\u8f91\u6587\u4ef6\u5927\u5c0f\uff01"),
D=!0,c.Component.shakeComment(A),!1}B.push(E)});D||(null!=a&&a(Ext.encode(B)),A.close())}}],listeners:{close:function(){}}});A.show()}};return m}();c.File=v;v=function(){function m(){}m.validate=function(b,a){return Ext.isEmpty(b)?(c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u53c2\u6570"+a+"\u5fc5\u4f20\uff01"),!1):Ext.isArray(b)?0===b?(c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u53c2\u6570"+a+"\u96c6\u5408\u4e0d\u53ef\u4e3a\u7a7a\uff01"),!1):!0:(c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",
"\u53c2\u6570"+a+"\u5fc5\u9700Array\u683c\u5f0f\uff01"),!1)};m.file=function(){return{tipMsg:"\u6587\u4ef6",type:"file",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if((new RegExp(/\.*$/i)).test(b[a]))return!0;return!1}}};m.image=function(b,a){Ext.isEmpty(b)&&(b=-1);Ext.isEmpty(a)&&(a=-1);return{width:b,height:a,tipMsg:"\u56fe\u7247",type:"images",renderer:"FastExt.Renders.image(24)",match:function(){for(var d=
[],e=0;e<arguments.length;e++)d[e]=arguments[e];for(e=0;e<d.length;e++)if(c.File.isSuffixFile(d[e],"jpg","png","gif","jpeg","svg","bmp","webp"))return!0;return!1}}};m.mp4=function(b){return{tipMsg:"mp4",type:"videos",maxDuration:b,onFileSelect:function(a){var d=this;Ext.isEmpty(a.extra)&&(a.extra={});return new Ext.Promise(function(e,f){if(Ext.isEmpty(d.maxDuration))e();else{f=URL.createObjectURL(a.fileInputEl.dom.files[0]);var g=new Audio(f);g.addEventListener("loadedmetadata",function(h){a.extra.duration=
g.duration;1E3*g.duration>parseInt(d.maxDuration)?e("\u89c6\u9891\u6700\u5927\u65f6\u957f\u4e0d\u5f97\u8d85\u8fc7"+d.maxDuration/1E3+"\u79d2\uff01"):e()})}})},renderer:"FastExt.Renders.file()",match:function(){for(var a=[],d=0;d<arguments.length;d++)a[d]=arguments[d];for(d=0;d<a.length;d++)if(c.File.isSuffixFile(a[d],"mp4"))return!0;return!1}}};m.mp3=function(){return{tipMsg:"mp3",type:"music",renderer:"FastExt.Renders.file()",onFileSelect:function(b){Ext.isEmpty(b.extra)&&(b.extra={});return new Ext.Promise(function(a,
d){d=URL.createObjectURL(b.fileInputEl.dom.files[0]);var e=new Audio(d);e.addEventListener("loadedmetadata",function(f){b.extra.duration=e.duration;a()})})},match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],"mp3"))return!0;return!1}}};m.word=function(){return{tipMsg:"word\u6587\u6863",type:"words",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],
"doc","docx"))return!0;return!1}}};m.excel=function(){return{tipMsg:"excel\u6587\u6863",type:"excels",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],"xls","xlsx"))return!0;return!1}}};m.ppt=function(){return{tipMsg:"ppt\u6587\u6863",type:"ppt",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],
"ppt","pptx"))return!0;return!1}}};m.pdf=function(){return{tipMsg:"pdf\u6587\u6863",type:"pdf",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],"pdf"))return!0;return!1}}};m.zip=function(){return{tipMsg:"zip\u538b\u7f29\u5305",type:"zip",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],
"zip","rar"))return!0;return!1}}};m.text=function(){return{tipMsg:"txt\u6587\u6863",type:"txt",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],"txt"))return!0;return!1}}};m.data=function(){return{tipMsg:"\u6570\u636e\u6587\u4ef6",type:"data",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],
"data"))return!0;return!1}}};m.json=function(){return{tipMsg:"JSON\u6587\u4ef6",type:"json",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],"json"))return!0;return!1}}};m.apk=function(){return{tipMsg:"\u5b89\u5353\u5b89\u88c5\u5305\uff08APK\uff09",type:"apk",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],
"apk"))return!0;return!1}}};m.ipa=function(){return{tipMsg:"\u82f9\u679c\u5b89\u88c5\u5305\uff08IPA\uff09",type:"ipa",renderer:"FastExt.Renders.file()",match:function(){for(var b=[],a=0;a<arguments.length;a++)b[a]=arguments[a];for(a=0;a<b.length;a++)if(c.File.isSuffixFile(b[a],"ipa"))return!0;return!1}}};return m}();c.FileModule=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.getFieldMinHeight=function(b){Ext.isEmpty(b)&&(b=!1);return b?34:32};m.buildForm=function(b,a,d){Ext.isEmpty(d)&&(d=FastEnum.Target._self);var e=$("\x3cform\x3e\x3c/form\x3e");e.attr("action",b);e.attr("method","post");e.attr("target",d);for(var f in a)b=$("\x3cinput type\x3d'text' name\x3d'"+f+"' /\x3e"),b.attr("value",a[f]),e.append(b);$(document.body).append(e);return e};m.isDateField=function(b){return b?"datefield"===b||"datefield"===b.xtype:!1};
m.isNumberField=function(b){return b?"numberfield"===b||"numberfield"===b.xtype:!1};m.isTextField=function(b){return b?"textfield"===b||"textfield"===b.xtype:!1};m.isComboField=function(b){return b?"combobox"===b||"combo"===b.xtype:!1};m.isFileField=function(b){return b?"fastfile"===b||"fastfile"===b.xtype||"fastfilefield"===b||"fastfilefield"===b.xtype:!1};m.isFilesField=function(b){return b?"fastfiles"===b||"fastfiles"===b.xtype||"fastfilesfield"===b||"fastfilesfield"===b.xtype:!1};m.isEnumField=
function(b){return b?"enumcombo"===b||"enumcombobox"===b||"enumcombo"===b.xtype||"enumcombobox"===b.xtype:!1};m.isContentField=function(b){return b?"contentfield"===b||"content"===b||"contentfield"===b.xtype||"content"===b.xtype:!1};m.isHtmlContentField=function(b){return b?"htmlcontentfield"===b||"htmlcontent"===b||"htmlcontentfield"===b.xtype||"htmlcontent"===b.xtype:!1};m.isMonacoEditorField=function(b){return b?"fastmonacofield"===b||"fastmonaco"===b||"fastmonacofield"===b.xtype||"fastmonaco"===
b.xtype:!1};m.isLinkField=function(b){return b?"linkfield"===b||"link"===b||"linkfield"===b.xtype||"link"===b.xtype:!1};m.isTargetField=function(b){return b?"targetfield"===b||"target"===b||"targetfield"===b.xtype||"target"===b.xtype:!1};m.isPCAField=function(b){return b?"pcafield"===b||"pca"===b||"pcafield"===b.xtype||"pca"===b.xtype:!1};m.isMapField=function(b){return b?"mapfield"===b||"map"===b||"mapfield"===b.xtype||"map"===b.xtype:!1};m.getFieldError=function(b){var a=b.getErrors();0===a.length&&
(a=[b.invalidText]);Ext.isEmpty(a[0])&&(a[0]="\u6570\u636e\u9519\u8bef\uff01");return a};m.showJsonForm=function(b,a,d,e,f){Ext.isEmpty(f)&&(f=!0);Ext.isString(d)&&(d=c.Json.jsonToObject(d));Ext.isEmpty(e)&&(e="[]");Ext.isString(e)&&(e=c.Json.jsonToObject(e));return new Ext.Promise(function(g,h){h=[];for(var k=0,l=d;k<l.length;k++){for(var n=l[k],p=0,q=e;p<q.length;p++){var r=q[p];r.name===n.name&&(n=c.Json.mergeJson(n,r))}p=c.Json.mergeJson({xtype:"textfield",columnWidth:1,allowBlank:!1},n);p.source=
n;h.push(p)}var u=Ext.create("Ext.form.FormPanel",{bodyPadding:5,cacheKey:$.md5(a),region:"center",border:0,autoScroll:!0,defaults:{labelWidth:100,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199",flex:1},layout:{type:"vbox",pack:"start",align:"stretch"},doReturn:function(){if(this.getForm().isValid()){var w=[];this.getForm().getFields().each(function(z){var x=z.source;x.value=z.getValue();w.push(x)});g(w);return!0}return!1},listeners:{render:function(w,z){new Ext.util.KeyMap({target:w.getEl(),
key:13,fn:function(x,y){u.doReturn()&&(u.deleteCache(),t.close())},scope:this})}},items:h}),t=Ext.create("Ext.window.Window",{title:a,icon:b.icon,iconCls:b.iconCls,animateTarget:b,width:550,minWidth:200,autoScroll:!0,layout:{type:"vbox",pack:"start",align:"stretch"},resizable:!0,maximizable:!0,constrain:!0,items:[u],modal:f,listeners:{show:function(w){u.restoreCache();w.focus()}},buttons:[{text:"\u6682\u5b58",iconCls:"extIcon extSave whiteColor",handler:function(){u.saveCache()}},{text:"\u91cd\u7f6e",
iconCls:"extIcon extReset",handler:function(){u.form&&u.form.reset();u.deleteCache()}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){u.doReturn()&&(u.deleteCache(),t.close())}}]});t.show()})};return m}();c.Form=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.onFastAfterTabActive=function(){try{(this.operate.refreshData||c.System.gridRefreshData)&&this.getStore().reload()}catch(b){console.error(b)}};m.onFastViewRead=function(b,a){b.getHeaderContainer().sortOnClick=!1};m.onFastBeforeDestroy=function(){c.Base.toBool(this.destroySaveUI,!0)&&this.saveUIConfig(!1);this.hideEmptyTip()};m.onFastColumnMove=function(b,a,d,e,f){a.groupHeaderText=a.isSubHeader?a.ownerCt.text:null;this.saveUIConfig(!0)};m.onFastColumnResize=
function(b,a,d,e){this.sortOnClick=!1;this.saveUIConfig(!0)};m.onFastColumnsChanged=function(b,a){b.sortOnClick=!1;this.saveUIConfig(!0)};m.onFastHeaderTriggerClick=function(b,a,d,e,f){Ext.isEmpty(a.dataIndex)||this.fromRecycle||(b.sortOnClick=!1,b.triggerColumn=a)};m.onFastHeaderContextMenu=function(b,a,d,e,f){Ext.isEmpty(a.dataIndex)||this.fromRecycle||(b.sortOnClick=!1,b.onHeaderTriggerClick(a,d,a.triggerEl))};m.onFastHeaderMenuCreate=function(b,a,d,e){this.columnHeadMenu=a;c.Grid.configGridHeadMenu(this)};
m.onFastHeaderClick=function(b,a,d,e,f){if(!Ext.isEmpty(a.dataIndex)&&(b.sortOnClick=!1,!c.Grid.showColumnSearchMenu(a)))b.onHeaderTriggerClick(a,d,a.triggerEl)};m.onFastSortChange=function(b,a,d,e){Ext.isEmpty(a.dataIndex)||(a.sortDirection=d,c.Grid.refreshColumnStyle(a),this.saveUIConfig(!0))};m.onFastCellContextMenu=function(b,a,d,e,f,g,h,k){!Ext.isEmpty(h.position.column.dataIndex)&&!this.fromRecycle&&Ext.isObject(this.contextMenu)&&0<this.contextMenu.items.length&&(this.contextMenu.cellIndex=
d,this.contextMenu.record=e,this.contextMenu.rowIndex=g,this.contextMenu.cellTd=a,this.contextMenu.tr=f,this.contextMenu.cellContext=h.position,b.getSelectionModel().select(e),b.fireEvent("selectionchange",b,e,k),c.Menu.fireMenuEvent(this.contextMenu,"onBeforeShow"),c.Menu.refreshItem(this.contextMenu),this.contextMenu.showAt(h.getXY()))};m.onFastCellDblclick=function(){this.doEdit=!0};m.onFastBeforeEdit=function(b,a,d){if(!this.checkEditor())return c.Dialog.toast("\u65e0\u7f16\u8f91\u6743\u9650\uff08E-1\uff09\uff01"),
!1;if(!c.Base.toBool(this.doEdit,!0))return!1;this.doEdit=!1;if(!c.Base.toBool(a.column.editable,!0))return c.Dialog.toast("\u65e0\u7f16\u8f91\u6743\u9650\uff08E-2\uff09\uff01"),!1;if(a.column.hasListener("beforeedit")&&!a.column.fireEvent("beforeedit",a))return!1;b=a.column.field;if(!b)return c.Dialog.toast("\u65e0\u7f16\u8f91\u6743\u9650\uff08E-3\uff09\uff01"),!1;d=Ext.get(a.cell);b.labelTitle=a.column.text;b.record=a.record;b.fromColumn=!0;if(b.hasListener("beforeedit")&&!b.fireEvent("beforeedit",
b)||c.Listeners.onBeforeEditorField&&!c.Listeners.onBeforeEditorField(b,a.record))return!1;Ext.isFunction(b.setValue)&&!c.Base.toBool(a.column.password,!1)&&(Ext.isObject(a.value)||Ext.isArray(a.value)?b.setValue(JSON.stringify(a.value),a.record):b.setValue(a.value,a.record));Ext.isFunction(b.startEdit)&&b.startEdit();if(Ext.isFunction(b.showWindow))return b.showWindow(d,function(f){Ext.isEmpty(a.value)&&Ext.isEmpty(f.getValue())||c.Store.setRecordValue(a.record,a.field,f)}),!1;a.column.editMenu||
(a.column.editMenu=Ext.create("Ext.menu.Menu",{modal:!0,layout:"fit",showSeparator:!1,shadow:!1,editorMenu:!0,items:[{xtype:"container",layout:"fit",width:d.getWidth(),style:{background:"#ffffff",borderWidth:1,borderColor:"#ffffff",color:"#eeeee"},border:0,items:[b]}],listeners:{show:function(f,g){f.items.get(0).items.get(0).focus();try{new Ext.util.KeyMap({target:f.getEl(),key:13,fn:function(h,k){f.hide()},scope:this})}catch(h){console.error(h)}},beforehide:function(f,g){g=f.items.get(0).items.get(0);
return g.isValid()?!0:(g=c.Form.getFieldError(g),c.Dialog.toast(g[0]),c.Component.shakeComment(f,function(){f.holdShow=!1}),f.holdShow=!0,!1)},hide:function(f,g){f.context&&(g=f.items.get(0).items.get(0))&&((Ext.isEmpty(f.context.value)||c.Base.toBool(f.context.column.password,!1))&&Ext.isEmpty(g.getValue())?Ext.isFunction(g.endEdit)&&g.endEdit():(c.Store.setRecordValue(f.context.record,f.context.field,g),Ext.isFunction(g.endEdit)&&g.endEdit(),g.setValue(null)))}}}),a.column.editMenu.addCls("edit-menu"));
var e=0;Ext.isFunction(b.getTriggers)&&(e=b.getTriggers()?Object.keys(b.getTriggers()).length:0);a.column.editMenu.setWidth(Math.max(a.column.getWidth(),120+30*e));a.column.editMenu.context=a;a.column.editMenu.showBy(d,"tl");return!1};m.onFastSelectionChange=function(b,a,d){try{a&&!this.fromStoreChange&&this.recordSelect(),this.refreshSelect(),this.refreshDetailsPanel()}catch(e){c.Dialog.showException(e,"\u6309\u94ae\u9009\u4e2d\u68c0\u6d4b\uff01[selectionchange]")}};m.onFastStoreEndUpdate=function(){try{var b=
this;if(!b.getStore()||b.getStore().holdUpdate)return!0;var a=b.getStore().getUpdatedRecords();Ext.each(b.updateButtons,function(d,e){d.setDisabled(0===a.length)});b.operate&&b.operate.autoUpdate&&(b.setLoading("\u63d0\u4ea4\u6570\u636e\u4e2d\u2026\u2026"),c.Store.commitStoreUpdate(b.getStore()).then(function(){b.setLoading(!1)}))}catch(d){c.Dialog.showException(d,"endupdate")}};m.onFastStoreDataChanged=function(){this.fireLoadResotreSelect&&this.restoreSelect();this.showEmptyTip()};m.onFastStoreLoad=
function(){this.fireLoadResotreSelect||(this.fireLoadResotreSelect=!0,this.restoreSelect())};m.onFastStoreBeforeLoad=function(){this.hideEmptyTip()};m.onFastHeadMenuBeforeShow=function(b){var a=this;c.Grid.hasColumnField(b.activeHeader)||(b.activeHeader.batchUpdate=!1,b.activeHeader.operation=!1,b.activeHeader.searchLink=!1,b.activeHeader.batchRandom=!1);if(c.Grid.isFilesColumn(b.activeHeader)||c.Grid.isFileColumn(b.activeHeader)||c.Grid.isLinkColumn(b.activeHeader)||c.Grid.isMapColumn(b.activeHeader)||
c.Grid.isTargetColumn(b.activeHeader)||c.Grid.isPCAColumn(b.activeHeader))b.activeHeader.batchRandom=!1;c.Grid.isContentColumn(b.activeHeader)&&(b.activeHeader.searchLink=!1);if(!b.configHeadMenu){b.configHeadMenu=!0;var d=[];d.push({text:"\u67e5\u770b\u8bf4\u660e",iconCls:"extIcon extConvertCode",onBeforeShow:function(){Ext.isEmpty(b.activeHeader.comment)?this.hide():this.show()},handler:function(){c.Dialog.showHtml(this,"\u67e5\u770b\u3010"+b.activeHeader.text+"\u3011\u7684\u8bf4\u660e",b.activeHeader.comment,
!1)}});c.Base.toBool(a.columnMenu.lookField,!0)&&c.System.isSuperRole()&&d.push({text:"\u67e5\u770b\u5217\u4fe1\u606f",iconCls:"extIcon extField",onBeforeShow:function(){c.Base.toBool(b.activeHeader.lookField,!0)?this.show():this.hide()},handler:function(){var e={name:b.activeHeader.dataIndex,text:b.activeHeader.text,width:b.activeHeader.getWidth()};e=(new JSONFormat(c.Json.objectToJson(e),4)).toString();c.Dialog.showAlert("\u67e5\u770b\u5217\u4fe1\u606f",e)}});c.System.isSuperRole()&&c.System.isDebug()&&
!c.Base.toBool(a.entitySelect,!1)&&d.push({text:"\u67e5\u770b\u5217\u7f16\u8f91\u5668",iconCls:"extIcon extField",handler:function(){var e=(new JSONFormat(c.Json.objectToJson(b.activeHeader.configField),4)).toString();c.Dialog.showAlert("\u67e5\u770b\u5217\u7f16\u8f91\u5668",e)}});c.Menu.isSplitLineLast(d)||d.push("-");c.Base.toBool(b.activeHeader.batchClear,!0)&&d.push({text:"\u6e05\u9664\u65e0\u6548\u6570\u636e",iconCls:"extIcon extClear grayColor",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).checkDelete()?
c.Base.toBool(b.activeHeader.batchClear,!0)?this.show():this.hide():this.hide()},handler:function(){c.Dialog.showDeleteDataAlert("\u6e05\u9664\u65e0\u6548\u6570\u636e","\u5c06\u6e05\u9664\u5c5e\u6027\u3010"+b.activeHeader.configText+"\u3011\u5728\u3010\u5f53\u524d\u5f53\u524d\u6761\u4ef6\u3011\u4e0b\u4e3a\u7a7a\u7684\u6240\u6709\u65e0\u6548\u6570\u636e\uff01\u8bf7\u60a8\u786e\u5b9a\u64cd\u4f5c\uff01",function(){c.Dialog.showWait("\u6b63\u5728\u6e05\u9664\u6570\u636e\u4e2d\u2026\u2026");var e=c.Grid.getColumnGrid(b.activeHeader);
e={entityCode:e.getStore().entity.entityCode,field:b.activeHeader.dataIndex,menu:c.Store.getStoreMenuText(e.getStore()),storeId:e.getStore().getId()};c.Server.clearEntity(e,function(f,g){c.Dialog.hideWait();f&&c.Grid.getColumnGrid(b.activeHeader).getStore().loadPage(1);c.Dialog.showAlert("\u6e05\u7406\u7ed3\u679c",g)})},"\u6e05\u9664")}});c.Base.toBool(b.activeHeader.batchClearRepeat,!0)&&(d.push({text:"\u6e05\u9664\u91cd\u590d\u6570\u636e-\u4fdd\u7559\u6700\u65b0",iconCls:"extIcon extDelRepeat grayColor",
onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).checkDelete()?c.Base.toBool(b.activeHeader.batchClearRepeat,!0)?this.show():this.hide():this.hide()},handler:function(){c.Dialog.showDeleteDataAlert("\u6e05\u9664\u91cd\u590d\u6570\u636e-\u4fdd\u7559\u6700\u65b0","\u5c06\u6e05\u9664\u5c5e\u6027\u3010"+b.activeHeader.configText+"\u3011\u5728\u3010\u5f53\u524d\u5f53\u524d\u6761\u4ef6\u3011\u4e0b\u91cd\u590d\u7684\u6570\u636e\uff0c\u5e76\u4fdd\u7559\u6700\u65b0\u7684\u4e00\u6761\u6570\u636e\uff01\u8bf7\u60a8\u786e\u5b9a\u64cd\u4f5c\uff01",
function(){c.Dialog.showWait("\u6b63\u5728\u6e05\u9664\u6570\u636e\u4e2d\u2026\u2026");var e=c.Grid.getColumnGrid(b.activeHeader);e={entityCode:e.getStore().entity.entityCode,field:b.activeHeader.dataIndex,type:1,menu:c.Store.getStoreMenuText(e.getStore()),storeId:e.getStore().getId()};c.Server.clearRepeatEntity(e,function(f,g){c.Dialog.hideWait();f&&c.Grid.getColumnGrid(b.activeHeader).getStore().loadPage(1);c.Dialog.showAlert("\u6e05\u7406\u7ed3\u679c",g)})},"\u6e05\u9664")}}),d.push({text:"\u6e05\u9664\u91cd\u590d\u6570\u636e-\u4fdd\u7559\u6700\u65e9",
iconCls:"extIcon extDelRepeat grayColor",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).checkDelete()?c.Base.toBool(b.activeHeader.batchClearRepeat,!0)?this.show():this.hide():this.hide()},handler:function(){c.Dialog.showDeleteDataAlert("\u6e05\u9664\u91cd\u590d\u6570\u636e-\u4fdd\u7559\u6700\u65e9","\u5c06\u6e05\u9664\u5c5e\u6027\u3010"+b.activeHeader.configText+"\u3011\u5728\u3010\u5f53\u524d\u5f53\u524d\u6761\u4ef6\u3011\u4e0b\u91cd\u590d\u7684\u6570\u636e\uff0c\u5e76\u4fdd\u7559\u6700\u65e9\u7684\u4e00\u6761\u6570\u636e\uff01\u8bf7\u60a8\u786e\u5b9a\u64cd\u4f5c\uff01",
function(){c.Dialog.showWait("\u6b63\u5728\u6e05\u9664\u6570\u636e\u4e2d\u2026\u2026");var e=c.Grid.getColumnGrid(b.activeHeader);e={entityCode:e.getStore().entity.entityCode,field:b.activeHeader.dataIndex,type:0,menu:c.Store.getStoreMenuText(e.getStore()),storeId:e.getStore().getId()};c.Server.clearRepeatEntity(e,function(f,g){c.Dialog.hideWait();f&&c.Grid.getColumnGrid(b.activeHeader).getStore().loadPage(1);c.Dialog.showAlert("\u6e05\u7406\u7ed3\u679c",g)})},"\u6e05\u9664")}}));c.Menu.isSplitLineLast(d)||
d.push("-");d.push({text:"\u6570\u636e\u5de6\u5bf9\u9f50",iconCls:"extIcon extAlignLeft grayColor",handler:function(){b.activeHeader.setAlignContent("left")}});d.push({text:"\u6570\u636e\u5c45\u4e2d\u5bf9\u9f50",iconCls:"extIcon extAlignCenter grayColor",handler:function(){b.activeHeader.setAlignContent("center")}});d.push({text:"\u6570\u636e\u53f3\u5bf9\u9f50",iconCls:"extIcon extAlignRight grayColor",handler:function(){b.activeHeader.setAlignContent("right")}});c.Menu.isSplitLineLast(d)||d.push("-");
a.getStore().entity&&(c.Base.toBool(a.columnMenu.searchLink,!0)&&d.push({text:"\u914d\u7f6e\u641c\u7d22\u94fe",iconCls:"extIcon extLink",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).fromRecycle?this.hide():c.Base.toBool(b.activeHeader.searchLink,!0)?this.show():this.hide()},handler:function(){c.Grid.configColumnSearchLink(b.activeHeader)}}),c.Base.toBool(a.columnMenu.operation,!0)&&d.push({text:"\u8ba1\u7b97\u6570\u636e",iconCls:"extIcon extMath",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).fromRecycle?
this.hide():c.Base.toBool(b.activeHeader.operation,!1)?this.show():this.hide()},menu:[{text:"\u8ba1\u7b97\u603b\u548c",iconCls:"extIcon extMath",handler:function(){c.Grid.showColumnCompute(a,b.activeHeader,FastEnum.ComputeType.sum)}},{text:"\u8ba1\u7b97\u5e73\u5747\u503c",iconCls:"extIcon extMath",handler:function(){c.Grid.showColumnCompute(a,b.activeHeader,FastEnum.ComputeType.avg)}},{text:"\u8ba1\u7b97\u6700\u5927\u503c",iconCls:"extIcon extMath",handler:function(){c.Grid.showColumnCompute(a,b.activeHeader,
FastEnum.ComputeType.max)}},{text:"\u8ba1\u7b97\u6700\u5c0f\u503c",iconCls:"extIcon extMath",handler:function(){c.Grid.showColumnCompute(a,b.activeHeader,FastEnum.ComputeType.min)}}]}));c.Menu.isSplitLineLast(d)||d.push("-");c.Base.toBool(a.columnMenu.batchUpdate,!0)&&d.push({text:"\u6279\u91cf\u4fee\u6539\u6570\u636e",iconCls:"extIcon extEdit",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).checkEditor()?c.Base.toBool(b.activeHeader.editable,!0)?c.Base.toBool(b.activeHeader.batchUpdate,
!0)?this.show():this.hide():this.hide():this.hide()},handler:function(){c.Grid.showBatchEditColumn(b.activeHeader)}});c.Base.toBool(a.columnMenu.batchUpdateDB,!0)&&d.push({text:"\u6279\u91cf\u66f4\u65b0\u6570\u636e",iconCls:"extIcon extEdit",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).checkEditor()?c.Base.toBool(b.activeHeader.editable,!0)?c.Base.toBool(b.activeHeader.batchUpdateDB,!0)?this.show():this.hide():this.hide():this.hide()},handler:function(){c.Grid.showBatchUpdateColumn(b.activeHeader)}});
c.Base.toBool(a.columnMenu.batchReplaceDB,!0)&&d.push({text:"\u6279\u91cf\u66ff\u6362\u6570\u636e",iconCls:"extIcon extEdit",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).checkEditor()?c.Base.toBool(b.activeHeader.editable,!0)?c.Base.toBool(b.activeHeader.batchReplaceDB,!0)?this.show():this.hide():this.hide():this.hide()},handler:function(){c.Grid.showBatchReplaceColumn(b.activeHeader)}});c.Menu.isSplitLineLast(d)||d.push("-");c.Base.toBool(a.columnMenu.batchRandom,!0)&&d.push({text:"\u751f\u6210\u968f\u673a\u6570\u636e",
iconCls:"extIcon extRandom",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).checkEditor()?c.Base.toBool(b.activeHeader.editable,!0)?c.Base.toBool(b.activeHeader.batchRandom,!0)?this.show():this.hide():this.hide():this.hide()},handler:function(){c.Grid.showBatchEditColumnRandom(b.activeHeader)}});c.Base.toBool(a.columnMenu.cancelSort,!0)&&d.push({text:"\u53d6\u6d88\u6392\u5e8f",iconCls:"extIcon extCancelOrder",onBeforeShow:function(){c.Grid.getColumnGrid(b.activeHeader).fromRecycle?this.hide():
c.Base.toBool(b.activeHeader.cancelSort,!0)?this.show():this.hide()},handler:function(){try{var e=a.getStore().getSorters();0!==e.count()&&(e.removeByKey(b.activeHeader.dataIndex),a.getStore().loadPage(1),b.activeHeader.sortDirection=null,c.Grid.refreshColumnStyle(b.activeHeader),a.saveUIConfig(!0))}catch(f){c.Dialog.showException(f)}}});b.insert(0,d)}c.Menu.fireMenuEvent(b,"onBeforeShow");c.Menu.refreshItem(b)};return m}();c.GridEvent=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.doRefreshPowerEnable=function(){try{Ext.isEmpty(this.updateButtons)||0===this.updateButtons.length?this.updateEnable=!1:this.updateEnable=0<c.Component.countVisible(this.updateButtons);Ext.isEmpty(this.addButtons)||0===this.addButtons.length?this.addEnable=!1:this.addEnable=0<c.Component.countVisible(this.addButtons);Ext.isEmpty(this.deleteButtons)||0===this.deleteButtons.length?this.deleteEnable=!1:this.deleteEnable=0<c.Component.countVisible(this.deleteButtons);
if(!this.addEnable)for(var b=this.query("[checkAddPower\x3dtrue]"),a=0;a<b.length;a++)b[a].setHidden(!0),b[a].setDisabled(!0);if(!this.deleteEnable){var d=this.query("[checkDeletePower\x3dtrue]");for(a=0;a<d.length;a++)d[a].setHidden(!0),d[a].setDisabled(!0)}if(!this.updateEnable){var e=this.query("[checkUpdatePower\x3dtrue]");for(a=0;a<e.length;a++)e[a].setHidden(!0),e[a].setDisabled(!0)}if(!this.operate.deleteAllData){var f=this.query("[checkDeleteAllPower\x3dtrue]");for(a=0;a<f.length;a++)f[a].setHidden(!0),
f[a].setDisabled(!0)}if(!this.operate.copyData){var g=this.query("[checkCopyPower\x3dtrue]");for(a=0;a<g.length;a++)g[a].setHidden(!0),g[a].setDisabled(!0)}}catch(h){console.error(h)}};m.doRefreshSelect=function(){try{var b=this;b.selectButtons&&Ext.each(b.selectButtons,function(a,d){if(a){d=b.getSelection().length;b.selectCount&&(d=b.selectCount);var e=a.checkSelect,f=!1;if("multiple"===e||"m"===e||1<e)f=!(0<d);else if("radio"===e||"r"===e||"single"===e||"s"===e||1===e)f=1!==d;c.Button.setDisabled(a,
f)}})}catch(a){console.error(a)}};m.doRecordSelect=function(){try{if(c.Base.toBool(c.Cache.memory.holdGridRecordSelectHistory,!1))this.restoreSelect();else{if(this.selectRecordHistoryShowing)for(var b=0;b<this.selectRecordHistoryShowing.length;b++){var a=this.selectRecordHistoryShowing[b];this.removeRecordHistory(a)}this.selectRecordHistoryShowing=[];var d=this.getSelectionModel().getSelection(!0);for(b=0;b<d.length;b++)a=d[b],this.hasRecordHistory(a)||(this.getSelectRecordHistory().push(a),this.selectRecordHistoryShowing.push(a))}}catch(e){console.error(e)}};
m.doHasRecordHistory=function(b){try{var a=this.getStore().entity;if(a)for(var d=0;d<this.getSelectRecordHistory().length;d++){var e=this.getSelectRecordHistory()[d];if(c.Store.isSameRecordByEntity(a,e,b))return!0}}catch(f){console.error(f)}return!1};m.doRemoveRecordHistory=function(b){try{var a=this.getStore().entity;if(a){for(var d=[],e=0;e<this.getSelectRecordHistory().length;e++){var f=this.getSelectRecordHistory()[e];c.Store.isSameRecordByEntity(a,f,b)&&d.push(e)}for(e=0;e<d.length;e++)this.getSelectRecordHistory().splice(d[e],
1)}}catch(g){console.error(g)}};m.doRestoreSelect=function(){var b=this;try{if(b.selectHistoryConfig&&0===parseInt(b.selectHistoryConfig.state)&&!c.Base.toBool(b.closeSelectHistoryLoad,!1))b.clearSelectRecordHistory();else{b.selectRecordHistoryShowing=[];var a=b.getStore().entity;if(a)for(var d=function(f){var g=b.getSelectRecordHistory()[f];b.getStore().each(function(h,k){c.Store.isSameRecordByEntity(a,g,h)&&b.selectRecordHistoryShowing.push(h)})},e=0;e<b.getSelectRecordHistory().length;e++)d(e);
0<b.selectRecordHistoryShowing.length&&(b.getSelectionModel().select(b.selectRecordHistoryShowing),b.refreshSelect())}}finally{b.closeSelectHistoryLoad=!1}};m.doGetSelectRecordHistory=function(){try{if(!this.selectRecordHistory){this.selectRecordHistory=[];var b=c.Cache.memory["GridSelectHistory"+this.code];b&&Ext.isArray(b)&&(this.selectRecordHistory=Ext.Array.clone(b))}return this.selectRecordHistory}catch(a){console.error(a)}return[]};m.doClearSelectRecordHistory=function(){try{this.selectRecordHistory=
[],Ext.isFunction(this.refreshSelectHistoryCount)&&this.refreshSelectHistoryCount(),c.Cache.memory["GridSelectHistory"+this.code]=null}catch(b){console.error(b)}};m.doRefreshSelectHistoryCount=function(){try{if(this.ownerCt)for(var b=this.ownerCt.query("[selectHistoryCount\x3dtrue]"),a=0;a<b.length;a++)Ext.isFunction(b[a].setValue)&&b[a].setValue(this.getSelectRecordHistory().length)}catch(d){console.error(d)}};m.doRefreshDetailsPanel=function(){if(!c.Base.toBool(this.refreshingDetailsPanel,!1))try{if(this.refreshingDetailsPanel=
!0,this.detailsPanels&&0!==this.detailsPanels.length)for(var b=0;b<this.detailsPanels.length;b++){var a=this.detailsPanels[b];a&&(a.fromWindow?Ext.isFunction(a.setRecord)&&a.setRecord(this):this.operate&&this.operate.autoDetails?Ext.isFunction(a.setRecord)&&a.setRecord(this):a.close())}}finally{this.refreshingDetailsPanel=!1}};m.doSaveUIConfig=function(b){try{var a=this;if(c.Base.toBool(a.firstLoadedData,!1)){b&&c.Server.setSilence(!0);var d=a.getStore().entity;c.Grid.saveGridColumn(a).then(function(){c.Grid.saveGridButton(a,
d).then(function(){c.Server.setSilence(!1)})})}}catch(e){console.error(e)}};m.doHideEmptyTip=function(){c.Lottie.unloadJsonAnimById(this.getId()+"-empty-anim");$("#"+this.getId()+"-empty-tip").remove()};m.doShowEmptyTip=function(){try{if(this.body&&(this.hideEmptyTip(),!(this.getStore()&&0<this.getStore().getCount()))){Ext.isEmpty(this.emptyConfig)&&(this.emptyConfig={lottie:"base/lottie/empty_data.json",width:"40%",height:"40%",opacity:.8,filter:""});var b="\x3cdiv id\x3d'"+this.getId()+"-empty-tip' style\x3d'pointer-events: none;position: absolute;top: 0;left: 0;right: 0;bottom: 0;z-index: 9;display: flex;align-items: center;justify-content: center;flex-direction: column;'\x3e\x3cdiv id\x3d'"+
this.getId()+"-empty-anim' style\x3d'width:"+this.emptyConfig.width+";height:"+this.emptyConfig.height+";filter: "+this.emptyConfig.filter+";opacity: "+this.emptyConfig.opacity+";'\x3e\x3c/div\x3e\x3c/div\x3e";$("#"+this.body.el.id).append($(b));c.Lottie.loadJsonAnimByEl($("#"+this.getId()+"-empty-anim")[0],this.emptyConfig.lottie)}}catch(a){console.error(a)}};m.doCheckEditor=function(){return!c.Base.toBool(this.updateEnable,!0)||c.Base.toBool(this.fromRecycle,!1)?!1:!0};m.doCheckAdd=function(){return c.System.isSuperRole()?
!0:this.addEnable};m.doCheckDelete=function(){return c.System.isSuperRole()?!0:this.deleteEnable};m.doCheckRefreshTimer=function(b){try{this.timerConfig&&(0===parseInt(this.timerConfig.state)?(this.stopRefreshTimer(),b&&c.Dialog.toast("\u5df2\u5173\u95ed\u5b9a\u65f6\u5668\uff01")):(this.startRefreshTimer(),b&&c.Dialog.toast("\u5df2\u542f\u52a8\u5b9a\u65f6\u5668\uff01")))}catch(a){console.error(a)}};m.doStartRefreshTimer=function(){try{var b=this;b.timerTimeout&&clearTimeout(b.timerTimeout);if(b.timerConfig){var a=
b.child("#pagingToolBar");if(a){var d=a.down("button[toolType\x3dtimerBtn]");d&&(1===parseInt(b.timerConfig.state)?(d.setIconCls(d.baseIconCls+" redColor"),d.setUserCls("redBorder")):(d.setIconCls(d.baseIconCls+" grayColor"),d.setUserCls("")))}0!==parseInt(b.timerConfig.state)&&(b.timerTimeout=setTimeout(function(){b&&b.timerConfig&&(b.disabledLoadMaskOnce=1===parseInt(b.timerConfig.silence),b.getStore()&&(b.getStore().reload(),b.startRefreshTimer()))},1E3*parseInt(b.timerConfig.value)))}}catch(e){console.error(e)}};
m.doStopRefreshTimer=function(){try{this.timerTimeout&&clearTimeout(this.timerTimeout);this.timerConfig&&(this.timerConfig.state=0);var b=this.child("#pagingToolBar");if(b){var a=b.down("button[toolType\x3dtimerBtn]");a&&(1===parseInt(this.timerConfig.state)?(a.setIconCls(a.baseIconCls+" redColor"),a.setUserCls("redBorder")):(a.setIconCls(a.baseIconCls+" grayColor"),a.setUserCls("")))}}catch(d){console.error(d)}};return m}();c.GridMethod=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function b(){}b.onGridInitComponent=function(a){c.Base.toBool(a.fastGridInited,!1)||(a.fastGridInited=!0,a.bufferedRenderer=!0,a.firstLoadedData=!1,a.entityList&&(a.getStore()&&(a.getStore().grid=a,a.getStore().where&&(a.fromRecycle=a.getStore().where["^fromRecycle"])),c.Grid.configGridDefault(a),c.Grid.configGridMethod(a),c.Grid.configGridContextMenu(a),c.Grid.configGridListeners(a),c.Grid.configNormalGridListeners(a)),a.dataList&&(c.Grid.configGridMethod(a),c.Grid.configNormalGridListeners(a)))};
b.onGridAfterRender=function(a){if(!c.Base.toBool(a.fastGridAfterRendered,!1)&&(a.fastGridAfterRendered=!0,a.entityList)){c.Grid.configGridHistory(a);a.up("[menuContainer\x3dtrue]")&&(a.menuPanelList=!0);var d=a.up("window");if(d&&!c.Base.toBool(d.shown,!1))d.on("show",c.Grid.startLoadData,a,{single:!0});else c.Grid.startLoadData.apply(a)}};b.startLoadData=function(){var a=this;c.Grid.configGridLayout(a).then(function(){c.System.silenceGlobalSave||(Ext.isFunction(a.refreshPowerEnable)&&a.refreshPowerEnable(),
c.Grid.configGridTip(a),c.Grid.configDefaultToolBar(a),c.Grid.refreshGridNumberColumn(a));a.setLoading(!1);a.getStore().grid=a;if(c.System.silenceGlobalSave){a.firstLoadedData=!0;a.getStore().loadData([c.Grid.buildNullData(a)]);var d=a.up("[menuContainer\x3dtrue]");d&&d.close();c.System.doNextSilenceMenu()}else c.Power.isPower()?(a.firstLoadedData=!0,a.getStore().loadData([c.Grid.buildTempData(a)])):(a.firstLoadedData=!0,a.getStore().isLoaded()||(a.getStore().loadPage(1),a.checkRefreshTimer(!1)))})};
b.getGridView=function(a){return(a=a.getView())?"Ext.grid.locking.View"===a.$className?a.normalView:a:null};b.getRowMinHeight=function(){return 36};b.buildNullData=function(a){var d={};if(!a)return d;Ext.each(a.getColumns(),function(e,f){Ext.isEmpty(e.dataIndex)||(d[e.dataIndex]=null)});return d};b.buildTempData=function(a){var d={};if(!a)return d;Ext.each(a.getColumns(),function(e,f){Ext.isEmpty(e.dataIndex)||(d[e.dataIndex]="\u6a21\u62df\u6570\u636e",c.Grid.isDateColumn(e)?d[e.dataIndex]=Ext.Date.format(new Date,
"Y-m-d H:i:s"):c.Grid.isFilesColumn(e)&&(d[e.dataIndex]="[]"))});return d};b.addGridContextMenu=function(a,d,e){if(a.contextMenu&&d){if(!Ext.isFunction(a.contextMenu.getXType)){var f=Ext.create("Ext.menu.Menu",{scrollToHidden:!0,items:[]});Ext.isArray(a.contextMenu)&&f.add(a.contextMenu);a.contextMenu=f}Ext.isEmpty(e)?a.contextMenu.add(d):a.contextMenu.insert(e,d)}};b.configGridDefault=function(a){a.selectButtons||(a.selectButtons=[])};b.configGridHistory=function(a){a.selectHistoryConfig||(a.selectHistoryConfig=
{state:0,cache:0,count:0},c.Base.toBool(a.entitySelect,!1)&&(a.selectHistoryConfig.state=1,a.selectHistoryConfig.cache=1),c.Grid.checkHistoryConfig(a))};b.configGridContextMenu=function(a){var d=0,e=function(f,g){return"\x26nbsp;\x3cdiv style\x3d'background: #e3e3e3;border-radius: 3px;display:inline-flex;line-height:20px;'\x3e\x26nbsp;\x3cdiv style\x3d'color: black;overflow: hidden;white-space: nowrap;text-overflow: ellipsis;font-size:smaller;max-width:"+g+"px;'\x3e"+f+"\x3c/div\x3e\x26nbsp;\x3c/div\x3e\x26nbsp;"};
a.getStore().entity&&a.getStore().entity.menu&&c.Grid.addGridContextMenu(a,{iconCls:"extIcon extDetails editColor",text:"\u67e5\u770b\u8be6\u60c5",handler:function(f,g){c.Grid.showGridSelectDetailsWindow(f,a)}},d++);c.Grid.addGridContextMenu(a,"-",d++);c.System.isSuperRole()&&c.Grid.addGridContextMenu(a,{iconCls:"extIcon extSee editColor",text:"\u67e5\u770b\u6570\u636e\u7ed3\u6784",handler:function(f,g){c.Dialog.showJson(this,"\u67e5\u770b\u539f\u59cb\u6570\u636e\u7ed3\u6784",c.Json.objectToJson(a.contextMenu.record.data))}},
d++);c.Grid.addGridContextMenu(a,{iconCls:"extIcon extCopy2",text:"\u590d\u5236\u6570\u636e",menu:[{text:"\u590d\u5236\u5355\u5143\u683c\u6570\u636e",iconCls:"extIcon extCopy2",onBeforeShow:function(){var f=a.contextMenu,g=f.record,h=f.cellContext.column.dataIndex;c.Grid.isFileColumn(f.cellContext.column)||c.Grid.isFilesColumn(f.cellContext.column)||c.Grid.isContentColumn(f.cellContext.column)||Ext.isEmpty(g.get(h))?(this.hide(),this.setText("\u590d\u5236\u6570\u636e")):(this.setText("\u590d\u5236"+
e($(f.cellTd).text(),$(f.cellTd).outerWidth(!0))),this.show())},handler:function(){c.Base.copyToBoard($(a.contextMenu.cellTd).text().trim());c.Dialog.toast("\u590d\u5236\u6210\u529f\uff01")}},{text:"\u590d\u5236\u6574\u884c\u6570\u636e",iconCls:"extIcon extCopy2",handler:function(){var f="";$(a.contextMenu.tr).find("td").each(function(){f+=$(this).text()+"\t"});c.Base.copyToBoard(f);c.Dialog.toast("\u590d\u5236\u6210\u529f\uff01")}},{text:"\u590d\u5236\u5355\u5143\u683c\u5b9e\u9645\u6570\u636e",iconCls:"extIcon extCopy2",
handler:function(){var f=a.contextMenu,g=f.record;f=f.cellContext.column.dataIndex;var h=g.get(f);Ext.isEmpty(h)?c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u590d\u5236\u5931\u8d25\uff0c\u6682\u65e0\u5b9e\u9645\u6570\u636e\uff01"):(Ext.isArray(g.get(f))?c.Base.copyToBoard(Ext.encode(g.get(f))):c.Base.copyToBoard(g.get(f)),c.Dialog.toast("\u590d\u5236\u6210\u529f\uff01"))}}]},d++);c.Grid.addGridContextMenu(a,"-",d++);c.Grid.addGridContextMenu(a,{iconCls:"extIcon extEdit editColor",text:"\u7f16\u8f91\u5355\u5143\u683c\u6570\u636e",
onBeforeShow:function(){var f=this.ownerCt,g=f.record,h=f.cellContext.column.dataIndex;Ext.isEmpty(h)||1!==a.getSelection().length||!a.checkEditor()?this.hide():c.Base.toBool(f.cellContext.column.editable,!0)?(f.cellContext.column.field||f.cellContext.column.hasListener("dblclick")||this.hide(),this.show(),!c.Grid.isContentColumn(f.cellContext.column)&&!Ext.isEmpty(g.get(h))&&0<$(f.cellTd).text().length?this.setText("\u7f16\u8f91"+e($(f.cellTd).text(),$(f.cellTd).outerWidth(!0))):this.setText("\u7f16\u8f91\u5355\u5143\u683c\u6570\u636e")):
this.hide()},handler:function(){var f=this.ownerCt;f.cellContext.column.field?(a.doEdit=!0,a.findPlugin("cellediting").startEditByPosition(f.cellContext)):f.cellContext.column.fireEvent("dblclick",a,this,f.rowIndex)}},d++);a.getStore().entity&&(c.Grid.addGridContextMenu(a,{iconCls:"extIcon extLink",text:"\u5355\u5143\u683c\u641c\u7d22\u94fe",onBeforeShow:function(){this.show();var f=this.ownerCt;if(Ext.isObject(f.cellContext.column.searchLink)&&1===a.getSelection().length){var g=Ext.create("Ext.menu.Menu",
{items:[]}),h=f.record,k=f.cellContext.column.dataIndex;f=f.cellContext.column.searchLink.columns;for(var l=0;l<f.length;l++){var n=f[l];n={icon:n.parent.icon,text:n.parent.text+"\u3010"+n.text+"\u3011",column:n,value:h.get(k),handler:function(){var p={};p[this.column.dataIndex]=this.value;c.System.showTab(this.column.parent.method,$.md5(this.column.id+this.value),"\u641c\u7d22\uff1a"+this.text,this.icon,!0,!1,p)}};g.add(n)}this.setMenu(g)}else this.hide()},menu:[]},d++),c.Grid.addGridContextMenu(a,
{iconCls:"extIcon extSearch searchColor",text:"\u67e5\u627e\u5355\u5143\u683c\u6570\u636e",onBeforeShow:function(){var f=this.ownerCt,g=f.record,h=f.cellContext.column.dataIndex;Ext.isEmpty(h)||!c.Grid.canColumnSearch(f.cellContext.column)||c.Grid.isContentColumn(f.cellContext.column)||1!==a.getSelection().length?this.hide():(this.show(),Ext.isEmpty(g.get(h))?this.setText("\u67e5\u627e\u5355\u5143\u683c\u6570\u636e"):this.setText("\u67e5\u627e"+e($(f.cellTd).text(),$(f.cellTd).outerWidth(!0))))},
handler:function(){var f=this.ownerCt;f.cellContext.column.searchValue(f.record.get(f.cellContext.column.dataIndex))}},d++),c.Grid.addGridContextMenu(a,{iconCls:"extIcon extClear",text:"\u6e05\u7a7a\u5355\u5143\u683c\u6570\u636e",onBeforeShow:function(){var f=this.ownerCt,g=f.record,h=f.cellContext.column.dataIndex;Ext.isEmpty(h)||1!==a.getSelection().length||!a.checkEditor()?this.hide():(this.show(),!c.Grid.isContentColumn(f.cellContext.column)&&!Ext.isEmpty(g.get(h))&&0<$(f.cellTd).text().length?
this.setText("\u6e05\u7a7a"+e($(f.cellTd).text(),$(f.cellTd).outerWidth(!0))):this.setText("\u6e05\u7a7a\u5355\u5143\u683c\u6570\u636e"))},handler:function(){var f=this.ownerCt;a.getStore().entity?a.getStore().entity.idProperty?Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u60a8\u786e\u5b9a"+this.text+"\u5417\uff1f",function(g,h){if("yes"===g){g=f.record;h=f.cellContext.column.dataIndex;Ext.isObject(f.cellContext.column.field)&&!Ext.isEmpty(f.cellContext.column.field.name)&&(h=f.cellContext.column.field.name);
for(var k={entityCode:a.getStore().entity.entityCode},l=0;l<a.getStore().entity.idProperty.length;l++){var n=a.getStore().entity.idProperty[l];k["data."+n]=g.get(n)}a.getStore().entity.menu&&(k.menu=c.Store.getStoreMenuText(a.getStore()));k["data."+h]="\x3cnull\x3e";c.Dialog.showWait("\u6b63\u5728\u6e05\u7a7a\u4e2d\u2026\u2026");c.Server.updateEntity(k,function(p,q){c.Dialog.hideWait();p?(c.Dialog.toast("\u6e05\u9664\u6210\u529f\uff01"),a.getStore().reload()):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",
q)})}}):c.Dialog.toast("\u5f53\u524d\u5217\u8868\u4e0d\u652f\u6301\u6b64\u529f\u80fd\uff01"):c.Dialog.toast("\u5f53\u524d\u5217\u8868\u4e0d\u652f\u6301\u6b64\u529f\u80fd\uff01")}},d++));c.Grid.addGridContextMenu(a,"-",d++)};b.configGridHeadMenu=function(a){if(c.Base.toBool(a.columnContextMenu,!0)&&a.columnHeadMenu&&(a.columnMenu||(a.columnMenu=new c.GridColumnMenu),a.columnMenu)){var d=a.columnHeadMenu;d.scrollToHidden=!0;d.on("beforeshow",c.GridEvent.onFastHeadMenuBeforeShow,a)}};b.configDefaultToolBar=
function(a){if(a){var d=a.down("toolbar[dock\x3d'top']");try{if(d){if(!c.Power.isPower()){var e=0;a.getStore().entity&&(c.Base.toBool(a.showDetailsButton,!0)&&c.Base.toBool(a.operate.showDetailsButton,!0)&&d.insert(e++,{xtype:"button",text:"\u67e5\u770b\u8be6\u60c5",checkSelect:1,contextMenu:!1,iconCls:"extIcon extDetails searchColor",handler:function(){c.Grid.showGridSelectDetailsWindow(this,a)}}),c.Base.toBool(a.showUpdateButton,!0)&&c.Base.toBool(a.operate.showUpdateButton,!0)&&d.insert(e++,{xtype:"button",
text:"\u4fee\u6539\u6570\u636e",checkSelect:1,checkUpdatePower:!0,contextMenu:!1,iconCls:"extIcon extEdit editColor",handler:function(){c.Grid.showDataEditorWin(this,a)}}),0<e&&d.insert(e,"-"))}if(c.Base.toBool(a.fromRecycle,!1))d.setHidden(!0);else if(a.operate&&c.Base.toBool(a.defaultToolBar,!0)){e={xtype:"button",text:"\u66f4\u591a\u64cd\u4f5c",iconCls:"extIcon extMore grayColor",menu:[]};c.Base.toBool(a.operate.globalSearch,!0)&&a.getStore().entity&&c.System.isSuperRole()&&e.menu.push({iconCls:"extIcon extSearch searchColor",
text:"\u5168\u5217\u641c\u7d22",handler:function(){c.System.showGlobalSearch(this,[a.getStore().entity.entityCode],a.ownerCt)}});c.Base.toBool(a.operate.excelOut,!0)&&(c.Menu.isSplitLineLast(e.menu)||e.menu.push("-"),e.menu.push({text:"\u5bfc\u51faExcel",iconCls:"extIcon extExcel",handler:function(){c.Grid.exportGrid(a)}}));c.Base.toBool(a.operate.excelIn,!0)&&a.checkAdd()&&(e.menu.push({text:"\u5bfc\u5165Excel",iconCls:"extIcon extExcel",menu:[{text:"\u4e0b\u8f7d\u6a21\u677f",iconCls:"extIcon extExcelModule searchColor",
handler:function(){c.Grid.downExcelModel(a)}},{text:"\u5bfc\u5165\u6570\u636e",iconCls:"extIcon extExcelImport searchColor",handler:function(){var l={entityCode:a.getStore().entity.entityCode};c.Grid.importExcel(this,l,a.importExcelItems).then(function(n){n&&a.getStore().loadPage(1)})}}]}),e.menu.push("-"));c.System.isSuperRole()&&(c.Menu.isSplitLineLast(e.menu)||e.menu.push("-"),c.Base.toBool(a.operate.downloadData,!0)&&e.menu.push({iconCls:"extIcon extDownload searchColor",text:"\u4e0b\u8f7d\u6570\u636e",
handler:function(){c.Grid.downDataGrid(a)}}),c.Base.toBool(a.operate.uploadData,!0)&&e.menu.push({iconCls:"extIcon extUpload searchColor",text:"\u4e0a\u4f20\u6570\u636e",handler:function(){var l={entityCode:a.getStore().entity.entityCode};c.Grid.loadDataGrid(this,l).then(function(n){n&&a.getStore().loadPage(1)})}}),e.menu.push("-"),a.getStore().entity&&e.menu.push({iconCls:"extIcon extSee searchColor",text:"\u67e5\u770b\u5b9e\u4f53",handler:function(){c.Dialog.showJson(this,"\u67e5\u770b\u5b9e\u4f53\u4fe1\u606f",
JSON.stringify(Object.getPrototypeOf(a.getStore().entity)))}}),a.getStore().entity&&e.menu.push({iconCls:"extIcon extColumn searchColor",text:"\u67e5\u770b\u5217\u4fe1\u606f",handler:function(){if(a){for(var l=a.getColumns(),n=[],p=0;p<l.length;p++){var q=l[p];Ext.isEmpty(q.dataIndex)||n.push({name:q.dataIndex,text:$("\x3cdiv\x3e"+q.configText+"\x3c/div\x3e").text()})}c.Dialog.showJson(this,"\u67e5\u770b\u5217\u4fe1\u606f",JSON.stringify(n))}else c.Dialog.toast("\u5bb9\u5668\u65e0\u6548\uff01")}}),
e.menu.push("-"),a.getStore().entity&&c.Base.toBool(a.getStore().entity.layer,!1)&&e.menu.push({iconCls:"extIcon extPower redColor",text:"\u66f4\u65b0\u6743\u9650\u503c",handler:function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u786e\u5b9a\u66f4\u65b0\u8868\u683c\u7684\u6570\u636e\u6743\u9650\u503c\u5417\uff1f\u786e\u5b9a\u540e\u5c06\u540c\u65f6\u66f4\u65b0\u4e0e\u5f53\u524d\u8868\u683c\u6709\u5173\u8054\u7684\u6240\u6709\u8868\u683c\u7684\u6743\u9650\u503c\uff01\u5982\u679c\u6570\u636e\u5e93\u6570\u636e\u91cf\u8fbe\u5230\u5343\u4e07\u7ea7\u522b\u65f6\uff0c\u66f4\u65b0\u65f6\u95f4\u4f1a\u8f83\u957f\uff0c\u8bf7\u8c28\u614e\u64cd\u4f5c\uff01",
function(l,n){if("yes"==l){var p={entityCode:a.getStore().entity.entityCode};c.System.validOperate("\u66f4\u65b0\u8868\u683c\u7684\u6570\u636e\u6743\u9650\u5c42\u7ea7\u503c",function(){c.Dialog.showWait("\u6b63\u5728\u66f4\u65b0\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.updateLayer(p,function(q,r){c.Dialog.hideWait();c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",r)})},30)}})}}),a.getStore().entity&&e.menu.push({iconCls:"extIcon extCopy2 redColor",text:"\u66f4\u65b0\u540c\u5217\u503c",handler:function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192",
"\u786e\u5b9a\u66f4\u65b0\u8868\u683c\u7684\u6570\u636e\u7ed1\u5b9a\u503c\u5417\uff1f\u786e\u5b9a\u540e\u5c06\u540c\u65f6\u66f4\u65b0\u4e0e\u5f53\u524d\u8868\u683c\u6709\u5173\u8054\u7684\u6240\u6709\u8868\u683c\u7684\u76f8\u540c\u5217\u7684\u503c\uff01\u8bf7\u60a8\u8c28\u614e\u64cd\u4f5c\uff01",function(l,n){if("yes"==l){var p={entityCode:a.getStore().entity.entityCode};c.System.validOperate("\u66f4\u65b0\u8868\u683c\u7684\u76f8\u540c\u5217\u7684\u503c",function(){c.Dialog.showWait("\u6b63\u5728\u66f4\u65b0\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");
c.Server.updateSame(p,function(q,r){c.Dialog.hideWait();c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",r)})},30)}})}}),e.menu.push("-"));c.Menu.isSplitLineLast(e.menu)||e.menu.push("-");e.menu.push({iconCls:"extIcon extSet",text:"\u64cd\u4f5c\u8bbe\u7f6e",handler:function(){c.Grid.setGrid(this,a)}});var f={xtype:"button",text:"\u76f8\u5173\u67e5\u8be2",checkSelect:1,iconCls:"extIcon extIntersect grayColor",menu:[]};a.linkMenu&&(f.menu=a.linkMenu);if(a.getStore()&&a.getStore().entity&&a.getStore().entity.linkTables)for(var g=
a.query("button[entityCode]"),h=function(l){var n=a.getStore().entity.linkTables[l];if(n.linkColumns){l=!1;for(var p=0;p<g.length;p++)if(g[p].entityCode===n.entityCode){l=!0;break}if(l)return"continue";var q={text:n.comment};if(n.menu){if(q.icon=c.Server.getIcon(n.menu.iconName,n.menu.color),!c.System.existMenu(n.menu.id))return"continue"}else if(q.iconCls="extIcon extSearch searchColor",!c.System.isSuperRole())return"continue";if(1==n.linkColumns.length){var r=n.linkColumns[0];q.text=c.Base.toString(r.link_menu_text,
n.comment);q.handler=function(){var u={};u["t."+r.name]=a.getSelection()[0].get(r.linkKey);u["^"+r.linkText[0]]=a.getSelection()[0].get(r.linkText[0]);eval("new "+n.entityCode+"()").showWinList(this,n.comment+"\u3010"+r.comment+"\u3011",u,!0)};c.Base.toBool(r.to_link_menu,!0)&&f.menu.push(q)}else if(1<n.linkColumns.length){q.menu=[];l=function(u){var t=n.linkColumns[u];u={icon:c.Server.getIcon("icon_column.svg"),text:c.Base.toString(t.link_menu_text,"\u5339\u914d"+t.comment),handler:function(){var w=
{};w["t."+t.name]=a.getSelection()[0].get(t.linkKey);w["^"+t.linkText[0]]=a.getSelection()[0].get(t.linkText[0]);eval("new "+n.entityCode+"()").showWinList(this,n.comment+"\u3010"+t.comment+"\u3011",w,!0)}};c.Base.toBool(t.to_link_menu,!0)&&q.menu.push(u)};for(p=0;p<n.linkColumns.length;p++)l(p);0<q.menu.length&&(1===q.menu.length&&(q=q.menu[0]),f.menu.push(q))}}},k=0;k<a.getStore().entity.linkTables.length;k++)h(k);d.add("-\x3e");c.System.gridDefaultLinkButton&&c.System.isSuperRole()&&c.Base.toBool(a.defaultToolBarLink,
!0)&&0<f.menu.length&&d.add(f);c.Base.toBool(a.defaultToolBarMore,!0)&&d.add(e)}}}finally{d&&0===d.items.length&&d.setHidden(!0)}}};b.configGridTip=function(a){if(a){var d=c.Grid.getGridView(a);d&&(a.tip=new Ext.ToolTip({target:d.el,delegate:".x-grid-cell-inner",trackMouse:!0,renderTo:Ext.getBody(),listeners:{beforeshow:function(e){if(a.operate&&!a.operate.hoverTip)return!1;var f=$(e.triggerElement).text();if(Ext.isEmpty(f)||"\u65e0"===f||"\x26nbsp;"===f||" "===f||"\u00a0"===f)return!1;var g=$(e.triggerElement).find("[data-details-id]");
if(0<g.length&&(g=window[$(g).attr("data-details-id")]))return e.update(g),!0;e.update(f)}}}))}};b.configGridMethod=function(a){a&&!a.configGridMethod&&(a.configGridMethod=!0,a.refreshPowerEnable=c.GridMethod.doRefreshPowerEnable,a.refreshSelect=c.GridMethod.doRefreshSelect,a.recordSelect=c.GridMethod.doRecordSelect,a.hasRecordHistory=c.GridMethod.doHasRecordHistory,a.removeRecordHistory=c.GridMethod.doRemoveRecordHistory,a.restoreSelect=c.GridMethod.doRestoreSelect,a.getSelectRecordHistory=c.GridMethod.doGetSelectRecordHistory,
a.clearSelectRecordHistory=c.GridMethod.doClearSelectRecordHistory,a.refreshSelectHistoryCount=c.GridMethod.doRefreshSelectHistoryCount,a.refreshDetailsPanel=c.GridMethod.doRefreshDetailsPanel,a.saveUIConfig=c.GridMethod.doSaveUIConfig,a.showEmptyTip=c.GridMethod.doShowEmptyTip,a.hideEmptyTip=c.GridMethod.doHideEmptyTip,a.checkEditor=c.GridMethod.doCheckEditor,a.checkAdd=c.GridMethod.doCheckAdd,a.checkDelete=c.GridMethod.doCheckDelete,a.checkRefreshTimer=c.GridMethod.doCheckRefreshTimer,a.startRefreshTimer=
c.GridMethod.doStartRefreshTimer,a.stopRefreshTimer=c.GridMethod.doStopRefreshTimer)};b.configGridListeners=function(a){a&&!a.configListener&&(a.configListener=!0,a.on("aftertabactive",c.GridEvent.onFastAfterTabActive,a),a.on("viewready",c.GridEvent.onFastViewRead,a),a.on("beforedestroy",c.GridEvent.onFastBeforeDestroy,a),a.on("columnmove",c.GridEvent.onFastColumnMove,a),a.on("columnresize",c.GridEvent.onFastColumnResize,a),a.on("columnschanged",c.GridEvent.onFastColumnsChanged,a),a.on("headertriggerclick",
c.GridEvent.onFastHeaderTriggerClick,a),a.on("headercontextmenu",c.GridEvent.onFastHeaderContextMenu,a),a.on("headermenucreate",c.GridEvent.onFastHeaderMenuCreate,a),a.on("headerclick",c.GridEvent.onFastHeaderClick,a),a.on("sortchange",c.GridEvent.onFastSortChange,a),a.on("cellcontextmenu",c.GridEvent.onFastCellContextMenu,a),a.getStore().on("endupdate",c.GridEvent.onFastStoreEndUpdate,a),a.on("celldblclick",c.GridEvent.onFastCellDblclick,a),a.on("beforeedit",c.GridEvent.onFastBeforeEdit,a),a.on("selectionchange",
c.GridEvent.onFastSelectionChange,a),a.getStore().on("datachanged",c.GridEvent.onFastStoreDataChanged,a),a.getStore().on("load",c.GridEvent.onFastStoreLoad,a))};b.configNormalGridListeners=function(a){a&&!a.configNormalGridListeners&&(a.configNormalGridListeners=!0,a.getStore().on("datachanged",c.GridEvent.onFastStoreDataChanged,a),a.getStore().on("beforeload",c.GridEvent.onFastStoreBeforeLoad,a))};b.configGridLayout=function(a){return new Ext.Promise(function(d,e){a?(c.System.silenceGlobalSave||
c.Grid.getGridView(a).setLoading("\u521d\u59cb\u5316\u914d\u7f6e\u4e2d\u2026\u2026"),c.Grid.restoreGridOperate(a).then(function(){c.Grid.restoreGridColumn(a).then(function(){c.Grid.getGridView(a).setLoading(!1);d(!0)})})):d(!0)})};b.getGridInWindowSize=function(a){var d=parseInt((.4*a.getWidth()).toFixed(0));a=parseInt((.4*a.getHeight()).toFixed(0));return{width:d,height:a}};b.showGridSelectDetailsWindow=function(a,d){var e="";d.getStore().entity&&d.getStore().entity.menu&&(e="\u3010"+d.getStore().entity.menu.text+
"\u3011");var f=parseInt((.4*document.body.clientWidth).toFixed(0)),g=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:"\u67e5\u770b\u8be6\u60c5"+e,subtitle:e,height:g,width:f,minHeight:450,minWidth:400,iconCls:"extIcon extDetails",layout:"border",resizable:!0,collapsible:!0,constrain:!0,maximizable:!0,animateTarget:a,record:d.getSelectionModel().getSelection()[0],tools:[{type:"help",callback:function(h,k,l){c.Dialog.showJson(this,"\u67e5\u770b\u539f\u59cb\u6570\u636e\u7ed3\u6784",
c.Json.objectToJson(h.record.data))}}],listeners:{show:function(h){h.focus()}},items:[c.Grid.getDetailsPanel(d,!0)]}).show()};b.getDetailsPanel=function(a,d){var e="";a.getStore().entity.menu&&(e=a.getStore().entity.menu.text);a.detailsPanels||(a.detailsPanels=[]);e={subtitle:e,layout:"border",border:0,autoScroll:!1,scrollable:!1,closeAction:"hide",dataId:-1,currIsClosed:!1,closeTimer:null,detailsPanel:!0,isWindow:d,setRecord:function(g){try{var h=this;if(!h.items)return!1;h.closeTimer&&window.clearTimeout(h.closeTimer);
if(null!=g){var k=g.getSelectionModel().getSelection();if(1===k.length){if(h.isWindow&&h.record&&!c.Store.isSameRecord(h.record,k[0]))return!1;h.record=k[0];h.items.get(0).setRecord(g,k[0]);h.show()}else h.isVisible()&&!this.isWindow&&(h.closeTimer=setTimeout(function(){h.close()},88))}else h.close()}catch(l){c.Dialog.showException(l)}return!0},listeners:{afterrender:function(){this.isWindow&&this.setRecord(a)},collapse:function(g,h){this.down("#close").hide()},beforeexpand:function(g,h){this.down("#close").show()},
destroy:function(g){a.detailsPanels=Ext.Array.remove(a.detailsPanels,g)}},items:[c.Grid.builderDetailsGrid(d)]};d?e.region="center":(e.title="\u6570\u636e\u8be6\u60c5",e.iconCls="extIcon extDetails",e.collapsed=!0,e.split=!0,e.hidden=!0,e.region="east",e.maxWidth=parseInt((document.body.clientWidth/2).toFixed(0)),e.width=parseInt((.3*document.body.clientWidth).toFixed(0)),e.minWidth=200,e.tools=[{type:"gear",callback:function(){c.Grid.setGrid(this,a)}},{type:"close",itemId:"close",callback:function(){f.collapse()}}]);
var f=Ext.create("Ext.panel.Panel",e);f.fromWindow=d;a.detailsPanels.push(f);return f};b.builderDetailsGrid=function(a){Ext.isEmpty(a)&&(a=!1);return Ext.create("Ext.grid.Panel",{border:0,scrollable:"y",region:"center",store:Ext.create("Ext.data.Store",{groupField:"groupHeaderText",autoLoad:!1,fields:[]}),hideHeaders:!0,deferRowRender:!1,superGrid:null,features:[{ftype:"grouping",collapsible:!1,hideGroupedHeader:!0,expandTip:null,collapseTip:null,groupHeaderTpl:["\x3cb\x3e{name:this.formatName}\x3c/b\x3e",
{formatName:function(d){return d.toString().startsWith("BASE")?"\u57fa\u672c\u5c5e\u6027":d}}]}],setRecord:function(d,e){try{if(d&&e){this.recordId=e.getId();this.superGrid=d;e.store=d.getStore();for(var f=d.getColumns(),g=[],h="BASE-"+(new Date).getTime(),k=0;k<f.length;k++){var l=f[k];if(!Ext.isEmpty(l.dataIndex)&&(c.Base.toBool(l.hideable,!0)||c.Grid.isTreeColumn(l))){var n={text:l.configText,value:e.get(l.dataIndex),dataIndex:l.dataIndex,columnName:l.columnName,groupHeaderText:l.groupHeaderText,
renderer:l.renderer,index:l.getIndex(),record:e,linkColumn:l,entity:d.getStore().entity,configEditor:c.Base.toBool(l.editable,!0),editor:!1};Ext.isEmpty(l.field)&&(n.configEditor=!1);d.checkEditor()||(n.configEditor=!1);n.groupHeaderText?h="BASE-"+k+"-"+(new Date).getTime():n.groupHeaderText=h;g.push(n)}}g.sort(function(p,q){return p.index-q.index});this.getStore().loadData(g)}}catch(p){}},columns:[{header:"\u540d\u79f0",dataIndex:"text",align:"right",flex:.3,tdCls:"tdVTop",renderer:function(d,e,
f){if(Ext.isEmpty(d))return"";e.style="color:#000000;overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space:normal !important;word-break:break-word;line-height: 30px; ";return"\x3cb\x3e"+d+"\uff1a\x3c/b\x3e"}},{header:"\u503c",dataIndex:"value",flex:.7,align:"left",renderer:function(d,e,f,g,h,k,l){try{e.style="overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space:normal !important;word-break:break-word;line-height: 30px;";var n=f.get("renderer");if(Ext.isFunction(n)){var p=
n(d,e,f.get("record"),g,h,k,l,!0);return Ext.isEmpty(p)?"\x3cfont color\x3d'#ccc'\x3e\u65e0\x3c/font\x3e":p}return d}catch(q){return d}}},{xtype:"actioncolumn",width:80,sortable:!1,menuDisabled:!0,items:[{iconCls:"extIcon extEdit editColor marginRight5 textBlackShadowWhite",tooltip:"\u7f16\u8f91\u6570\u636e",align:"center",isDisabled:function(d,e,f,g,h){return!c.Base.toBool(h.get("editor"),!1)},getClass:function(d,e,f){return c.Base.toBool(f.get("editor"),!1)?"extIcon extEdit editColor marginRight5 textBlackShadowWhite":
""},handler:c.Grid.showDetailsEditMenu},{iconCls:"extIcon extCopy2 searchColor textBlackShadowWhite",tooltip:"\u590d\u5236\u6570\u636e",align:"center",isDisabled:function(d,e,f,g,h){return!c.Base.toBool(h.get("doCopy"),!1)},getClass:function(d,e,f){return c.Base.toBool(f.get("doCopy"),!1)?"extIcon extCopy2 searchColor textBlackShadowWhite":""},handler:c.Grid.copyDetailsValue}]}],tbar:{flex:1,emptyText:"\u67e5\u627e\u5c5e\u6027\uff08\u8f7b\u6572\u56de\u8f66\u952e\uff09",margin:"5",xtype:"textfield",
doSearch:function(){var d=this.ownerCt,e=d.getStore(),f=0,g=e.getAt(0).get("dataIndex"),h=null,k=this.getValue();Ext.isEmpty(k)||e.each(function(l,n){var p=l.get("text").toString(),q=l.get("value");if(0<=p.indexOf(k))f=n,g=l.get("dataIndex"),h=p;else if(!Ext.isEmpty(q)&&0<=q.toString().indexOf(k))return f=n,g=l.get("dataIndex"),h=p,!1});c.Grid.scrollToColumn(d.superGrid,g,h);d.getSelectionModel().select(f);c.Grid.getGridView(d).focusRow(f)},triggers:{search:{cls:"text-search",handler:function(){this.doSearch()}}},
listeners:{render:function(d,e){try{new Ext.util.KeyMap({target:d.getEl(),key:13,fn:function(f,g){this.doSearch()},scope:this})}catch(f){console.error(f)}}}},bbar:{xtype:"label",style:{background:"#ffffff"},text:"\u5c0f\u6280\u5de7\uff1a\u53cc\u51fb\u5c5e\u6027\u53ef\u5feb\u901f\u5b9a\u4f4d\u5de6\u4fa7\u8868\u683c\u5bf9\u5e94\u7684\u5217\uff01",padding:"10"},viewConfig:{enableTextSelection:!0},toggleActionColumn:function(d){if(this.lasClickRecord){if(this.lasClickRecord.getId()===d.getId())return;
this.lasClickRecord.set("editor",!1);this.lasClickRecord.set("doCopy",!1)}d.set("doCopy",!0);d.set("editor",d.get("configEditor"));this.lasClickRecord=d},listeners:{itemclick:function(d,e,f,g,h,k){this.toggleActionColumn(e)},select:function(d,e){this.toggleActionColumn(e)},itemdblclick:function(){try{var d=this.getSelectionModel().getSelection();0!=d.length&&c.Grid.scrollToColumn(this.superGrid,d[0].get("dataIndex"),d[0].get("text"))}catch(e){c.Dialog.showException(e,"details:itemdblclick")}}}})};
b.hasSearchColumn=function(a){var d=!1;if(!a)return!1;Ext.each(a.getColumns(),function(e,f){if(!Ext.isEmpty(e.dataIndex)&&e.where&&0<e.where.length)return d=!0,!1});return d};b.getColumn=function(a,d,e){if(!a)return null;a=a.getColumns();for(e=0;e<a.length;e++){var f=a[e];if(f.dataIndex===d)return f}return null};b.checkColumnSearch=function(a){try{if(!a)return!1;var d=!1;Ext.each(a.getColumns(),function(g){if(g.where&&0<g.where.length)return d=!0,!1});var e=a.child("#pagingToolBar");if(e){var f=e.down("button[toolType\x3dsearchBtn]");
f&&(d?(f.setIconCls("extIcon extSearch redColor"),f.setUserCls("redBorder")):(f.setIconCls("extIcon extSearch grayColor"),f.setUserCls("")))}}catch(g){console.error(g)}};b.hasColumnField=function(a){try{if(Ext.isObject(a.field)||!Ext.isEmpty(a.field))return!0}catch(d){console.error(d)}return!1};b.isColumnType=function(a){return"gridcolumn"===a||"gridcolumn"===a.xtype};b.isTreeColumn=function(a){return a?"treecolumn"===a.xtype:!1};b.isIdPropertyColumn=function(a){var d=c.Grid.getColumnGrid(a);if(d&&
(d=d.getStore())&&d.entity&&d.entity.idProperty)for(var e=0;e<d.entity.idProperty.length;e++){var f=d.entity.idProperty[e];if(c.Base.toString(a.dataIndex,"")===f)return!0}return!1};b.isDateColumn=function(a){return a?c.Form.isDateField(a.field):!1};b.isNumberColumn=function(a){return a?c.Form.isNumberField(a.field):!1};b.isComboColumn=function(a){return a?c.Form.isComboField(a.field):!1};b.isFileColumn=function(a){return a?c.Form.isFileField(a.field):!1};b.isContentColumn=function(a){return a?c.Form.isHtmlContentField(a.field)||
c.Form.isContentField(a.field)||c.Form.isMonacoEditorField(a.field):!1};b.isHtmlContentColumn=function(a){return a?c.Form.isHtmlContentField(a.field):!1};b.isFilesColumn=function(a){return a?c.Form.isFilesField(a.field):!1};b.isEnumColumn=function(a){return a?c.Form.isEnumField(a.field):!1};b.isLinkColumn=function(a){return a?c.Form.isLinkField(a.field):!1};b.isMapColumn=function(a){return a?c.Form.isMapField(a.field):!1};b.isPCAColumn=function(a){return a?c.Form.isPCAField(a.field):!1};b.isTargetColumn=
function(a){return a?c.Form.isTargetField(a.field):!1};b.getGridSelModel=function(a){var d=0;c.System.gridRowNumber&&(d=46);Ext.isEmpty(a)||(d=a?46:0);return Ext.create("Ext.grid.selection.SpreadsheetModel",{pruneRemoved:!1,checkboxSelect:!0,hasLockedHeader:!0,cellSelect:!1,rowNumbererHeaderWidth:d,listeners:{focuschange:function(e,f,g,h){}}})};b.refreshGridNumberColumn=function(a){if(a.operate){var d=a.getSelectionModel();d&&d.numbererColumn&&(c.Base.toBool(a.operate.showRowNumber)?d.numbererColumn.setWidth(Math.max(d.numbererColumn.getWidth(),
52)):d.numbererColumn.setWidth(0))}};b.checkConfigGridNumberColumn=function(a){try{if(!a)return!1;var d=a.getSelectionModel();if(d&&d.numbererColumn)return 0<d.numbererColumn.configWidth}catch(e){}return!1};b.blinkColumn=function(a){if(!a.blinking){a.blinking=!0;var d=a.getEl().getStyle("color"),e=a.getEl().getStyle("background"),f="#e41f00";0<e.indexOf("linear-gradient")&&(f="linear-gradient(0deg, #e41f00, #fefefe)");a.setStyle({color:"white",background:f});setTimeout(function(){a.setStyle({color:d,
background:e});a.blinking=!1},1E3)}};b.scrollToColumn=function(a,d,e){a&&(d=c.Grid.getColumn(a,d,e),c.Grid.blinkColumn(d),e=d.getLocalX(),d.isSubHeader&&(e+=d.ownerCt.getLocalX()),a.scrollTo(e,0,!0))};b.setGrid=function(a,d){var e=Ext.create("Ext.form.Panel",{bodyPadding:5,region:"center",autoScroll:!0,viewModel:{data:d.operate},defaults:{labelWidth:6*c.Base.getNumberValue(c.System.fontSize)+8},items:[{xtype:"checkboxfield",fieldLabel:"\u663e\u793a\u5e8f\u53f7",labelAlign:"right",columnWidth:1,name:"showRowNumber",
bind:"{showRowNumber}",uncheckedValue:!1,boxLabel:"\u81ea\u7136\u5e8f\u53f7\uff0c\u5728\u5217\u8868\u4e2d\u7684\u663e\u793a\u51fa\u81ea\u7136\u5e8f\u53f7\uff01"},{xtype:"checkboxfield",fieldLabel:"\u5220\u9664\u63d0\u9192",labelAlign:"right",name:"alertDelete",columnWidth:1,bind:"{alertDelete}",uncheckedValue:!1,hidden:!d.deleteEnable,boxLabel:"\u5220\u9664\u6570\u636e\u65f6\uff0c\u7cfb\u7edf\u4f1a\u5f39\u51fa\u786e\u8ba4\u5220\u9664\u6846\uff0c\u907f\u514d\u8bef\u64cd\u4f5c\u5220\u9664\uff01"},{xtype:"checkboxfield",
fieldLabel:"\u4fee\u6539\u63d0\u9192",labelAlign:"right",columnWidth:1,name:"alertUpdate",bind:"{alertUpdate}",hidden:!d.updateEnable,uncheckedValue:!1,boxLabel:"\u4fee\u6539\u6570\u636e\u65f6\uff0c\u7cfb\u7edf\u4f1a\u5f39\u51fa\u786e\u8ba4\u4fee\u6539\u6846\uff0c\u907f\u514d\u8bef\u64cd\u4f5c\u4fee\u6539\uff01"},{xtype:"checkboxfield",fieldLabel:"\u81ea\u52a8\u63d0\u4ea4",labelAlign:"right",columnWidth:1,name:"autoUpdate",bind:"{autoUpdate}",hidden:!d.updateEnable,uncheckedValue:!1,boxLabel:"\u53cc\u51fb\u7f16\u8f91\u4fee\u6539\u6570\u636e\u540e\uff0c\u7cfb\u7edf\u81ea\u52a8\u63d0\u4ea4\u88ab\u4fee\u6539\u7684\u6570\u636e\uff01"},
{xtype:"checkboxfield",fieldLabel:"\u5f39\u51fa\u8be6\u60c5",labelAlign:"right",columnWidth:1,name:"autoDetails",bind:"{autoDetails}",uncheckedValue:!1,boxLabel:"\u70b9\u51fb\u6570\u636e\u65f6\uff0c\u53f3\u4fa7\u81ea\u52a8\u5f39\u51fa\u6b64\u6570\u636e\u7684\u8be6\u60c5\u7a97\u4f53\uff01"},{xtype:"checkboxfield",fieldLabel:"\u60ac\u6d6e\u9605\u89c8",labelAlign:"right",columnWidth:1,name:"hoverTip",bind:"{hoverTip}",uncheckedValue:!1,boxLabel:"\u5f53\u9f20\u6807\u60ac\u6d6e\u5728\u6570\u636e\u8d85\u8fc72\u79d2\u540e\uff0c\u4f1a\u5728\u9f20\u6807\u53f3\u4e0b\u65b9\u5f39\u51fa\u6b64\u6570\u636e\u7684\u9605\u89c8\uff01"},
{xtype:"checkboxfield",fieldLabel:"\u6570\u636e\u5237\u65b0",labelAlign:"right",columnWidth:1,name:"refreshData",bind:"{refreshData}",uncheckedValue:!1,boxLabel:"\u79bb\u5f00\u6b64\u6807\u7b7e\u9875\u540e\uff0c\u518d\u6b21\u8fd4\u56de\u6b64\u6807\u7b7e\u9875\u65f6\u5c06\u5237\u65b0\u5f53\u524d\u6807\u7b7e\u9875\u7684\u5217\u8868\u6570\u636e\uff01"}]}),f="\u64cd\u4f5c\u8bbe\u7f6e";d.getStore().entity&&d.getStore().entity.menu&&(f=c.Store.getStoreMenuText(d.getStore())+"-"+f);var g=parseInt((.3*document.body.clientWidth).toFixed(0)),
h=Ext.create("Ext.window.Window",{title:f,iconCls:"extIcon extSet",height:460,width:g,minHeight:400,minWidth:300,layout:"border",resizable:!1,animateTarget:a,items:[e],modal:!0,constrain:!0,buttons:["-\x3e",{text:"\u4fdd\u5b58\u914d\u7f6e",iconCls:"extIcon extSave whiteColor",handler:function(){c.Dialog.showWait("\u6b63\u5728\u4fdd\u5b58\u4e2d\u2026");c.Server.saveExtConfig(d.code,"GridOperate",Ext.encode(e.getForm().getValues()),function(k,l){c.Dialog.hideWait();k?(d.operate=e.getForm().getValues(),
c.Dialog.toast("\u64cd\u4f5c\u8bbe\u7f6e\u6210\u529f\uff01"),c.Grid.refreshGridNumberColumn(d),h.close()):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",l)})}},{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){h.close()}}]});h.show()};b.getColumnEnumName=function(a){return c.Grid.isEnumColumn(a)&&Ext.isObject(a.field)?a.field.enumName:null};b.getColumnFieldType=function(a){return Ext.isObject(a.field)?a.field.xtype:a.field};b.exportGrid=function(a){if(a.getStore().entity){var d="\u60a8\u786e\u5b9a\u5bfc\u51fa\u5f53\u524d\u6761\u4ef6\u4e0b\u7684\u6240\u6709\u6570\u636e\u5417\uff1f",
e=a.getSelection();0<e.length&&(d="\u60a8\u786e\u5b9a\u5bfc\u51fa\u9009\u4e2d\u7684"+e.length+"\u6761\u6570\u636e\u5417\uff1f");var f=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"5 5 5 5"},items:[{xtype:"lottie",width:150,height:120,jsonPath:"base/lottie/question.json"},{xtype:"label",text:d},{xtype:"checkboxfield",boxLabel:"\u5bfc\u51fa\u65f6\u81ea\u52a8\u751f\u6210\u6570\u636e\u5e8f\u53f7",uncheckedValue:!1,
name:"exportIndex"}]}),g=function(k){if(a)if(a.getStore().entity){a.getStore().entity.menu&&(k.title=a.getStore().entity.menu.text);if(0<e.length){if(!a.getStore().entity.idProperty){c.Dialog.toast("\u5f53\u524d\u5217\u8868\u4e0d\u652f\u6301\u9009\u4e2d\u5bfc\u51fa\u529f\u80fd\uff01");return}for(var l=0;l<e.length;l++)for(var n=e[l],p=0;p<a.getStore().entity.idProperty.length;p++){var q=a.getStore().entity.idProperty[p],r="where['"+q+"#']";k[r]||(k[r]=[]);k[r].push(n.get(q))}}Ext.each(a.getColumns(),
function(u,t){u.isHidden()||!c.Base.toBool(u.excelOutHeader,!0)||Ext.isEmpty(u.dataIndex)||(k["column["+t+"].width"]=u.width,k["column["+t+"].text"]=u.configText,k["column["+t+"].groupHeaderText"]=u.groupHeaderText,k["column["+t+"].enum"]=c.Grid.getColumnEnumName(u),k["column["+t+"].dataIndex"]=c.Entity.getRealAttr(u),k["column["+t+"].valueIndex"]=u.dataIndex,k["column["+t+"].file"]=c.Grid.isFileColumn(u),k["column["+t+"].files"]=c.Grid.isFilesColumn(u),k["column["+t+"].type"]=c.Grid.getColumnFieldType(u),
k["column["+t+"].comment"]=u.excelComment||u.comment,c.Grid.isDateColumn(u)&&(k["column["+t+"].format"]=u.field.format))});c.Dialog.showWait("\u6b63\u5728\u5bfc\u51fa\u4e2d\u2026\u2026");c.Server.exportExcel(c.Store.mergeStoreParamBySelect(a.getStore(),k),function(u,t,w){c.Dialog.hideWait();u?(c.Dialog.toast(w),h.close(),location.href="attach/"+t):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u5bfc\u51fa\u5931\u8d25\uff01"+w)})}else c.Dialog.toast("\u5f53\u524d\u5217\u8868\u4e0d\u652f\u6301\u6b64\u529f\u80fd\uff01")},
h=Ext.create("Ext.window.Window",{title:"\u5bfc\u51faExcel",height:330,iconCls:"extIcon extExcel",width:300,layout:"border",constrain:!0,resizable:!1,items:[f],modal:!0,buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){h.close()}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){g(f.getForm().getValues())}},"-\x3e"]});h.show()}else Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u5bfc\u51fa\u5931\u8d25\uff01Grid\u7684DataStore\u672a\u7ed1\u5b9aEntity!")};
b.downExcelModel=function(a){var d=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"5 5 5 5"},items:[{xtype:"lottie",width:150,height:120,jsonPath:"base/lottie/question.json"},{xtype:"label",text:"\u786e\u5b9a\u4e0b\u8f7d\u5bfc\u5165\u6570\u636e\u7684Excel\u6a21\u677f\u5417\uff1f"},{xtype:"checkboxfield",boxLabel:"\u5305\u542b\u5df2\u9690\u85cf\u7684\u5217",uncheckedValue:!1,name:"exportHidden"}]}),e=function(g){if(a){c.Dialog.showWait("\u6b63\u5728\u751f\u6210\u4e2d\u2026\u2026");
var h={entityCode:a.getStore().entity.entityCode};a.getStore().entity.menu&&(h.title=a.getStore().entity.menu.text);Ext.each(a.getColumns(),function(k,l){if(!(c.Grid.isFileColumn(k)||c.Grid.isFilesColumn(k)||!c.Base.toBool(k.excelHeader,!0)||!c.Base.toBool(g.exportHidden,!1)&&k.isHidden()||Ext.isEmpty(k.dataIndex))){var n=l;10>l&&(n="0"+l);h["column["+n+"].width"]=k.width;h["column["+n+"].text"]=k.configText;h["column["+n+"].groupHeaderText"]=k.groupHeaderText;h["column["+n+"].enum"]=c.Grid.getColumnEnumName(k);
h["column["+n+"].type"]=c.Grid.getColumnFieldType(k);h["column["+n+"].comment"]=k.excelComment||k.comment;h["column["+n+"].dataIndex"]=c.Entity.getRealAttr(k);h["column["+n+"].excelHeaderText"]=k.excelHeaderText;c.Grid.isDateColumn(k)&&(h["column["+n+"].format"]=k.field.format)}});c.Server.excelModule(h,function(k,l,n){c.Dialog.hideWait();k?(f.close(),c.Dialog.toast("\u6a21\u677f\u751f\u6210\u6210\u529f\uff01"),location.href="attach/"+l):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u751f\u6210\u5931\u8d25\uff01"+
n)})}},f=Ext.create("Ext.window.Window",{title:"\u4e0b\u8f7d\u6a21\u677f",height:320,iconCls:"extIcon extExcel",width:280,layout:"border",constrain:!0,resizable:!1,items:[d],modal:!0,buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){f.close()}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){e(d.getForm().getValues())}},"-\x3e"]});f.show()};b.importExcel=function(a,d,e,f){return new Ext.Promise(function(g,h){e=e?Ext.Array.clone(e):[];f||(f=c.Server.importEntityExcelUrl());
e.push({xtype:"filefield",fieldLabel:"Excel\u6587\u4ef6",buttonText:"\u9009\u62e9\u6587\u4ef6",allowBlank:!1,name:"file",columnWidth:1,listeners:{change:function(p,q,r){null==q||0==q.length||c.FileModule.excel().match(q)||(k.form&&k.form.reset(),Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u8bf7\u4e0a\u4f20\u6709\u6548\u7684Excel\u6587\u6863\uff01"))}}});var k=Ext.create("Ext.form.FormPanel",{url:f,method:"POST",margin:"5",fileUpload:!0,width:400,callBacked:!1,border:0,layout:"column",defaults:{labelWidth:80,
margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},items:e,doSubmit:function(){var p=k.form;if(p.isValid()){var q=new Ext.LoadMask({msg:"\u6b63\u5728\u5bfc\u5165\u4e2d\u2026",target:n});q.show();p.submit({params:d,success:function(r,u){q.destroy();Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",u.result.message,function(){c.Base.runCallBack(g,u.result);n.close()})},failure:function(r,u){q.destroy();u.result&&Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u5bfc\u5165\u5931\u8d25\uff01"+u.result.message)}})}},
listeners:{render:function(p){try{new Ext.util.KeyMap({target:p.getEl(),key:13,fn:k.doSubmit,scope:Ext.getBody()})}catch(q){console.error(q)}}}}),l="btnSubmit"+(new Date).getTime(),n=Ext.create("Ext.window.Window",{title:"\u5bfc\u5165Excel\u6570\u636e",layout:"fit",resizable:!1,scrollable:!1,items:[k],modal:!0,iconCls:"extIcon extUpload",animateTarget:a,constrain:!0,buttons:[{text:"\u91cd\u7f6e",width:88,iconCls:"extIcon extReset",handler:function(){k.form&&k.form.reset()}},{text:"\u4e0a\u4f20",width:88,
id:l,iconCls:"extIcon extOk",handler:function(){k.doSubmit()}}],listeners:{show:function(p,q){1===e.length&&(k.getForm().findField("file").fileInputEl.dom.click(),Ext.getCmp(l).focus())}}});n.show()})};b.downDataGrid=function(a){if(a.getStore().entity){var d="\u60a8\u786e\u5b9a\u4e0b\u8f7d\u5f53\u524d\u6761\u4ef6\u4e0b\u7684\u6240\u6709\u6570\u636e\u5417\uff1f",e=a.getSelection();0<e.length&&(d="\u60a8\u786e\u5b9a\u4e0b\u8f7d\u9009\u4e2d\u7684"+e.length+"\u6761\u6570\u636e\u5417\uff1f");a.getStore().entity?
Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192",d,function(f,g){if("yes"===f){f={};a.getStore().entity.menu&&(f.title=a.getStore().entity.menu.text);if(0<e.length){if(!a.getStore().entity.idProperty){c.Dialog.toast("\u5f53\u524d\u5217\u8868\u4e0d\u652f\u6301\u4e0b\u8f7d\u9009\u4e2d\u6570\u636e\u529f\u80fd\uff01");return}for(g=0;g<e.length;g++)for(var h=e[g],k=0;k<a.getStore().entity.idProperty.length;k++){var l=a.getStore().entity.idProperty[k],n="where['"+l+"#']";f[n]||(f[n]=[]);f[n].push(h.get(l))}}c.Dialog.showWait("\u6b63\u5728\u4e0b\u8f7d\u4e2d\u2026\u2026");
c.Server.downData(c.Store.mergeStoreParamBySelect(a.getStore(),f),function(p,q,r){c.Dialog.hideWait();p?(c.Dialog.toast(q),location.href="attach/"+r):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",q)})}}):c.Dialog.toast("\u5f53\u524d\u5217\u8868\u4e0d\u652f\u6301\u6b64\u529f\u80fd\uff01")}else Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u4e0b\u8f7d\u5931\u8d25\uff01Grid\u7684DataStore\u672a\u7ed1\u5b9aEntity!")};b.loadDataGrid=function(a,d){return new Ext.Promise(function(e,f){var g=Ext.create("Ext.form.FormPanel",
{url:c.Server.loadEntityDataUrl(),method:"POST",margin:"5",fileUpload:!0,width:400,callBacked:!1,border:0,layout:"column",defaults:{labelWidth:80,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},items:[{xtype:"filefield",fieldLabel:"\u6570\u636e\u6587\u4ef6",buttonText:"\u9009\u62e9\u6587\u4ef6",allowBlank:!1,name:"file",columnWidth:1,listeners:{change:function(l,n,p){null==n||0==n.length||c.FileModule.data().match(n)||(g.form&&g.form.reset(),Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",
"\u8bf7\u4e0a\u4f20\u6709\u6548\u7684\u6570\u636e\u6587\u4ef6\uff01"))}}}],doSubmit:function(){var l=g.form;if(l.isValid()){var n=new Ext.LoadMask({msg:"\u6b63\u5728\u4e0a\u4f20\u4e2d\u2026",target:k});n.show();l.submit({params:d,success:function(p,q){n.destroy();Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",q.result.message,function(){c.Base.runCallBack(e,q.result);k.close()})},failure:function(p,q){n.destroy();q.result&&Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u4e0a\u4f20\u5931\u8d25\uff01"+q.result.message)}})}},
listeners:{render:function(l){try{new Ext.util.KeyMap({target:l.getEl(),key:13,fn:g.doSubmit,scope:Ext.getBody()})}catch(n){console.error(n)}}}}),h="btnSubmit"+(new Date).getTime(),k=Ext.create("Ext.window.Window",{title:"\u4e0a\u4f20\u5b9e\u4f53\u6570\u636e",layout:"fit",resizable:!1,scrollable:!1,items:[g],modal:!0,iconCls:"extIcon extUpload",animateTarget:a,constrain:!0,buttons:[{text:"\u91cd\u7f6e",width:88,iconCls:"extIcon extReset",handler:function(){g.form&&g.form.reset()}},{text:"\u4e0a\u4f20",
width:88,id:h,iconCls:"extIcon extOk",handler:function(){g.doSubmit()}}],listeners:{show:function(l,n){g.getForm().findField("file").fileInputEl.dom.click();Ext.getCmp(h).focus()}}});k.show()})};b.saveGridColumn=function(a){if(Ext.isEmpty(a.code))return c.Base.getEmptyPromise();if(a)return new Ext.Promise(function(d,e){try{var f={noneManager:!0},g=!1,h=!1;a.getStore()&&a.getStore().entity&&(g=Ext.isFunction(a.getStore().entity.getColumnRender),h=Ext.isFunction(a.getStore().entity.getEditorField),
a.getStore().entity.menu&&(f.menuId=a.getStore().entity.menu.id,c.Base.toBool(a.menuPanelList,!1)&&(f.entityCode=a.getStore().entity.entityCode)),c.System.silenceGlobalSave&&(f.entityCode=a.getStore().entity.entityCode),c.Base.toBool(a.mainEntityList,!0)||delete f.entityCode,a.columnEntityCode&&(f.entityCode=a.columnEntityCode));var k={};Ext.each(a.getColumns(),function(l,n){if(Ext.isEmpty(l.dataIndex))"rownumberer"===l.xtype&&(n={},n.width=l.width,n.text=l.configText,k.rownumberer=n);else if(c.System.isSuperRole()||
l.hideable||!l.hidden){n={column:!0};n.width=l.width;n.hidden=l.isHidden();n.locked=l.isLocked();n.text=l.configText;n.dataIndex=l.dataIndex;n.columnName=l.columnName;n.align=l.align;n.groupHeaderText=l.groupHeaderText;n.detailsable=l.detailsable;l.groupHeaderText&&"x-column-header"===l.ownerCt.componentCls&&l.ownerCt.isHidden()&&(n.hidden=!0);a.getStore().entity&&(n.entityCode=a.getStore().entityCode);var p=a.getStore().getSorters().getByKey(l.dataIndex);p&&(n.sortDirection=p.getDirection());n.searchLink=
l.searchLink;n.searchExclude=l.searchExclude;n.index=l.getIndex();n.canEdit=a.checkEditor()&&c.Base.toBool(l.editable,!0);n.version=c.Base.toString(a.columnsVersion,"1");g||(n.rendererFunction=l.rendererFunction,(p=c.Renders.getRenderFunStr(l))&&Ext.isEmpty(n.rendererFunction)&&(n.rendererFunction=p));h||(a.checkEditor()&&c.Base.toBool(l.editable,!0)?n.editorField=c.Grid.getColumnSimpleEditorJson(l):n.editorField="");k[l.code]=n}});k.PageTool={pageSize:a.getStore().pageSize,column:!1};c.Server.saveExtConfig(a.code,
"GridColumn",Ext.encode(k),function(l,n){d(l)},f)}catch(l){e(l)}})};b.saveGridButton=function(a,d){return Ext.isEmpty(a.code)||Ext.isEmpty(d)||!c.Base.toBool(a.menuPanelList,!1)?c.Base.getEmptyPromise():new Ext.Promise(function(e,f){try{var g=[];Ext.each(a.bindDetailButtons,function(h,k){k={};k.text=h.text;k.iconCls=h.iconCls;k.icon=h.icon;k.handler=h.handler.toString();g.push(k)});c.Server.saveExtConfig(d.entityCode,"GridButton",Ext.encode(g),function(h,k){e(h)},{})}catch(h){f(h)}})};b.restoreGridButton=
function(a){return new Ext.Promise(function(d,e){try{c.Server.showExtConfig(a,"GridButton",function(f,g){var h=[];f&&(h=Ext.decode(g));d(h)})}catch(f){e(f)}})};b.restoreGridColumn=function(a){return new Ext.Promise(function(d,e){try{Ext.isEmpty(a.code)?e("Grid\u7f16\u53f7[code]\u4e0d\u53ef\u4e3a\u7a7a\uff01"):a&&c.Server.showExtConfig(a.code,"GridColumn",function(f,g){if(a){var h={};f&&(h=Ext.decode(g));var k=h.rownumberer;f=[];var l={};g=[];var n=a.getColumns(),p=[];null!==a.getStore()&&a.getStore().entity&&
(p=a.getStore().entity.idProperty);for(var q=0;q<n.length;q++){var r=n[q];if(k&&"rownumberer"===r.xtype)0<parseInt(r.width)&&(r.width=k.width);else if(!(Ext.isEmpty(r.dataIndex)||c.Base.toBool(a.power,!0)&&!r.hideable&&r.hidden)){var u=r.cloneConfig();u.restoreConfig=!0;u.groupHeaderText=r.groupHeaderText;u.index=q;if(c.System.gridColumnRestore&&h.hasOwnProperty(r.code)){r=h[r.code];for(var t in r)"renderer"!==t&&"rendererFunction"!==t&&(u[t]=r[t])}Ext.isEmpty(u.sortDirection)||g.push({property:u.dataIndex,
direction:u.sortDirection.toUpperCase()});Ext.isEmpty(u.groupHeaderText)||(r=u.groupHeaderText,l.hasOwnProperty(r)||(l[r]=[]),l[r].push(f.length));if(c.System.gridIDColumnHidden&&p)for(r=0;r<p.length;r++)u.dataIndex===p[r]&&(u.hidden=!0);c.Base.toString(u.version,"1")!==c.Base.toString(a.columnsVersion,"1")&&(u.index=q);f.push(u)}}k=[];for(t in l)if(n=l[t],!(2>n.length)){p=999999;u=[];for(q=0;q<n.length;q++)r=n[q],p=Math.min(p,r),u.push(f[r]);u.sort(function(w,z){return w.index-z.index});f[p]={index:p,
text:t,menuDisabled:!0,columns:u};k=k.concat(u)}for(q=0;q<k.length;q++)f=Ext.Array.remove(f,k[q]);f.sort(function(w,z){return w.index-z.index});h.hasOwnProperty("PageTool")&&(h=h.PageTool,a.getStore().pageSize=Math.min(h.pageSize,c.Store.maxPageSize),(t=a.down("combo[pageTool\x3dtrue]"))&&t.setValue(Math.min(h.pageSize,c.Store.maxPageSize)));c.System.silenceGlobalSave||a.getStore().sort(g);a.reconfigure(f);d()}})}catch(f){e(f)}})};b.restoreGridOperate=function(a){return new Ext.Promise(function(d,
e){try{Ext.isEmpty(a.code)?e("Grid\u7f16\u53f7[code]\u4e0d\u53ef\u4e3a\u7a7a\uff01"):c.Server.showExtConfig(a.code,"GridOperate",function(f,g){var h={};f&&(h=Ext.decode(g));a&&(!h.hasOwnProperty("showRowNumber")&&c.Grid.checkConfigGridNumberColumn(a)&&(h.showRowNumber=!0),a.operate||(a.operate=new m),a.operate=c.Json.mergeJson(new m,a.operate),a.operate=c.Json.mergeJson(a.operate,h),d())})}catch(f){e(f)}})};b.getColumnGrid=function(a){a.grid||(a.grid=a.up("treepanel,grid"));return a.grid.ownerGrid?
a.grid.ownerGrid:a.grid};b.getHeaderContainerGrid=function(a){a.grid||(a.grid=a.up("treepanel,grid"));return a.grid.ownerGrid?a.grid.ownerGrid:null};b.showColumnCompute=function(a,d,e){try{if(d)if(a.getStore().entity){var f=a.getSelection();if(0<f.length){a=null;for(var g="",h=0;h<f.length;h++){var k=parseFloat(f[h].get(d.dataIndex));"sum"===e?(g=d.configText+"\u603b\u548c\uff1a",a||(a=0),a+=k):"avg"===e?(g=d.configText+"\u5e73\u5747\u503c\uff1a",a||(a=0),a+=k):"min"===e?(g=d.configText+"\u6700\u5c0f\u503c\uff1a",
a||(a=k),a=Math.min(k,a)):"max"===e&&(g=d.configText+"\u6700\u5927\u503c\uff1a",a||(a=k),a=Math.max(k,a))}"avg"===e&&(a/=f.length);try{Ext.isFunction(d.renderer)?Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u5f53\u524d\u9009\u4e2d\u7684\u6570\u636e\uff0c"+g+d.renderer(a)):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u5f53\u524d\u9009\u4e2d\u7684\u6570\u636e\uff0c"+g+a)}catch(l){Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u5f53\u524d\u9009\u4e2d\u7684\u6570\u636e\uff0c"+g+a)}}else g={entityCode:a.getStore().entity.entityCode,
field:d.dataIndex,type:e,storeId:a.getStore().getId()},c.Dialog.showWait("\u6b63\u5728\u8ba1\u7b97\u4e2d\u2026\u2026"),$.post("entity/compute",g,function(l){c.Dialog.hideWait();var n="";"sum"===e?n=d.configText+"\u603b\u548c\uff1a":"avg"===e?n=d.configText+"\u5e73\u5747\u503c\uff1a":"min"===e?n=d.configText+"\u6700\u5c0f\u503c\uff1a":"max"===e&&(n=d.configText+"\u6700\u5927\u503c\uff1a");try{Ext.isFunction(d.renderer)?Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",n+d.renderer(l.data)):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",
n+l.data)}catch(p){Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",n+l.data)}})}else Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u8ba1\u7b97\u5931\u8d25\uff01Grid\u7684DataStore\u672a\u7ed1\u5b9aEntity!");else Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u8ba1\u7b97\u5931\u8d25!\u8ba1\u7b97\u5217\u65e0\u6548\uff01")}catch(l){console.error(l)}};b.getColumnSimpleEditor=function(a,d){try{var e={};Ext.isObject(a.field)?e.xtype=a.field.xtype:Ext.isString(a.field)?e.xtype=a.field:e.xtype="textfield";Ext.isObject(a.config.field)&&
(e=d?c.Base.copy(a.config.field):a.config.field);if(d){if(c.Form.isContentField(a.field)||c.Form.isHtmlContentField(a.field)||c.Form.isTargetField(a.field)||c.Form.isFileField(a.field)||c.Form.isFilesField(a.field)||c.Form.isMonacoEditorField(a.field))e.xtype="textfield";c.Form.isPCAField(a.field)&&(e.selectType=1,0<=a.text.indexOf("\u7701")&&(e.level=1),0<=a.text.indexOf("\u5e02")&&(e.level=2),0<=a.text.indexOf("\u533a")&&(e.level=3))}Ext.isEmpty(e.xtype)&&(e.xtype="textfield");e.dataIndex=a.dataIndex;
d&&(e.columnSearchField=!0);return e}catch(f){console.error(f)}return null};b.getColumnSimpleEditorJson=function(a,d){return(a=c.Grid.getColumnSimpleEditor(a,d))?c.Json.objectToJsonUnsafe(a):null};b.showBatchEditColumn=function(a){var d=a.batchField;if(!d){if(Ext.isEmpty(a.configField)||Ext.isObject(a.configField)&&Ext.isEmpty(a.configField.xtype))return;d=Ext.create(a.configField);if(!d)return;d.flex=1;d.emptyText="\u8bf7\u8f93\u5165";a.batchField=d}var e=function(g){if(!Ext.isEmpty(g.getValue())){var h=
c.Grid.getColumnGrid(a),k=h.getStore();k&&(k.holdUpdate=!0,h=h.getSelectionModel().getSelection(),0<h.length?Ext.each(h,function(l,n){c.Store.setRecordValue(l,a.dataIndex,g)}):k.each(function(l,n){c.Store.setRecordValue(l,a.dataIndex,g)}),k.holdUpdate=!1,k.fireEvent("endupdate"))}},f="\u6279\u91cf\u4fee\u6539\u5f53\u524d\u9875\u7684\u3010"+a.configText+"\u3011\u6570\u636e";0<c.Grid.getColumnGrid(a).getSelection().length&&(f="\u6279\u91cf\u4fee\u6539\u9009\u62e9\u7684"+c.Grid.getColumnGrid(a).getSelection().length+
"\u6761\u3010"+a.configText+"\u3011\u6570\u636e");Ext.isFunction(d.setEmptyText)&&d.setEmptyText(f);d.editable=!0;Ext.isFunction(d.showWindow)?d.showWindow(a,function(g){e(g)},f):(a.batchEditMenu||(a.batchEditMenu=Ext.create("Ext.menu.Menu",{showSeparator:!1,scrollToHidden:!0,layout:"fit",shadow:!1,editorMenu:!0,modal:!0,doUpdate:function(){var g=this,h=g.items.get(0).items.get(0);if(h)if(h.isValid()){var k=this.down("button[name\x3d'confirm']");k.setText("\u7a0d\u7b49");k.setDisabled(!0);(new Ext.Promise(function(l,
n){e(h);h.setValue(null);l()})).then(function(){k.setText("\u786e\u5b9a");k.setDisabled(!1);g.hide()})}else c.Component.shakeComment(g),c.Dialog.toast(c.Form.getFieldError(h)[0])},items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},style:{background:"#ffffff",borderWidth:1,borderColor:"#ffffff",color:"#eeeee"},border:0,items:[d,{xtype:"button",text:"\u786e\u5b9a",name:"confirm",iconCls:"extIcon extOk",margin:"0 0 0 2",height:c.Form.getFieldMinHeight(!1),handler:function(){a.batchEditMenu.doUpdate()}}]}],
listeners:{show:function(g,h){g.items.get(0).items.get(0).focus()}}}),a.batchEditMenu.addCls("edit-menu"),a.batchEditMenu.addCls("edit-details-menu")),a.batchEditMenu.setWidth(Math.max(a.getWidth(),225)),a.batchEditMenu.showBy(a,"tl"))};b.showBatchUpdateColumn=function(a){var d=a.batchUpdateField;if(!d){d=Ext.create(a.configField);if(!d)return;d.flex=1;d.emptyText="\u8bf7\u8f93\u5165";a.batchUpdateField=d}d.editable=!0;var e=c.Grid.getColumnGrid(a).getStore(),f="\u6279\u91cf\u66f4\u65b0\u3010"+a.configText+
"\u3011\uff0c\u5f53\u524d\u6761\u4ef6\u4e0b\u5171"+e.getTotalCount()+"\u6761\u6570\u636e",g=function(l,n,p){c.Dialog.showWait("\u6b63\u5728\u66f4\u65b0\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");var q={entityCode:e.entity.entityCode,storeId:e.getId()};e.entity.menu&&(q.menu=c.Store.getStoreMenuText(e));q.field=n;q.fieldValue=p;c.Server.updateDBEntity(q,function(r,u){c.Dialog.hideWait();r?(c.Dialog.toast(u),e.reload(),l&&l.close()):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",u)})};if(Ext.isFunction(d.showWindow))d.showWindow(a,
function(l){c.Dialog.showConfirm("\u7cfb\u7edf\u63d0\u9192","\u5c06\u6279\u91cf\u66f4\u65b0\u6570\u636e\uff0c\u6b64\u66f4\u65b0\u662f\u6c38\u4e45\u6027\u4e14\u65e0\u6cd5\u64a4\u9500\uff01\u8bf7\u60a8\u786e\u8ba4\uff01",function(n){"yes"===n&&g(null,c.Entity.getRealAttr(a),l.getValue())})},f);else{d.columnWidth=1;d.dataField=!0;var h=Ext.create("Ext.form.FormPanel",{bodyPadding:5,region:"center",autoScroll:!0,border:0,defaults:{margin:"5 5 5 5"},layout:"column",items:[d,{xtype:"checkboxfield",columnWidth:1,
boxLabel:f+"\uff0c\u6211\u5df2\u4e86\u89e3\u6b64\u66f4\u65b0\u662f\u6c38\u4e45\u6027\u4e14\u65e0\u6cd5\u64a4\u9500",listeners:{change:function(l,n){k.down("#updateBtn").setDisabled(!n)}}}]}),k=Ext.create("Ext.window.Window",{title:"\u6279\u91cf\u66f4\u65b0\u6570\u636e",subtitle:"v3",iconCls:"extIcon extEdit",height:250,width:450,layout:"border",items:[h],modal:!0,constrain:!0,buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){k.close()}},{text:"\u7acb\u5373\u66f4\u65b0",
itemId:"updateBtn",disabled:!0,iconCls:"extIcon extOk whiteColor",handler:function(){var l=c.Entity.getRealAttr(a),n=h.down("[dataField\x3dtrue]");n&&g(k,l,n.getValue())}}]});k.show()}};b.showBatchReplaceColumn=function(a){var d=c.Grid.getColumnGrid(a).getStore(),e="\u6279\u91cf\u66ff\u6362\u3010"+a.configText+"\u3011\uff0c\u5f53\u524d\u6761\u4ef6\u4e0b\u5171"+d.getTotalCount()+"\u6761\u6570\u636e",f=Ext.create("Ext.form.FormPanel",{bodyPadding:5,region:"center",autoScroll:!0,defaults:{margin:"5 5 5 5",
labelWidth:80,labelAlign:"right"},layout:"column",items:[{name:"replace",xtype:"textfield",fieldLabel:"\u66ff\u6362\u7684\u5b57\u7b26",columnWidth:1,allowBlank:!1},{name:"toValue",xtype:"textfield",fieldLabel:"\u65b0\u7684\u5b57\u7b26",columnWidth:1,allowBlank:!1},{xtype:"checkboxfield",columnWidth:1,boxLabel:e+"\uff0c\u6211\u5df2\u4e86\u89e3\u6b64\u66f4\u65b0\u662f\u6c38\u4e45\u6027\u4e14\u65e0\u6cd5\u64a4\u9500",listeners:{change:function(h,k){g.down("#updateBtn").setDisabled(!k)}}}]}),g=Ext.create("Ext.window.Window",
{title:"\u6279\u91cf\u66ff\u6362\u6570\u636e",iconCls:"extIcon extEdit",width:450,height:260,layout:"border",items:[f],modal:!0,constrain:!0,doUpdate:function(h){var k=this;c.Dialog.showWait("\u6b63\u5728\u66ff\u6362\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");h.entityCode=d.entity.entityCode;h.storeId=d.getId();d.entity.menu&&(h.menu=c.Store.getStoreMenuText(d));h.field=c.Entity.getRealAttr(a);c.Server.replaceDBEntity(h,function(l,n){c.Dialog.hideWait();l?(c.Dialog.toast(n),d.reload(),k.close()):
c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",n)})},buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){g.close()}},{text:"\u7acb\u5373\u66ff\u6362",itemId:"updateBtn",disabled:!0,iconCls:"extIcon extOk whiteColor",handler:function(){g.doUpdate(f.getValues())}}]});g.show()};b.showBatchEditColumnRandom=function(a){if(Ext.isFunction(window.showRandomData))window.showRandomData(a);else{var d="Random"+Ext.now(),e=1,f=!1,g="Y-m-d H:i:s",h=c.Grid.getColumnGrid(a).getStore().getTotalCount(),
k="\u6279\u91cf\u968f\u673a\u751f\u6210\u5f53\u524d\u9875\u7684\u3010"+a.configText+"\u3011\u5217\u6570\u636e";0<c.Grid.getColumnGrid(a).getSelection().length&&(k="\u6279\u91cf\u968f\u673a\u751f\u6210\u9009\u62e9\u7684"+c.Grid.getColumnGrid(a).getSelection().length+"\u6761\u3010"+a.configText+"\u3011\u5217\u6570\u636e",h=c.Grid.getColumnGrid(a).getSelection().length);if(c.Grid.isNumberColumn(a))e=2,f=!0;else if(c.Grid.isDateColumn(a))e=3,Ext.isObject(a.field)&&(g=a.field.format),f=!0;else if(c.Grid.isEnumColumn(a)||
c.Grid.isComboColumn(a)){e=5;f=!0;var l=[],n=Ext.create(a.field);n.getStore().each(function(x,y){l.push(x.get(n.valueField))});var p=l.join(",")}else c.Grid.isContentColumn(a)&&(e=4);var q={xtype:"fieldcontainer",layout:"column",columnWidth:1,id:d+"_1",defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},random:function(){var x=[],y=Ext.getCmp(d+"_textPrefix").getValue(),A=Ext.getCmp(d+"_textStartNumber").getValue();for(A=parseInt(A);A<Number.MAX_VALUE&&
(x.push(y+A),x.length!==h);A++);return x},items:[{xtype:"fieldset",columnWidth:1,layout:"column",defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},title:"\u6587\u5b57\u8bbe\u7f6e",items:[{fieldLabel:"\u6587\u5b57\u524d\u7f00",id:d+"_textPrefix",allowBlank:!1,xtype:"textfield"},{fieldLabel:"\u5f00\u59cb\u5e8f\u6570",id:d+"_textStartNumber",value:1,allowBlank:!1,xtype:"numberfield"}]}]},r={xtype:"fieldcontainer",layout:"column",columnWidth:1,id:d+
"_2",hidden:!0,disabled:!0,defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},random:function(){var x=[],y=Ext.getCmp(d+"_dotNumber").getValue(),A=Ext.getCmp(d+"_minNumber").getValue(),B=Ext.getCmp(d+"_maxNumber").getValue();if(A>B)c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u6700\u5927\u6570\u5b57\u5fc5\u987b\u5927\u4e8e\u6700\u5c0f\u6570\u5b57\uff01");else{for(var D=0;D<Number.MAX_VALUE&&(x.push((Math.random()*(B-A)+A).toFixed(y)),x.length!==
h);D++);return x}},items:[{xtype:"fieldset",columnWidth:1,layout:"column",defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},title:"\u6570\u5b57\u8bbe\u7f6e",items:[{fieldLabel:"\u4fdd\u7559\u4f4d\u6570",id:d+"_dotNumber",value:0,allowBlank:!1,xtype:"numberfield"},{fieldLabel:"\u6700\u5c0f\u6570\u5b57",id:d+"_minNumber",value:0,allowBlank:!1,xtype:"numberfield"},{fieldLabel:"\u6700\u5927\u6570\u5b57",id:d+"_maxNumber",allowBlank:!1,xtype:"numberfield"}]}]};
g={xtype:"fieldcontainer",layout:"column",columnWidth:1,id:d+"_3",hidden:!0,disabled:!0,defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},random:function(){var x=[],y=Ext.getCmp(d+"_minDate").getValue();y=Ext.Date.parse(y,c.Base.guessDateFormat(y));var A=Ext.getCmp(d+"_maxDate").getValue();A=Ext.Date.parse(A,c.Base.guessDateFormat(A));if(y.getTime()>A.getTime())c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u6700\u5927\u65e5\u671f\u5fc5\u987b\u5927\u4e8e\u6700\u5c0f\u65e5\u671f\uff01");
else{for(var B=0;B<Number.MAX_VALUE;B++){var D=A.getTime()-y.getTime();D=Math.random()*D+y.getTime();x.push(Ext.Date.format(new Date(D),Ext.getCmp(d+"_minDate").format));if(x.length===h)break}return x}},items:[{xtype:"fieldset",columnWidth:1,layout:"column",defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},title:"\u65e5\u671f\u8bbe\u7f6e",items:[{fieldLabel:"\u6700\u5c0f\u65e5\u671f",xtype:"datefield",id:d+"_minDate",allowBlank:!1,format:g},
{fieldLabel:"\u6700\u5927\u65e5\u671f",xtype:"datefield",id:d+"_maxDate",allowBlank:!1,format:g}]}]};var u={xtype:"fieldcontainer",layout:"column",columnWidth:1,id:d+"_4",hidden:!0,disabled:!0,defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},random:function(){var x=[],y=Ext.getCmp(d+"_minLength").getValue(),A=Ext.getCmp(d+"_maxLength").getValue(),B=Ext.getCmp(d+"_longTextList").getValue();if(y>A)c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",
"\u6700\u5927\u957f\u5ea6\u5fc5\u987b\u5927\u4e8e\u6700\u5c0f\u957f\u5ea6\uff01");else{B=B.toString().trimAllSymbol().split("");for(var D=0;D<Number.MAX_VALUE;D++){for(var G=c.Base.randomInt(y,A),C=[],E=0;E<Number.MAX_VALUE;E++){var F=c.Base.randomInt(0,B.length-1);C.push(B[F]);if(C.length===G)break}x.push(C.join(""));if(x.length===h)break}return x}},items:[{xtype:"fieldset",columnWidth:1,layout:"column",defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},
title:"\u6587\u5b57\u8bbe\u7f6e",items:[{fieldLabel:"\u6587\u5b57\u5e93",id:d+"_longTextList",allowBlank:!1,xtype:"textfield",listeners:{change:function(x,y,A,B){Ext.getCmp(d+"_maxLength").setValue(y.truthLength())}}},{fieldLabel:"\u6700\u5c0f\u957f\u5ea6",id:d+"_minLength",value:1,minValue:1,allowBlank:!1,xtype:"numberfield"},{fieldLabel:"\u6700\u5927\u957f\u5ea6",id:d+"_maxLength",allowBlank:!1,minValue:1,xtype:"numberfield"}]}]};p={xtype:"fieldcontainer",layout:"column",columnWidth:1,id:d+"_5",
hidden:!0,disabled:!0,defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},random:function(){for(var x=[],y=Ext.getCmp(d+"_numberList").getValue().toString().split(","),A=0;A<Number.MAX_VALUE;A++){var B=y[c.Base.randomInt(0,y.length-1)];if(!Ext.isEmpty(B)&&(x.push(B),x.length===h))break}return x},items:[{xtype:"fieldset",columnWidth:1,layout:"column",defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},
title:"\u6570\u5b57\u96c6\u5408\u8bbe\u7f6e",items:[{fieldLabel:"\u6570\u5b57\u96c6\u5408",id:d+"_numberList",allowBlank:!1,value:p,xtype:"textfield"},{xtype:"displayfield",value:"\u4ee5\u82f1\u6587\u9017\u53f7\uff08,\uff09\u4e3a\u5206\u9694\u7b26\uff01"}]}]};var t=Ext.create("Ext.form.Panel",{bodyPadding:5,region:"center",autoScroll:!0,layout:"column",defaults:{labelWidth:60,margin:"5 5 5 5",labelAlign:"right",columnWidth:1,emptyText:"\u8bf7\u586b\u5199"},items:[{xtype:"combo",name:"autoType",fieldLabel:"\u968f\u673a\u7c7b\u578b",
editable:!1,displayField:"text",valueField:"id",value:1,listeners:{change:function(x,y,A,B){Ext.getCmp(d+"_"+A).setHidden(!0);Ext.getCmp(d+"_"+A).setDisabled(!0);Ext.getCmp(d+"_"+y).setHidden(!1);Ext.getCmp(d+"_"+y).setDisabled(!1)}},store:Ext.create("Ext.data.Store",{fields:["id","text"],data:[{text:"\u6587\u672c",id:1},{text:"\u957f\u6587\u672c",id:4},{text:"\u6570\u5b57",id:2},{text:"\u6570\u5b57\u96c6\u5408",id:5},{text:"\u65e5\u671f",id:3}]})},q,r,g,u,p]}),w=function(x){var y=c.Grid.getColumnGrid(a),
A=y.getStore();0!==x.length&&A&&(A.holdUpdate=!0,y=y.getSelectionModel().getSelection(),0<y.length?Ext.each(y,function(B,D){Ext.isObject(x[D])?c.Store.setRecordValue(B,a.dataIndex,x[D]):B.set(a.dataIndex,x[D])}):A.each(function(B,D){Ext.isObject(x[D])?c.Store.setRecordValue(B,a.dataIndex,x[D]):B.set(a.dataIndex,x[D])}),A.holdUpdate=!1,A.fireEvent("endupdate"))},z=Ext.create("Ext.window.Window",{title:k,height:360,iconCls:"extIcon extRandom",width:450,layout:"border",items:[t],modal:!0,constrain:!0,
listeners:{show:function(){var x=t.getField("autoType");x.setValue(e);x.setReadOnly(f)}},buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){z.close()}},{text:"\u7acb\u5373\u751f\u6210",iconCls:"extIcon extOk whiteColor",handler:function(){if(t.getForm().isValid()){var x=t.getFieldValue("autoType");(x=Ext.getCmp(d+"_"+x).random())&&0!==x.length&&(w(x),z.close())}}}]});z.show()}};b.configColumnSearchLink=function(a){var d="";a.searchLink&&(d=a.searchLink.checked);c.System.showMenuColumns(a,
d).then(function(e){0<e.columns.length?(a.searchLink=e,c.Dialog.toast("\u914d\u7f6e\u6210\u529f\uff01")):(a.searchLink=null,c.Dialog.toast("\u5df2\u6e05\u7a7a\u641c\u7d22\u94fe\uff01"))})};b.refreshColumnStyle=function(a){try{if(!Ext.isEmpty(a.dataIndex)){var d=a.sortDirection;d=Ext.isEmpty(d)?"\x3cfont size\x3d'1'\x3e\x3c/font\x3e":"ASC"===d?"\x3cfont color\x3d'red' size\x3d'1'\x3e\x26nbsp;\x26nbsp;[\u6b63\u5e8f]\x3c/font\x3e":"\x3cfont color\x3d'red' size\x3d'1'\x3e\x26nbsp;\x26nbsp;[\u5012\u5e8f]\x3c/font\x3e";
Ext.isEmpty(a.sumText)&&(a.sumText="\x3cfont size\x3d'1'\x3e\x3c/font\x3e");a.searching?(a.setText(c.Base.getSVGIcon("extSearch")+"\x26nbsp;"+a.configText+a.sumText+d+"\x26nbsp;"),a.setStyle("color","red")):(a.setText("\x26nbsp;"+a.configText+a.sumText+d+"\x26nbsp;"),a.setStyle("color","#000000"));c.Grid.checkColumnSort(c.Grid.getColumnGrid(a))}}catch(e){console.error(e)}};b.checkColumnSort=function(a){try{var d=0<a.getStore().getSorters().length,e=a.child("#pagingToolBar");if(e){var f=e.down("button[toolType\x3dsortBtn]");
d?(f.setIconCls("extIcon extSort redColor"),f.setUserCls("redBorder")):(f.setIconCls("extIcon extSort grayColor"),f.setUserCls(""))}}catch(g){console.error(g)}};b.checkHistoryConfig=function(a){var d=a.child("#pagingToolBar");d&&(d=d.down("button[toolType\x3dselectHistoryBtn]"))&&(1===parseInt(a.selectHistoryConfig.state)?(d.setIconCls(d.baseIconCls+" redColor"),d.setUserCls("redBorder")):(d.setIconCls(d.baseIconCls+" grayColor"),d.setUserCls("")))};b.configColumnProperty=function(a){try{a.configText=
a.text,a.toSearchKey=function(d,e){return"colWhere['@"+this.getIndex()+c.Base.toString(d.link,"\x26")+this.dataIndex+d.compare+":index"+e+"']"},a.containsSearchWhere=function(d){this.where||(this.where=[]);for(var e=0,f=this.where;e<f.length;e++){var g=f[e];if(g.link===d.link&&g.compare===d.compare&&g.value===d.value)return!0}return!1},a.searchValue=function(d){this.where||(this.where=[]);d={link:"\x26",compare:"\x3d",value:d};this.containsSearchWhere(d)||(this.where.push(d),this.doSearch())},a.getRenderCacheKey=
function(){return $.md5(c.Grid.getColumnGrid(this).code+"-"+this.dataIndex+"-render")},a.clearSearch=function(){var d=c.Grid.getColumnGrid(this).getStore().proxy.extraParams;if(this.where){var e=[],f;for(f in d)0<=f.indexOf("colWhere")&&0<=f.indexOf(this.dataIndex)&&e.push(f);for(f=0;f<e.length;f++)delete d[e[f]]}this.where=[];this.searchMenu=null;this.searching=!1;c.Grid.refreshColumnStyle(this)},a.doSearch=function(d){var e=c.Grid.getColumnGrid(this).getStore().proxy.extraParams;if(this.where){for(var f=
!1,g=0;g<this.where.length;g++){var h=this.where[g],k=this.toSearchKey(h,g),l=h.value;0<=h.compare.indexOf("?")&&(l="%"+h.value+"%");"??"===h.compare&&(l=h.value,f=!0);e[k]=l}f&&(c.Grid.clearColumnSort(c.Grid.getColumnGrid(this)),c.Grid.checkColumnSort(c.Grid.getColumnGrid(this)));e["colWhere['^"+this.dataIndex+"@SearchExclude']"]=this.searchExclude;c.Base.toBool(d,!0)&&c.Grid.getColumnGrid(this).getStore().loadPage(1);this.searching=0!==this.where.length;c.Grid.refreshColumnStyle(this)}},a.setAlignContent=
function(d){var e=this.getId();e=$("[data-columnid\x3d"+e+"]");for(var f=0;f<e.length;f++)$(e[f]).children().css("text-align",d);this.align=d;c.Grid.getColumnGrid(this).saveUIConfig(!0)},a.where&&0<a.where.length&&a.doSearch(!1),a.groupHeaderText=a.isSubHeader?a.ownerCt.text:null,Ext.isEmpty(a.field)&&(a.editable=!1)}catch(d){console.error(d)}};b.configColumnListener=function(a){};b.buildSearchItem=function(a,d){try{var e=!1,f=c.Grid.getColumnGrid(a);f&&f.getStore()&&f.getStore().entity&&(e=c.Entity.isFulltextColumn(f.getStore().entity.entityCode,
a.dataIndex));var g=c.Grid.getColumnSimpleEditor(a,!0);if(!g)return;g.fromHeadSearch=!0;g.validator=null;g.flex=1;g.margin="2 2 0 0";g.repeatTriggerClick=!1;g.onClearValue=function(){var k=this.up("container");Ext.isFunction(k.removeSearch)?k.removeSearch():k.destroy()};g.triggers={close:{cls:"text-clear",hideOnReadOnly:!1,handler:function(){this.onClearValue()}}};c.Form.isEnumField(g)?g.editable=!1:g.editable=!0;g.emptyText="\u8bf7\u8f93\u5165\u6761\u4ef6\u503c";if(!d){d={link:"\x26",compare:"\x3d",
value:""};if(c.Form.isTextField(g)||c.Form.isLinkField(g)||c.Form.isMapField(g)||c.Form.isHtmlContentField(g)||c.Form.isContentField(g))d.compare="?";e&&(d.compare="??");c.Form.isDateField(g)&&(d.compare="\x3e\x3d")}var h={full:e,date:c.Form.isDateField(g)};g.value=d.value;g.submitValue=!1;g.name="value";g.itemId="editorField";g.strict=0<=d.compare.indexOf("\x3e")||0<=d.compare.indexOf("\x3c")||0<=d.compare.indexOf("\x3d");return{xtype:"container",margin:"0",searchItem:!0,border:0,flex:1,region:"center",
layout:{type:"hbox",align:"stretch"},toParam:function(){var k={};this.items.each(function(l){if(Ext.isFunction(l.getValue))if(l.isValid())Ext.isDate(l.getValue())?k[l.getName()]=Ext.Date.format(l.getValue(),l.format):k[l.getName()]=l.getValue();else return c.Component.shakeComment(l),c.Dialog.toast(c.Form.getFieldError(l)[0]),k=null,!1});return k},setParam:function(k){this.items.each(function(l){Ext.isFunction(l.getValue)&&("compare"===l.getName()?l.setValue(k.compare):"link"===l.getName()?l.setValue(k.link):
l.setValue(k.value))})},refreshField:function(){var k=this.getComponent("compare").getValue(),l=this.getComponent("editorField");if(l&&l.rendered)if(Ext.isFunction(l.setReadOnlyAttr)&&l.setReadOnlyAttr(!1),"~"==k||"!~"==k)l.setValue("\x3cNULL\x3e"),Ext.isFunction(l.setReadOnlyAttr)&&l.setReadOnlyAttr(!0);else if("#"==k||"!#"==k)l.setValue("\x3cREPEAT\x3e"),Ext.isFunction(l.setReadOnlyAttr)&&l.setReadOnlyAttr(!0)},items:[{xtype:"combo",name:"link",value:c.Base.toString(d.link,"\x26"),margin:"2 2 0 2",
width:35,valueField:"text",editable:!1,hideTrigger:!0,tpl:Ext.create("Ext.XTemplate",'\x3cul class\x3d"x-list-plain"\x3e\x3ctpl for\x3d"."\x3e','\x3cli role\x3d"option" class\x3d"x-boundlist-item" style\x3d"font-size: 12px;"\x3e{desc}\x3c/li\x3e',"\x3c/tpl\x3e\x3c/ul\x3e"),listeners:{afterrender:function(k,l){k.getPicker().setMinWidth(100)}},store:c.Store.getCompareLinkDataStore()},{xtype:"combo",name:"compare",value:d.compare,itemId:"compare",margin:"2 2 0 2",width:65,valueField:"text",displayField:"desc",
editable:!1,hideTrigger:!0,tpl:Ext.create("Ext.XTemplate",'\x3cul class\x3d"x-list-plain"\x3e\x3ctpl for\x3d"."\x3e','\x3cli role\x3d"option" class\x3d"x-boundlist-item" style\x3d"font-size: 12px;"\x3e{desc}\x3c/li\x3e',"\x3c/tpl\x3e\x3c/ul\x3e"),listeners:{afterrender:function(k,l){k.getPicker().setMinWidth(100)},change:function(k,l,n){var p=k.ownerCt.getComponent("editorField");"~"!=n&&"!~"!=n&&"#"!=n&&"!#"!=n||p.setValue(null);0<=l.indexOf("\x3e")||0<=l.indexOf("\x3c")||0<=l.indexOf("\x3d")?p.strict=
!0:p.strict=!1;k.ownerCt.refreshField()}},store:c.Store.getCompareDataStore(h)},g],listeners:{afterrender:function(k,l){k.refreshField()}}}}catch(k){console.error(k)}return null};b.canColumnSearch=function(a){c.Grid.getColumnGrid(a);return c.Base.toBool(c.Grid.getColumnGrid(a).columnSearch,!0)?c.Grid.isFilesColumn(a)||c.Grid.isFileColumn(a)?c.Base.toBool(a.search,!1):!c.Base.toBool(a.search,!0)||c.Base.toBool(a.encrypt,!1)?!1:!0:!1};b.showColumnSearchMenu=function(a){try{if(!c.Grid.canColumnSearch(a))return!1;
if(!a.searchMenu){a.searchMenu=Ext.create("Ext.menu.Menu",{padding:"0 0 0 0",power:!1,showSeparator:!1,columnSearchMenu:!0,editorMenu:!0,scrollToHidden:!0,style:{background:"#ffffff"},fixedItemCount:2,addSearchItem:function(f){var g=this.items.length-this.fixedItemCount;5<=g||this.insert(g,c.Grid.buildSearchItem(a,f))},doSearch:function(){var f=[];this.items.each(function(g,h){if(g.searchItem){g=g.toParam();if(!g)return f=null,!1;Ext.isEmpty(g.value)||(g.index=h,f.push(g))}});f&&(a.clearSearch(),
a.where=f,a.doSearch(),this.hide())},items:[{xtype:"container",layout:"fit",margin:"5",border:0,hidden:!0,itemId:"configSearch",items:[{xtype:"fieldset",title:"\u914d\u7f6e\u641c\u7d22\u5ffd\u7565\u7684\u5b57\u7b26",layout:"column",margin:"0",items:[{xtype:"textfield",labelAlign:"right",columnWidth:1,itemId:"searchExclude",value:a.searchExclude,name:"searchExclude",emptyText:"\u8bf7\u8f93\u5165\u5b57\u7b26",listeners:{change:function(f,g,h,k){a.searchExclude=g}}}]}]},{xtype:"container",layout:{type:"hbox",
align:"stretch"},margin:"2",border:0,items:[{xtype:"button",iconCls:"extIcon extSet fontSize14",contextMenu:!1,width:35,handler:function(){var f=this.ownerCt.ownerCt.getComponent("configSearch");f.setHidden(!f.isHidden())}},{xtype:"button",text:"\u641c\u7d22",flex:1,contextMenu:!1,iconCls:"extIcon extSearch",margin:"0 2 0 2",handler:function(){this.ownerCt.ownerCt.doSearch();c.Grid.saveGridColumn(c.Grid.getColumnGrid(a))}},{xtype:"button",iconCls:"extIcon extPlus fontSize14",width:35,contextMenu:!1,
handler:function(){this.ownerCt.ownerCt.addSearchItem()}}]}],listeners:{show:function(f,g){a.addCls("x-column-header-open");f.items.length===f.fixedItemCount&&f.addSearchItem();(g=f.down("#searchExclude"))&&g.setValue(a.searchExclude);try{new Ext.util.KeyMap({target:f.getEl(),key:13,fn:function(h,k){f.doSearch()},scope:f})}catch(h){console.error(h)}},hide:function(f,g){a.removeCls("x-column-header-open")}}});a.searchMenu.addCls("header-search-menu");var d=c.Grid.getColumnGrid(a);d&&d.add(a.searchMenu)}if(a.where)for(d=
0;d<a.where.length;d++){var e=a.where[d];Ext.isEmpty(e.index)&&(e.index=d);e.index<a.searchMenu.items.length-a.searchMenu.fixedItemCount?a.searchMenu.items.getAt(e.index).setParam(e):a.searchMenu.addSearchItem(e)}a.searchMenu.setWidth(Math.max(parseInt(a.getWidth()),300));a.searchMenu.showBy(a,"tl-bl?");return!0}catch(f){console.error(f)}return!1};b.showColumnSearchWin=function(a,d){if(a.searchWin)c.Component.shakeComment(a.searchWin);else{var e=c.Store.getGridColumnStore(d,!0),f=function(k,l){l=
c.Grid.buildSearchItem(c.Grid.getColumn(d,k.get("id"),k.get("text")),l);l.removeSearch=function(){var n=this.up("container");n&&n.destroy()};return{xtype:"container",flex:1,columnWidth:1,layout:"hbox",margin:"0 0 2 0",border:0,toParam:function(){var n={},p=this.items.get(0);p=p.getStore().findRecord("id",p.getValue(),0,!1,!1,!0);n.text=p.get("text");n.dataIndex=p.get("id");p=this.items.get(1);return n=c.Json.mergeJson(n,p.toParam())},items:[{xtype:"combo",region:"west",valueField:"id",displayField:"text",
flex:.4,margin:"2 0 0 2",value:k.get("id"),editable:!1,listeners:{change:function(n,p,q,r){q=this.up("container");q.remove(q.items.get(1),!0);n=n.getStore().findRecord("id",p,0,!1,!1,!0);n=c.Grid.buildSearchItem(c.Grid.getColumn(d,n.get("id"),n.get("text")));n.removeSearch=function(){var u=this.up("container");u&&u.destroy()};q.insert(1,n)}},store:e},l]}},g=d.searchItems;g||(g=[]);var h=Ext.create("Ext.form.FormPanel",{margin:"5",border:0,layout:"column",width:460,scrollable:!0,defaults:{labelWidth:80,
margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},items:g});g=c.Grid.getGridInWindowSize(d);a.searchWin=Ext.create("Ext.window.Window",{title:"\u641c\u7d22\u6570\u636e",layout:"fit",constrain:!0,iconCls:"extIcon extSearch",resizable:!0,minHeight:200,minWidth:400,height:g.height,width:g.width,animateTarget:a,items:[h],refreshSearchItem:function(k){if(e&&d){h.removeAll();for(var l=d.getColumns(),n=0;n<l.length;n++){var p=l[n];if(p.where){var q=e.findRecord("id",p.dataIndex,0,!1,!1,
!0);if(q)for(var r=0;r<p.where.length;r++)h.add(f(q,p.where[r]))}}0===h.items.length&&0<e.getCount()&&k&&h.add(f(e.getAt(0)))}},listeners:{close:function(k,l){a.searchWin.gridLoad&&a.searchWin.gridLoad.destroy();e&&e.destroy();a.searchWin=null}},buttons:[{text:"\u6e05\u7a7a\u6761\u4ef6",iconCls:"extIcon extClear whiteColor",handler:function(){h.removeAll();d&&(Ext.each(d.getColumns(),function(k){k.clearSearch()}),d.getStore().loadPage(1))}},"-\x3e",{text:"\u6dfb\u52a0\u6761\u4ef6",iconCls:"extIcon extPlus",
handler:function(){h.add(f(e.getAt(0)));h.scrollTo(0,35*h.items.length+105,!1)}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){if(d){Ext.each(d.getColumns(),function(l){l.clearSearch()});var k=[];h.items.each(function(l){if(l.toParam){if((l=l.toParam())&&!Ext.isEmpty(l.value)){var n=c.Grid.getColumn(d,l.dataIndex,l.text);if(!n)return!1;n.where||(n.where=[]);delete l.dataIndex;delete l.text;n.where.push(l);k.push(n)}}else n={},n["where['"+l.name+"']"]=l.getValue(),Ext.apply(d.getStore().proxy.extraParams,
n)});Ext.each(k,function(l){l.doSearch(!1)});d.getStore().loadPage(1)}}}]});a.searchWin.gridLoad=d.on("load",function(){try{a.searchWin.refreshSearchItem(!1)}catch(k){console.error(k)}},this,{destroyable:!0});a.searchWin.refreshSearchItem(!0);d.ownerCt.add(a.searchWin)}a.searchWin.show()};b.getPageToolBar=function(a){var d=!1;a.entity&&c.Base.toBool(a.entity.recycle,!1)&&(d=!0);var e=!1;a.where&&c.Base.toBool(a.where["^fromRecycle"],!1)&&(e=!0);var f=c.Store.getStoreMenuText(a),g=Ext.create("Ext.toolbar.Paging",
{store:a,dock:"bottom",itemId:"pagingToolBar",pageSize:a.pageSize,displayInfo:!0,overflowHandler:"scroller"}),h={xtype:"combo",pageTool:!0,displayField:"text",valueField:"id",editable:!1,width:100,value:Math.min(a.pageSize,c.Store.maxPageSize),store:c.Store.getPageDataStore(),listeners:{change:function(q,r,u){c.System.silenceGlobalSave||null==r||0==r||(q.getStore().getById(r)?(-1===r?(this.ownerCt.pageSize=a.getTotalCount(),a.pageSize=a.getTotalCount(),Ext.isEmpty(q.totalCount)||(this.ownerCt.pageSize=
q.totalCount,a.pageSize=q.totalCount)):(this.ownerCt.pageSize=r,a.pageSize=r),a.loadPage(1),a.grid&&a.grid.saveUIConfig(!0)):(q.totalCount=r,q.setValue(-1)))}}},k={xtype:"button",tooltip:"\u62f7\u8d1d\u6570\u636e",subtext:"\u62f7\u8d1d\u6570\u636e@"+f,checkSelect:2,iconCls:"extIcon extCopy2 grayColor",checkAddPower:!0,checkCopyPower:!0,handler:function(){var q=a.grid.getSelection();0===q.length?c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u8bf7\u9009\u62e9\u9700\u8981\u590d\u5236\u7684\u6570\u636e\uff01"):
Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u60a8\u786e\u5b9a\u590d\u5236\u9009\u4e2d\u7684"+q.length+"\u6761\u6570\u636e\u5417\uff1f",function(r,u){"yes"===r&&(c.Dialog.showWait("\u6b63\u5728\u590d\u5236\u6570\u636e\u4e2d\u2026\u2026"),c.Store.commitStoreCopy(a.grid.getStore(),q).then(function(t){t&&(a.grid.getSelectionModel().deselectAll(),a.grid.getStore().isGrouped()&&c.Grid.getGridView(a.grid).getFeature("group").collapseAll(),c.Dialog.hideWait())}))})}};f={xtype:"button",tooltip:"\u6e05\u7a7a\u6570\u636e",
subtext:"\u6e05\u7a7a\u6570\u636e@"+f,checkDeleteAllPower:!0,checkDeletePower:!0,iconCls:"extIcon extClear grayColor",handler:function(){var q=c.Store.getStoreMenuText(a.grid.getStore()),r=function(){c.System.validOperate("\u6e05\u7a7a\u3010"+q+"\u3011\u6570\u636e",function(){c.Dialog.showWait("\u6b63\u5728\u6e05\u7a7a\u6570\u636e\u4e2d\u2026\u2026");var w={entityCode:a.entity.entityCode,all:!0,storeId:a.getId()};a.grid.getStore().entity.menu&&(w.menu=c.Store.getStoreMenuText(a.grid.getStore()));
c.Server.deleteEntity(w,function(z,x){c.Dialog.hideWait();z&&a.loadPage(1);c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",x)})},30)},u=Ext.create("Ext.form.FormPanel",{bodyPadding:10,method:"POST",region:"center",layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"5 5 5 5"},border:0,items:[{xtype:"lottie",width:150,height:120,jsonPath:"base/lottie/amazed.json"},{xtype:"label",text:"\u3010\u3010 \u8bf7\u60a8\u8c28\u614e\u64cd\u4f5c \u3011\u3011"},{xtype:"label",text:"\u60a8\u786e\u5b9a\u6e05\u7a7a\u5f53\u524d\u6761\u4ef6\u4e0b\u7684"+
a.getTotalCount()+"\u6761\u6570\u636e\u5417\uff1f"},{xtype:"label",text:"\u5f53\u524d\u64cd\u4f5c\u9875\u9762\u300a"+q+"\u300b"},{xtype:"checkboxfield",boxLabel:"\u6211\u5df2\u4e86\u89e3\u6b64\u64cd\u4f5c\u662f\u6c38\u4e45\u6027\u4e14\u65e0\u6cd5\u64a4\u9500",listeners:{change:function(w,z){t.down("#deleteBtn").setDisabled(!z)}}}]}),t=Ext.create("Ext.window.Window",{title:"\u6e05\u7a7a\u6570\u636e",iconCls:"extIcon extClear",layout:{type:"vbox",pack:"center",align:"middle"},constrain:!0,resizable:!1,
cls:"redAlert",items:[u],modal:!0,buttons:["-\x3e",{text:"\u53d6\u6d88",iconCls:"extIcon extClose",handler:function(){t.close()}},{text:"\u6e05\u7a7a",itemId:"deleteBtn",disabled:!0,iconCls:"extIcon extOk",handler:function(){r();t.close()}},"-\x3e"],listeners:{show:function(w){c.Component.shakeComment(w)}}});t.show()}};e&&(f.tooltip="\u6e05\u7a7a\u56de\u6536\u7ad9");var l={xtype:"button",tooltip:"\u56de\u6536\u7ad9",iconCls:"extIcon extRecycle grayColor",handler:function(){c.Grid.showRecycleGrid(this,
a)}},n={xtype:"button",toolType:"timerBtn",tooltip:"\u5b9a\u65f6\u5237\u65b0",iconCls:"extIcon extAlarm grayColor",baseIconCls:"extIcon extAlarm",handler:function(){c.Grid.showTimerRefreshGrid(this,a.grid)}},p={xtype:"button",toolType:"reportBtn",tooltip:"\u56fe\u8868\u67e5\u770b",iconCls:"extIcon extReport grayColor",handler:function(){c.Grid.showEChartConfigWin(this,a.grid)}};g.insert(0,h);g.insert(0,{xtype:"label",text:"\u6bcf\u9875",margin:"0 10 0 10"});h=g.child("#refresh");h=g.items.indexOf(h);
a.entity&&c.Base.toBool(a.entity.actionTimer,!0)&&g.insert(++h,n);g.insert(++h,"-");g.insert(++h,{xtype:"button",toolType:"searchBtn",tooltip:"\u641c\u7d22\u6570\u636e",iconCls:"extIcon extSearch grayColor",handler:function(){c.Grid.showColumnSearchWin(this,a.grid)}});g.insert(++h,{xtype:"button",toolType:"sortBtn",tooltip:"\u6392\u5e8f\u6570\u636e",iconCls:"extIcon extSort grayColor",handler:function(){c.Grid.showColumnSortWin(this,a.grid)}});g.insert(++h,{xtype:"button",toolType:"selectHistoryBtn",
tooltip:"\u6570\u636e\u9009\u62e9\u5668",iconCls:"extIcon extSelect grayColor",baseIconCls:"extIcon extSelect",handler:function(){c.Grid.showSelectRecordHistory(this,a.grid)}});e&&(g.insert(++h,"-"),g.insert(++h,{xtype:"button",tooltip:"\u8fd8\u539f\u6570\u636e",checkSelect:2,iconCls:"extIcon extReback grayColor",handler:function(){c.Grid.rebackGridData(a.grid)}}));g.insert(++h,"-");e||a.entity&&c.Base.toBool(a.entity.actionCopy,!0)&&g.insert(++h,k);a.entity&&c.Base.toBool(a.entity.actionDeleteAll,
!0)&&c.System.isSuperRole()&&g.insert(++h,f);a.entity&&!Ext.isEmpty(a.entity.echartsDate)&&(g.insert(++h,"-"),g.insert(++h,p));!e&&d&&(g.insert(++h,"-"),g.insert(++h,l));return g};b.showRecycleGrid=function(a,d){if(d){var e="\u56de\u6536\u7ad9";d.entity.menu&&(e=d.entity.menu.text+"-\u56de\u6536\u7ad9");var f=eval("new "+d.entity.entityCode+"()");f.menu={id:$.md5(e),text:e};f=f.getList(c.Json.mergeJson({"^fromRecycle":!0},d.where));f.down("[entityList\x3dtrue]").code=$.md5(d.entity.entityCode+"\u56de\u6536\u7ad9");
d=parseInt((.7*document.body.clientWidth).toFixed(0));var g=parseInt((.8*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:e,iconCls:"extIcon extRecycle",layout:"fit",height:g,width:d,minHeight:500,minWidth:600,constrain:!0,resizable:!0,modal:!0,maximizable:!0,animateTarget:a,maximized:!1,items:[f]}).show()}};b.rebackGridData=function(a){return new Ext.Promise(function(d,e){if(a.getStore().entity)if(0===a.getSelection().length)c.Dialog.toast("\u8bf7\u60a8\u5148\u9009\u62e9\u9700\u8981\u8fd8\u539f\u7684\u6570\u636e\uff01");
else{e=a.getSelection().length;var f=function(){c.Dialog.showWait("\u6b63\u5728\u8fd8\u539f\u6570\u636e\u4e2d\u2026\u2026");c.Store.commitStoreReback(a.getStore(),a.getSelection()).then(function(g,h){g&&(a.getSelectionModel().deselectAll(),a.getStore().isGrouped()&&c.Grid.getGridView(a).getFeature("group").collapseAll(),c.Dialog.hideWait(),Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u8fd8\u539f\u6210\u529f\uff01"));d(g)})};Ext.Msg.show({title:"\u7cfb\u7edf\u63d0\u9192",icon:Ext.Msg.QUESTION,message:"\u60a8\u786e\u5b9a\u8fd8\u539f\u9009\u4e2d\u7684"+
e+"\u6761\u6570\u636e\u5417\uff1f",buttons:Ext.Msg.YESNO,defaultFocus:"no",callback:function(g,h){"yes"===g&&f()}})}else Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u8fd8\u539f\u5931\u8d25\uff01Grid\u7684DataStore\u672a\u7ed1\u5b9aEntity!")})};b.showColumnSortWin=function(a,d){if(a.sortWin)c.Component.shakeComment(a.sortWin);else{var e=c.Store.getGridColumnStore(d),f=function(k,l){l||(l="ASC");return{xtype:"container",flex:1,columnWidth:1,layout:"hbox",margin:"0 0 2 0",border:0,toParam:function(){var n=
{},p=this.items.get(0);n.property=p.getValue();p=this.items.get(1);n.direction=p.getValue();return n},items:[{xtype:"combo",region:"west",valueField:"id",flex:.5,margin:"2 0 0 2",value:k.get("id"),displayField:"text",editable:!1,store:e},{xtype:"combo",flex:.5,valueField:"value",editable:!1,margin:"2 2 0 2",value:l,triggers:{close:{cls:"text-clear",handler:function(){this.ownerCt.destroy()}}},store:Ext.create("Ext.data.Store",{fields:["id","text"],data:[{text:"\u65e0",value:"NONE"},{text:"\u6b63\u5e8f",
value:"ASC"},{text:"\u5012\u5e8f",value:"DESC"}]})}]}},g=Ext.create("Ext.form.FormPanel",{margin:"5",border:0,layout:"column",width:460,scrollable:!0,defaults:{labelWidth:80,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},items:[]}),h=c.Grid.getGridInWindowSize(d);a.sortWin=Ext.create("Ext.window.Window",{title:"\u6392\u5e8f\u6570\u636e",layout:"fit",constrain:!0,iconCls:"extIcon extSort",resizable:!0,minHeight:200,minWidth:400,height:h.height,width:h.width,animateTarget:a,items:[g],
refreshSortItem:function(k){g.removeAll();d.getStore().getSorters().each(function(l){var n=e.findRecord("id",l.getProperty(),0,!1,!1,!0);n&&g.add(f(n,l.getDirection()))});0===g.items.length&&k&&g.add(f(e.getAt(0),"NONE"))},listeners:{close:function(k,l){a.sortWin.gridLoad&&a.sortWin.gridLoad.destroy();e&&e.destroy();a.sortWin=null}},buttons:[{text:"\u6dfb\u52a0\u6761\u4ef6",iconCls:"extIcon extPlus",handler:function(){g.add(f(e.getAt(0)));g.scrollTo(0,35*g.items.length+105,!1)}},{text:"\u786e\u5b9a",
iconCls:"extIcon extOk",handler:function(){c.Grid.clearColumnSort(d);var k=[];g.items.each(function(l){l=l.toParam();k.push(l);var n=c.Grid.getColumn(d,l.property);n.sortDirection=l.direction;c.Grid.refreshColumnStyle(n)});0<k.length?d.getStore().sort(k):d.getStore().loadPage(1);c.Grid.checkColumnSort(d)}}]});a.sortWin.gridLoad=d.on("load",function(){try{a.sortWin.refreshSortItem(!1)}catch(k){console.error(k)}},this,{destroyable:!0});a.sortWin.refreshSortItem(!0);d.ownerCt.add(a.sortWin)}a.sortWin.show()};
b.clearColumnSort=function(a){a.getStore().getSorters().clear();a&&Ext.each(a.getColumns(),function(d){d.sortDirection=null;c.Grid.refreshColumnStyle(d)})};b.showTimerRefreshGrid=function(a,d){if(a.timerWin)c.Component.shakeComment(a.timerWin);else{d.timerConfig||(d.timerConfig={state:0,value:30});var e=Ext.create("Ext.form.FormPanel",{margin:"5",border:0,layout:"column",width:400,scrollable:!0,defaults:{labelWidth:120,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},viewModel:{data:d.timerConfig},
items:[{xtype:"combo",name:"state",displayField:"text",valueField:"id",fieldLabel:"\u662f\u5426\u542f\u52a8",editable:!1,flex:1,columnWidth:1,value:0,allowBlank:!1,bind:"{state}",store:c.Store.getYesOrNoDataStore()},{xtype:"combo",name:"silence",displayField:"text",valueField:"id",fieldLabel:"\u9759\u9ed8\u5237\u65b0",editable:!1,flex:1,columnWidth:1,value:0,allowBlank:!1,bind:"{silence}",store:c.Store.getYesOrNoDataStore()},{xtype:"numberfield",name:"value",bind:"{value}",fieldLabel:"\u65f6\u95f4\u95f4\u9694\uff08\u79d2\uff09",
columnWidth:1,minValue:1,value:30,decimalPrecision:0,allowBlank:!1}]}),f=c.Grid.getGridInWindowSize(d);a.timerWin=Ext.create("Ext.window.Window",{title:"\u5b9a\u65f6\u5237\u65b0\u6570\u636e",layout:"fit",constrain:!0,iconCls:"extIcon extAlarm",resizable:!0,minHeight:200,minWidth:400,height:f.height,width:f.width,animateTarget:a,items:[e],listeners:{close:function(g,h){a.timerWin=null}},buttons:[{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){e.getForm().isValid()&&(d.timerConfig=e.getValues(),
d.checkRefreshTimer(!0),a.timerWin.close())}}]});d.ownerCt.add(a.timerWin)}a.timerWin.show()};b.showEChartConfigWin=function(a,d){if(a.reportWin)c.Component.shakeComment(a.reportWin);else{var e=c.Store.getChartGridColumnStore(d),f=function(h,k){k||(k="count");return{xtype:"container",flex:1,columnWidth:1,layout:"hbox",margin:"0 0 2 0",border:0,toParam:function(){var l={},n=this.items.get(0);l.property=n.getValue();var p=this.items.get(1);l["function"]=p.getValue();l.details=n.getDisplayValue()+"\u3010"+
p.getDisplayValue()+"\u3011";return l},items:[{xtype:"combo",region:"west",valueField:"id",flex:.5,margin:"2 0 0 2",value:h.get("id"),displayField:"text",editable:!1,store:e},{xtype:"combo",flex:.5,valueField:"value",editable:!1,margin:"2 2 0 2",value:k,triggers:{close:{cls:"text-clear",handler:function(){this.ownerCt.destroy()}}},store:Ext.create("Ext.data.Store",{fields:["id","text"],data:[{text:"\u8ba1\u6570",value:"count"},{text:"\u5e73\u5747\u503c",value:"avg"},{text:"\u6c42\u548c",value:"sum"},
{text:"\u6700\u5927\u503c",value:"max"},{text:"\u6700\u5c0f\u503c",value:"min"}]})}]}},g=Ext.create("Ext.form.FormPanel",{margin:"5",border:0,layout:"column",width:400,scrollable:!0,defaults:{labelWidth:80,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},items:[]});a.reportWin=Ext.create("Ext.window.Window",{title:"\u56fe\u8868\u67e5\u770b",layout:"fit",constrain:!0,iconCls:"extIcon extReport",resizable:!0,minHeight:200,minWidth:400,height:200,animateTarget:a,items:[g],listeners:{close:function(h,
k){a.reportWin=null},show:function(h){h.setLoading("\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.showExtConfig(d.getStore().entity.entityCode,"EChartsColumn",function(k,l,n){if(k)for(k=c.Json.jsonToObject(l),l=0;l<k.length;l++){n=k[l];var p=e.findRecord("id",n.property,0,!1,!1,!0);p&&g.add(f(p,n["function"]))}h.setLoading(!1);0===g.items.length&&g.add(f(e.getAt(0),"count"))})}},buttons:[{text:"\u6dfb\u52a0\u7edf\u8ba1",iconCls:"extIcon extPlus",handler:function(){g.add(f(e.getAt(0)));g.scrollTo(0,35*
g.items.length+105,!1)}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){var h={entityCode:d.getStore().entity.entityCode,columnDate:d.getStore().entity.echartsDate,storeId:d.getStore().getId()},k=[];g.items.each(function(l,n){l=l.toParam();k.push(l);for(var p in l)h["echarts["+n+"]."+p]=l[p]});c.Server.saveExtConfig(d.getStore().entity.entityCode,"EChartsColumn",c.Json.objectToJson(k),function(){});c.Grid.showEntityECharts(this,d.getStore().entity.comment+"\u3010\u56fe\u8868\u3011",
h)}}]});d.ownerCt.add(a.reportWin)}a.reportWin.show()};b.showEntityECharts=function(a,d,e){a=parseInt((.6*document.body.clientWidth).toFixed(0));var f=parseInt((.7*document.body.clientHeight).toFixed(0)),g=Ext.Date.format(Ext.Date.add(new Date,Ext.Date.MONTH,-1),"Y-m-d"),h=Ext.Date.format(new Date,"Y-m-d");e.type=0;e.chartTitle=d;e.beginDate=g;e.endDate=h;var k=Ext.create("Ext.window.Window",{title:d,height:f,width:a,minWidth:a,minHeight:f,iconCls:"extIcon extReport",layout:"border",resizable:!0,
maximizable:!0,constrain:!0,modal:!0,refreshECharts:function(){var l=this;c.ECharts.hasECharts(l)&&(l.setLoading(!1),c.ECharts.getECharts(l).showLoading());c.Server.showEcharts(e,function(n,p,q){l.setLoading(!1);n?c.ECharts.loadECharts(l,q):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",p)})},bodyStyle:{background:"#fcfcfc"},tbar:{xtype:"toolbar",overflowHandler:"menu",items:[{xtype:"combo",fieldLabel:"\u56fe\u8868\u7c7b\u578b",labelWidth:60,valueField:"value",editable:!1,value:0,listeners:{change:function(l,
n,p,q){e.type=n;k.refreshECharts()}},store:Ext.create("Ext.data.Store",{fields:["id","text"],data:[{text:"\u5e74\u56fe\u8868",value:4},{text:"\u6708\u56fe\u8868",value:1},{text:"\u65e5\u56fe\u8868",value:0},{text:"\u65f6\u56fe\u8868",value:2},{text:"\u65f6\u5206\u56fe\u8868",value:3}]})},{xtype:"daterangefield",fieldLabel:"\u65e5\u671f\u8303\u56f4",flex:1,margin:"0 0 0 5",maxRangeMonth:12,beginDate:g,endDate:h,labelWidth:60,onClearValue:function(){e.beginDate=this.beginDate;e.endDate=this.endDate;
k.refreshECharts()},onAfterSelect:function(){e.beginDate=this.beginDate;e.endDate=this.endDate;k.refreshECharts()}},{xtype:"button",text:"\u6298\u7ebf\u56fe",iconCls:"extIcon extPolyline",margin:"0 5 0 5",handler:function(){e.chartType="line";k.refreshECharts()}},{xtype:"button",text:"\u67f1\u72b6\u56fe",iconCls:"extIcon extReport",margin:"0 5 0 5",handler:function(){e.chartType="bar";k.refreshECharts()}},{xtype:"button",text:"\u5806\u53e0\u56fe",iconCls:"extIcon extMore",margin:"0 5 0 5",handler:function(){e.chartType=
"stack";k.refreshECharts()}}]},listeners:{show:function(l){k.setLoading("\u8bf7\u7a0d\u540e\u2026\u2026");l.refreshECharts()}}});k.show()};b.deleteGridData=function(a){return new Ext.Promise(function(d,e){if(a.getStore().entity)if(0===a.getSelection().length)c.Dialog.toast("\u8bf7\u60a8\u5148\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u6570\u636e\uff01");else{e=a.getSelection().length;var f=function(){c.Dialog.showWait("\u6b63\u5728\u5220\u9664\u6570\u636e\u4e2d\u2026\u2026");c.Store.commitStoreDelete(a.getStore(),
a.getSelection()).then(function(g){g&&(a.getSelectionModel().deselectAll(),a.getStore().isGrouped()&&c.Grid.getGridView(a).getFeature("group").collapseAll(),c.Dialog.hideWait());d(g)})};a.operate&&a.operate.alertDelete?c.Dialog.showDeleteDataAlert("\u786e\u8ba4\u5220\u9664\u6570\u636e","\u60a8\u786e\u5b9a\u5220\u9664\u9009\u4e2d\u7684"+e+"\u6761\u6570\u636e\u5417\uff1f",f):f()}else Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u5220\u9664\u5931\u8d25\uff01Grid\u7684DataStore\u672a\u7ed1\u5b9aEntity!")})};
b.updateGridData=function(a){return new Ext.Promise(function(d,e){a.getStore().entity?0===a.getStore().getUpdatedRecords().length?c.Dialog.toast("\u5f53\u524d\u6682\u65e0\u6570\u636e\u88ab\u4fee\u6539\uff01"):a.operate&&a.operate.alertUpdate?Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u60a8\u786e\u5b9a\u63d0\u4ea4\u88ab\u4fee\u6539\u7684\u6570\u636e\u5417\uff1f",function(f,g){"yes"===f&&(c.Dialog.showWait("\u6b63\u5728\u4fee\u6539\u6570\u636e\u4e2d\u2026\u2026"),c.Store.commitStoreUpdate(a.getStore()).then(function(h){d(h);
c.Dialog.hideWait()}))}):(c.Dialog.showWait("\u6b63\u5728\u4fee\u6539\u6570\u636e\u4e2d\u2026\u2026"),c.Store.commitStoreUpdate(a.getStore()).then(function(f){d(f);c.Dialog.hideWait()})):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u4fee\u6539\u5931\u8d25\uff01Grid\u7684DataStore\u672a\u7ed1\u5b9aEntity!")})};b.showPublicDetailsWindow=function(a,d,e,f,g){c.Grid.showDetailsWindow(a,d,e,f,g,{noneManager:!0})};b.showDetailsWindow=function(a,d,e,f,g,h){if(e&&f){var k=[e.code];if(e.idProperty)for(var l=
0;l<e.idProperty.length;l++){var n=e.idProperty[l];k.push(n+":"+f.get(n))}1==k.length&&k.push((new Date).getTime());c.Dialog.showWait("\u83b7\u53d6\u914d\u7f6e\u4e2d\u2026\u2026");var p=$.md5(JSON.stringify(k));c.Grid.restoreGridButton(e.entityCode).then(function(q){var r=e.entityCode;Ext.isEmpty(f.get("columnEntityCode"))||(r=f.get("columnEntityCode"));c.Server.showColumns(r,function(u,t,w){c.Dialog.hideWait();if(u){t=Ext.decode(t);u=[];w=1;for(var z in t)if(t.hasOwnProperty(z)){var x=t[z];if(!Ext.isEmpty(x.dataIndex)&&
c.Base.toBool(x.detailsable,!0)){var y={value:f.get(x.dataIndex),groupHeaderText:x.groupHeaderText,record:f,entity:e,configEditor:c.Base.toBool(x.canEdit),dataIndex:x.dataIndex,columnName:x.columnName,editor:!1};for(B in x)x.hasOwnProperty(B)&&(y[B]=x[B]);if(!Ext.isEmpty(x.editorField)){var A=c.Json.jsonToObject(x.editorField);null==A||Ext.isEmpty(A.xtype)||(y.configEditor=!0)}c.Base.toBool(f.get(x.dataIndex+"Editor"),!0)||(y.configEditor=!1);c.Base.toBool(f.get("__editor"),!0)||(y.configEditor=!1);
y.groupHeaderText?w++:y.groupHeaderText=w;u.push(y)}}u.sort(function(C,E){return C.index-E.index});z=Ext.create("Ext.data.Store",{fields:[],autoLoad:!1,groupField:"groupHeaderText"});z.loadData(u);z.sort("index","ASC");var B=Ext.ComponentQuery.query("window[detailsWinId\x3d"+p+"]");if(0<B.length)B[0].getComponent("detailsGrid").setStore(z),Ext.WindowManager.bringToFront(B[0],!0),c.Component.shakeComment(B[0]);else{z=Ext.create("Ext.grid.Panel",{border:0,scrollable:"y",region:"center",store:z,itemId:"detailsGrid",
hideHeaders:!0,features:[{ftype:"grouping",collapsible:!1,hideGroupedHeader:!0,expandTip:null,collapseTip:null,groupHeaderTpl:["\x3cb\x3e{name:this.formatName}\x3c/b\x3e",{formatName:function(C){return Ext.isNumeric(C)?"\u57fa\u672c\u5c5e\u6027":C}}]}],columns:[{header:"\u540d\u79f0",power:!1,dataIndex:"text",flex:.3,tdCls:"tdVTop",align:"right",renderer:function(C,E,F){E.style="overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space:normal !important;word-break:break-word;line-height: 30px; ";
return"\x3cb\x3e"+C+"\uff1a\x3c/b\x3e"}},{header:"\u503c",dataIndex:"value",power:!1,flex:.7,align:"left",renderer:function(C,E,F,H,I,K,J){try{E.style="overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space:normal !important;word-break:break-word; line-height: 30px;";var L=c.Entity.getColumnRender(e,F.get("dataIndex"));if(Ext.isEmpty(L)){var M=F.get("rendererFunction");M&&(L=eval(M))}Ext.isEmpty(L)||(C=L(C,E,F.get("record"),H,I,K,J,!0));return Ext.isEmpty(C)||"null"===C?"\x3cfont color\x3d'#ccc'\x3e\u65e0\x3c/font\x3e":
C}catch(N){return C}}},{xtype:"actioncolumn",width:80,sortable:!1,menuDisabled:!0,items:[{iconCls:"extIcon extEdit editColor marginRight5 textBlackShadowWhite",tooltip:"\u7f16\u8f91\u6570\u636e",align:"center",isDisabled:function(C,E,F,H,I){return!c.Base.toBool(I.get("editor"),!1)},getClass:function(C,E,F){return c.Base.toBool(F.get("editor"),!1)?"extIcon extEdit marginRight5 textBlackShadowWhite":""},handler:c.Grid.showDetailsEditMenu},{iconCls:"extIcon extCopy2 searchColor textBlackShadowWhite",
tooltip:"\u590d\u5236\u6570\u636e",align:"center",isDisabled:function(C,E,F,H,I){return!c.Base.toBool(I.get("doCopy"),!1)},getClass:function(C,E,F){return c.Base.toBool(F.get("doCopy"),!1)?"extIcon extCopy2 searchColor textBlackShadowWhite":""},handler:c.Grid.copyDetailsValue}]}],viewConfig:{loadMask:{msg:"\u6b63\u5728\u4e3a\u60a8\u5728\u52a0\u8f7d\u6570\u636e\u2026"},enableTextSelection:!0},toggleActionColumn:function(C){if(this.lasClickRecord){if(this.lasClickRecord.getId()===C.getId())return;this.lasClickRecord.set("editor",
!1);this.lasClickRecord.set("doCopy",!1)}C.set("doCopy",!0);C.set("editor",C.get("configEditor"));this.lasClickRecord=C},listeners:{itemclick:function(C,E){this.toggleActionColumn(E)},select:function(C,E){this.toggleActionColumn(E)}}});g||(g=[]);B=g;u=c.System.searchMenusByEntityCode(e.entityCode);var D=function(C){if(C)try{c.System.lastTabId===C.id?c.Component.shakeComment(Ext.getCmp(C.id)):c.System.selectMenu(C.id)}finally{e.idProperty&&c.Component.futureQuery("[menuId\x3d"+C.id+"]",function(E){if(E)for(var F=
function(I){var K=e.idProperty[I];c.Component.futureQuery("[dataIndex\x3d"+K+"]",function(J){if(J){if(!c.Base.toBool(J[0].restoreConfig,!1))return!1;J[0].searchValue(f.get(K))}return!0},15E3,E[0])},H=0;H<e.idProperty.length;H++)F(H);return!0},3E4)}else c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u6253\u5f00\u5931\u8d25\uff01\u60a8\u6216\u6ca1\u6709\u6b64\u529f\u80fd\u7684\u7ba1\u7406\u6743\u9650\uff01")};if(0<u.length&&c.System.isSuperRole()){var G={text:"\u8fdb\u5165\u7ba1\u7406\u754c\u9762",
iconCls:"extIcon extManage whiteColor",menu:[]};t=function(C){G.menu.push({text:c.System.getPlainMenu(C,"\x26nbsp;\x3e\x26nbsp;"),icon:c.Server.getIcon(C.iconName,C.color),handler:function(){D(C)}})};for(w=0;w<u.length;w++)t(u[w]);B.push(G)}if(0<q.length){u={text:"\u5176\u4ed6\u64cd\u4f5c",iconCls:"extIcon extMore whiteColor",menu:[]};for(t=0;t<q.length;t++)w=q[t],u.menu.push({text:w.text,iconCls:w.iconCls,icon:w.icon,functionStr:w.handler,handler:function(C,E){var F=[];try{var H={getSelection:function(){return[f]},
getSelectionModel:function(){return H}};window[e.getListThisVarName]=e;F.push(e.getListThisVarName);window[e.getListGridVarName]=H;F.push(e.getListGridVarName);c.Base.loadFunction(this.functionStr).apply(C,E)}catch(I){console.error(I,this.functionStr,e)}finally{for(C=0;C<F.length;C++)window[F[C]]=null}}});B.push(u)}u=parseInt((.4*document.body.clientWidth).toFixed(0));t=parseInt((.7*document.body.clientHeight).toFixed(0));w=[];c.System.isSuperRole()&&w.push({type:"help",callback:function(C,E,F){c.Dialog.showJson(this,
"\u67e5\u770b\u539f\u59cb\u6570\u636e\u7ed3\u6784",c.Json.objectToJson(f.data))}});Ext.create("Ext.window.Window",{title:d,detailsWinId:p,height:t,width:u,minHeight:450,iconCls:"extIcon extDetails",minWidth:400,layout:"border",resizable:!0,constrain:!0,maximizable:!0,animateTarget:a,tools:w,listeners:{destroy:function(C,E){},show:function(C){C.focus()}},items:[z],buttons:0<B.length?B:null}).show()}}else c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",w)},h)})}};b.createDetailsGrid=function(a,d,e,f){for(var g=
[],h=0;h<a.length;h++){var k=a[h];k&&g.push(k)}var l=Ext.create("Ext.data.Store",{autoLoad:!1,fields:[],data:g});a={region:"center",border:0,columnLines:!0,store:l,viewConfig:{enableTextSelection:!0},updateData:function(n){l.setData(n)},columns:[c.Json.mergeJson({header:"\u540d\u79f0",dataIndex:"name",flex:.3,align:"right",renderer:function(n,p,q){p.style="color:#000000;overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space:normal !important;line-height:25px;word-break:break-word;min-height:32px; ";
return"\x3cb\x3e"+n+"\uff1a\x3c/b\x3e"},listeners:{dblclick:function(n,p,q,r,u,t,w){}}},e),c.Json.mergeJson({header:"\u503c",dataIndex:"value",flex:.7,align:"left",renderer:function(n,p,q){try{p.style="overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space:normal !important;line-height:25px;word-break:break-word;min-height:32px; ";var r=q.get("renderer");if(Ext.isFunction(r)){var u=r(n,p,q.get("record"),-1,-1,null,null,!0);return Ext.isEmpty(u)?"\x3cfont color\x3d'#ccc'\x3e\u65e0\x3c/font\x3e":
u}return n}catch(t){return n}},listeners:{dblclick:function(n,p,q,r,u,t,w){}}},f)]};return Ext.create("Ext.grid.Panel",c.Json.mergeJson(a,d))};b.showDetailsEditMenu=function(a,d,e,f,g,h){e=h.get("entity");f=h.get("columnName");Ext.isEmpty(f)&&(f=h.get("dataIndex"));var k;if(g=h.get("linkColumn"))(k=c.Entity.getRealAttr(g))&&(f=k),k=Ext.create(g.configField);k||(k=c.Entity.getEditorFieldObject(e,f));k||(k=Ext.create(c.Json.jsonToObjectUnsafe(h.get("editorField"))));if(k){if(a.getSelectionModel().selectRange(d,
d),d=a.getCell(h,1,!0),k.flex=1,k.emptyText="\u8bf7\u8f93\u5165",k.region="center",k.record=h.get("record"),k.fromColumn=!0,!k.hasListener("beforeedit")||k.fireEvent("beforeedit"))if(!c.Listeners.onBeforeEditorField||c.Listeners.onBeforeEditorField(k,k.record)){"password"!==c.Base.toString(k.inputType,"none")&&Ext.isFunction(k.setValue)&&(e=h.get("value"),Ext.isObject(e)||Ext.isArray(e)?k.setValue(JSON.stringify(e),h.get("record")):k.setValue(e,h.get("record")));Ext.isFunction(k.startEdit)&&k.startEdit();
var l=function(p){if(p.isValid()&&!Ext.isEmpty(p.getValue())){var q=h.get("record").store;q?(q.holdUpdate=!0,c.Store.setRecordValue(h.get("record"),h.get("dataIndex"),p),c.Store.setRecordValue(h,"value",p),a&&a.setLoading("\u63d0\u4ea4\u6570\u636e\u4e2d\u2026\u2026"),c.Store.commitStoreUpdate(q).then(function(r){q.holdUpdate=!1;a&&a.setLoading(!1);r&&h.store.commitChanges()})):h.store.commitChanges()}};if(Ext.isFunction(k.showWindow))k.showWindow(d,function(p){l(p)});else{var n=Ext.create("Ext.menu.Menu",
{showSeparator:!1,layout:"fit",scrollToHidden:!0,modal:!0,editorMenu:!0,shadow:!1,doUpdate:function(){if(!this.putRecorded){var p=this.items.get(0).items.get(0);p.isValid()?(this.putRecorded=!0,l(p),this.hide()):(c.Component.shakeComment(this),c.Dialog.toast(c.Form.getFieldError(p)[0]))}},items:[{xtype:"container",layout:{type:"hbox",align:"stretch"},style:{background:"#ffffff",borderWidth:1,borderColor:"#ffffff",color:"#eeeee"},border:0,items:[k,{xtype:"button",text:"\u786e\u5b9a",name:"confirm",
region:"east",iconCls:"extIcon extOk",margin:"0 0 0 2",height:c.Form.getFieldMinHeight(!0),handler:function(){n.doUpdate()}}]}],listeners:{show:function(p,q){p.items.get(0).items.get(0).focus()},hide:function(p){var q=a.up("[detailsPanel\x3dtrue]");q&&(q.holdFloatView=!1);q=p.items.get(0).items.get(0);Ext.isFunction(q.endEdit)&&q.endEdit();p.close()}}});n.addCls("edit-menu");n.addCls("edit-details-menu");n.setWidth(d.getWidth());n.showBy(d,"tl");if(k=a.up("[detailsPanel\x3dtrue]"))k.holdFloatView=
!0}}}else c.Dialog.toast("\u6b64\u5c5e\u6027\u65e0\u6cd5\u7f16\u8f91\uff01")};b.showDataEditorWin=function(a,d){if(d)if(0===d.getSelection().length)c.Dialog.toast("\u8bf7\u9009\u62e9\u4e00\u884c\u9700\u8981\u4fee\u6539\u7684\u6570\u636e\uff01");else{var e=d.getStore();if(e){var f=d.getStore().entity;if(f){for(var g=d.getColumns(),h=[],k=d.getSelection()[0],l={},n={},p=80,q=0;q<g.length;q++){var r=g[q];if(!Ext.isEmpty(r.field)&&c.Base.toBool(r.editable,!0)){var u=r.field;Ext.isObject(u)||(u={xtype:u});
if(!Ext.isEmpty(u.xtype)){var t=Ext.clone(u),w=c.Entity.getRealAttr(r);t.name="data."+w;w=r.configText;t=Ext.create(t);t.columnWidth=1;t.fieldLabel=w;t.configFieldLabel=w;t.emptyText="\u8bf7\u8f93\u5165"+w;t.ghostDataIndex=r.dataIndex;t.realEditorField=!0;t.record=k;Ext.isEmpty(t.itemId)&&(Ext.isEmpty(u.name)?t.itemId=r.dataIndex:t.itemId=u.name);Ext.isFunction(t.setValue)&&"password"!==t.inputType&&(u=k.get(r.dataIndex),Ext.isObject(u)||Ext.isArray(u)?t.setValue(JSON.stringify(u),k):t.setValue(u,
k));if(Ext.isEmpty(r.groupHeaderText)){if(t.hasListener("beforeedit")&&!t.fireEvent("beforeedit",t))return!1;p=Math.max(p,14*w.length+28);h.push(t)}else l.hasOwnProperty(r.groupHeaderText)||(l[r.groupHeaderText]=Ext.create({xtype:"fieldset",title:r.groupHeaderText,columnWidth:1,layout:"column",defaults:{labelWidth:80,margin:"5 5 5 5",labelAlign:"right",allowBlankTip:!0,emptyText:"\u8bf7\u586b\u5199"}}),n[r.groupHeaderText]=[],h.push(l[r.groupHeaderText])),n[r.groupHeaderText].push(t),l[r.groupHeaderText].defaults.labelWidth=
Math.max(l[r.groupHeaderText].defaults.labelWidth,14*w.length+28)}}}for(var z in n)l[z].add(n[z]);if(0===h.length)c.Dialog.toast("\u65e0\u4fee\u6539\u6743\u9650\uff01");else{if(d.hasListener("beforeeditwin")&&!d.fireEvent("beforeeditwin",d,h))return!1;var x=Ext.create("Ext.form.FormPanel",{cacheKey:f.entityCode+"Editor",bodyPadding:5,method:"POST",region:"center",fileUpload:!0,autoScroll:!1,border:0,defaults:{labelWidth:Math.min(p,188),margin:"5 5 5 5",labelAlign:"right",allowBlankTip:!0},layout:"column",
items:h});d=parseInt((.4*document.body.clientWidth).toFixed(0));g=parseInt((.8*document.body.clientHeight).toFixed(0));var y=Ext.create("Ext.window.Window",{title:"\u4fee\u6539\u6570\u636e",subtitle:f.entityCode,width:d,icon:a.icon,iconCls:a.iconCls,minWidth:200,maxHeight:g,layout:{type:"vbox",align:"stretch"},autoScroll:!0,resizable:!0,maximizable:!0,constrain:!0,animateTarget:a,items:[x],modal:!0,unpin:!0,listeners:{show:function(A){x.restoreCache();A.focus()}},buttons:[{text:"\u6682\u5b58",iconCls:"extIcon extSave whiteColor",
handler:function(){x.saveCache()}},{text:"\u91cd\u7f6e",iconCls:"extIcon extReset",handler:function(){x.form&&x.form.reset();x.deleteCache()}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){if(e){e.holdUpdate=!0;for(var A=0,B=x.query("[realEditorField\x3dtrue]");A<B.length;A++){var D=B[A];D.isValid()&&(Ext.isEmpty(D.getValue())||c.Store.setRecordValue(k,D.ghostDataIndex,D))}c.Dialog.showWait("\u63d0\u4ea4\u6570\u636e\u4e2d\u2026\u2026");c.Store.commitStoreUpdate(e).then(function(G){c.Dialog.hideWait();
e.holdUpdate=!1;G?(e.commitChanges(),x.deleteCache(),y.close()):e.rejectChanges()})}}}]});y.show()}}else c.Dialog.toast("\u65e0\u6cd5\u4fee\u6539\u6b64\u884c\u6570\u636e\uff0c\u672a\u7ed1\u5b9a\u5b9e\u4f53\u4fe1\u606f\uff01")}else c.Dialog.toast("\u65e0\u6cd5\u4fee\u6539\u6b64\u884c\u6570\u636e\uff0c\u6570\u636e\u6e90\u65e0\u6548\uff01")}};b.copyDetailsValue=function(a,d,e,f,g,h){a=a.getCell(h,1,!0);c.Base.copyToBoard($(a.dom).text().trim());c.Dialog.toast("\u590d\u5236\u6210\u529f\uff01")};b.showSelectRecordHistory=
function(a,d){Ext.isEmpty(d.showHistoryState)&&(d.showHistoryState=0);if(a.selectHistoryWin)c.Component.shakeComment(a.selectHistoryWin);else{d.selectHistoryConfig||(d.selectHistoryConfig={state:0,count:0});d.selectHistoryConfig.count=d.getSelectRecordHistory().length;var e=Ext.create("Ext.form.FormPanel",{margin:"5",border:0,layout:"column",width:400,scrollable:!0,defaults:{labelWidth:140,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},viewModel:{data:d.selectHistoryConfig},items:[{xtype:"combo",
name:"state",displayField:"text",valueField:"id",fieldLabel:"\u662f\u5426\u8bb0\u5fc6\u9009\u62e9",editable:!1,flex:1,columnWidth:1,value:0,allowBlank:!1,bind:"{state}",store:c.Store.getYesOrNoDataStore()},{xtype:"numberfield",name:"count",bind:"{count}",selectHistoryCount:!0,fieldLabel:"\u5df2\u9009\u4e2d\u6570\u636e\uff08\u6761\uff09",columnWidth:1,value:0,readOnly:!0}]}),f=c.Grid.getGridInWindowSize(d);a.selectHistoryWin=Ext.create("Ext.window.Window",{title:"\u6570\u636e\u9009\u62e9\u5668",layout:"fit",
constrain:!0,iconCls:"extIcon extSelect",resizable:!0,minHeight:100,minWidth:400,height:f.height,width:f.width,animateTarget:a,items:[e],listeners:{close:function(g,h){a.selectHistoryWin.gridSelectinoChange&&a.selectHistoryWin.gridSelectinoChange.destroy();a.selectHistoryWin.gridLoad&&a.selectHistoryWin.gridLoad.destroy();a.selectHistoryWin=null}},buttons:[{text:"\u67e5\u770b\u9009\u4e2d\u7684\u6570\u636e",iconCls:"extIcon extSee",showSelectHistoryBtn:!0,listeners:{render:function(){this.checkState()}},
resetState:function(){d.showHistoryState=0;this.checkState()},checkState:function(){1===d.showHistoryState?(this.setText("\u53d6\u6d88\u67e5\u770b"),this.setIconCls("extIcon extReset")):(this.setText("\u67e5\u770b\u9009\u4e2d\u7684\u6570\u636e"),this.setIconCls("extIcon extSee"))},handler:function(){d.closeSelectHistoryLoad=!0;0===d.showHistoryState?(d.getStore().loadData(d.getSelectRecordHistory()),d.showHistoryState=1,this.checkState()):d.getStore().reload()}},"-\x3e",{text:"\u786e\u5b9a",iconCls:"extIcon extOk",
handler:function(){e.getForm().isValid()&&(d.selectHistoryConfig=e.getValues(),0===parseInt(d.selectHistoryConfig.state)?(c.Dialog.toast("\u5df2\u5173\u95ed\u9009\u4e2d\u6570\u636e\u7684\u8bb0\u5fc6\u5668\uff01"),d.clearSelectRecordHistory(),d.getStore().reload()):(c.Dialog.toast("\u5df2\u542f\u7528\u9009\u4e2d\u6570\u636e\u7684\u8bb0\u5fc6\u5668\uff01"),d.recordSelect()),c.Grid.checkHistoryConfig(d),a.selectHistoryWin.close())}}]});a.selectHistoryWin.gridSelectinoChange=d.on("selectionchange",function(){d.refreshSelectHistoryCount()},
this,{destroyable:!0});a.selectHistoryWin.gridLoad=d.on("load",function(){try{d.showHistoryState=0;for(var g=d.ownerCt.query("[showSelectHistoryBtn\x3dtrue]"),h=0;h<g.length;h++)Ext.isFunction(g[h].resetState)&&g[h].resetState()}catch(k){console.error(k)}},this,{destroyable:!0});d.ownerCt.add(a.selectHistoryWin)}a.selectHistoryWin.show()};return b}();c.Grid=v;var m=function(){return function(b){this.alertUpdate=this.alertDelete=!0;this.autoUpdate=!1;this.autoDetails=!0;this.refreshData=this.hoverTip=
!1;this.copyData=this.deleteAllData=this.globalSearch=this.uploadData=this.downloadData=this.excelIn=this.excelOut=!0;this.showRowNumber=!1;this.showUpdateButton=this.showDetailsButton=!0;if(b)for(var a in b)this[a]=b[a]}}();c.GridOperate=m;v=function(){return function(){this.lookField=this.searchLink=this.operation=this.batchReplaceDB=this.batchUpdateDB=this.batchUpdate=this.batchRandom=this.cancelSort=!0}}();c.GridColumnMenu=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.rotateOSSImgUrl=function(b,a){if(!Ext.isEmpty(b)&&!Ext.isEmpty(a)){var d=b.split("/");return d[d.length-1].startWith("svg-")?b:0<=b.toString().indexOf("?")?b+"\x26x-oss-process\x3dimage/rotate,"+a:b+"?x-oss-process\x3dimage/rotate,"+a}return b};m.smallOSSImgUrl=function(b){if(!Ext.isEmpty(b)){var a=b.split("/");return a[a.length-1].startWith("svg-")?b:0<=b.toString().indexOf("?")?b+"\x26x-oss-process\x3dimage/resize,h_20,m_lfit":b+"?x-oss-process\x3dimage/resize,h_20,m_lfit"}return b};
m.showImage=function(b,a,d,e){Ext.isEmpty(e)&&(e=!1);var f=null;b&&Ext.isFunction(b.getAttribute)&&(f=b.getAttribute("data-container-id"));var g=[];Ext.isArray(a)?g=a:g.push({url:a});f&&c.Image.showAllRelationImage&&$("#"+f).find("img").each(function(r,u){u=$(u);if(u.attr("data-container-id")&&u.attr("data-details-id")){r=u.attr("data-details-id");u=u.attr("src");c.Cache.memory.hasOwnProperty(r)&&(u=c.Cache.memory[r]);if(Ext.isString(a)&&u===a)return!0;g.push({url:u})}});f=-1;if(null!=Ext.getStore("ImageViewStore")){b=
Ext.getStore("ImageViewStore");e=[];for(var h=0,k=g;h<k.length;h++){var l=k[h],n=b.findRecord("url",l.url);n?Ext.isString(a)&&a===l.url&&(f=b.indexOf(n)):e.push(l)}b.add(e);-1===f&&(f=b.count()-1);b.imgSelectIndex=f;Ext.getCmp("ImageViewGrid").getSelectionModel().select(f)}else{-1===f&&(f=0);var p=Ext.create("Ext.data.Store",{fields:["url"],autoLoad:!1,imgSelectIndex:f,id:"ImageViewStore",data:g}),q=Ext.create("Ext.grid.Panel",{store:p,region:"west",hideHeaders:!0,id:"ImageViewGrid",width:125,disabled:!0,
border:1,scrollable:"y",columns:[{header:"\u6587\u4ef6",dataIndex:"url",flex:1,align:"center",renderer:function(r){return Ext.isEmpty(r)?"\x3cspan style\x3d'color: #ccc;'\x3e\u65e0\x3c/span\x3e":"\x3cimg width\x3d'30px' onerror\x3d\"javascript:this.src\x3d'images/default_img.png';\" src\x3d'"+r.split("@")[0]+"'/\x3e"}}],tbar:[{xtype:"button",border:1,text:"\u6253\u5305\u4e0b\u8f7d",iconCls:"extIcon extDownload",handler:function(r){var u={};p.each(function(t,w){u["path"+w]=t.get("url")});r=c.Form.buildForm("zipFile",
u);r.submit();$(r).remove()}}],listeners:{selectionchange:function(r,u){try{r=0;var t=this.getStore(),w=this.ownerCt.down("#arrowRight"),z=this.ownerCt.down("#arrowLeft");1<t.getCount()?(this.setHidden(!1),r=120,w&&w.setDisabled(t.count()-1===t.indexOf(u[0])),z&&z.setDisabled(0===t.indexOf(u[0]))):(this.setHidden(!0),w&&w.setHidden(!0),z&&z.setHidden(!0));setTimeout(function(){window.imgViewFrame&&Ext.isFunction(window.imgViewFrame.window.showImage)&&window.imgViewFrame.window.showImage(c.System.formatUrl(u[0].get("url")),
c.System.http)},r)}catch(x){c.Dialog.showException(x,"showImage")}}}});window.imageViewerLoadDone=function(){Ext.getCmp("ImageViewGrid").setDisabled(!1);try{var r=Ext.getStore("ImageViewStore").imgSelectIndex;Ext.getCmp("ImageViewGrid").getSelectionModel().select(r)}catch(u){c.Dialog.showException(u,"showImage")}};window.imageViewerSize=function(r,u){Ext.getCmp("ImageViewWindow").setTitle("\u67e5\u770b\u56fe\u7247 "+r+"x"+u)};f=Ext.create("Ext.panel.Panel",{layout:"fit",region:"center",border:0,height:"auto",
iframePanel:!0,html:'\x3cdiv style\x3d"background: #000000;width: 100%;height: 100%;"\x3e\x3c/div\x3e',listeners:{afterrender:function(r,u){1>=p.getCount()?q.setHidden(!0):q.setHidden(!1);r.update("\x3ciframe style\x3d'background: #000000;width: 100%;height: 100%;' name\x3d'imgViewFrame'  src\x3d'"+c.System.formatUrlVersion("base/image-view/index.html")+"' width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' /\x3e");r.getEl().on("mouseleave",function(t){t=window.imgViewFrame.window.document.getElementsByTagName("div")[0];
c.Base.dispatchTargetEvent(window.imgViewFrame.window.document,t,"pointerup");window.imgViewFrame.window.reset()})}},bbar:{xtype:"toolbar",dock:"bottom",layout:{type:"hbox",align:"middle",pack:"center"},items:[{xtype:"button",iconCls:"extIcon extReset",handler:function(){window.imgViewFrame.window.reset()}},{xtype:"button",iconCls:"extIcon extZoomOut",handler:function(){window.imgViewFrame.window.zoomOut()}},{xtype:"button",iconCls:"extIcon extZoomIn",handler:function(){window.imgViewFrame.window.zoomIn()}},
{xtype:"button",iconCls:"extIcon extOneOne",handler:function(){window.imgViewFrame.window.oneOne()}},{xtype:"button",iconCls:"extIcon extArrowLeft",itemId:"arrowLeft",hidden:!0,handler:function(){var r=Ext.getCmp("ImageViewGrid"),u=r.getSelection(),t=0;0<u.length&&(t=r.getStore().indexOf(u[0]));Ext.getCmp("ImageViewGrid").getSelectionModel().select(Math.max(t-1,0))}},{xtype:"button",iconCls:"extIcon extArrowRight",itemId:"arrowRight",hidden:!0,handler:function(){var r=Ext.getCmp("ImageViewGrid"),
u=r.getSelection(),t=0;0<u.length&&(t=r.getStore().indexOf(u[0]));Ext.getCmp("ImageViewGrid").getSelectionModel().select(Math.min(t+1,r.getStore().count()-1))}},{xtype:"button",iconCls:"extIcon extRefresh",handler:function(){window.imgViewFrame.window.rotate()}},{xtype:"button",iconCls:"extIcon extLeftRight",handler:function(){window.imgViewFrame.window.flipA()}},{xtype:"button",iconCls:"extIcon extTopBottom",handler:function(){window.imgViewFrame.window.flipB()}},{xtype:"button",iconCls:"extIcon extDownload2",
handler:function(){var r=q.getSelectionModel().getSelection();c.Base.download(r[0].get("url"))}}]}});h=parseInt((.6*document.body.clientWidth).toFixed(0));k=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:"\u67e5\u770b\u56fe\u7247",height:k,width:h,minHeight:500,minWidth:600,id:"ImageViewWindow",layout:"border",iconCls:"extIcon extImage",resizable:!0,alwaysOnTop:!0,maximizable:!0,modal:e,constrain:!0,animateTarget:b,items:[q,f],listeners:{close:function(r){p.destroy();
Ext.isFunction(d)&&d()}}}).show()}};m.showAllRelationImage=!0;return m}();c.Image=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.jsonToObject=function(b){try{return JSON.parse(b)}catch(a){}return null};m.objectToJson=function(b){try{return JSON.stringify(b)}catch(a){}return null};m.objectToJsonUnsafe=function(b){return JSON.stringify(b,function(a,d){return"function"===typeof d?d.toString():d})};m.jsonToObjectUnsafe=function(b){try{return JSON.parse(b,function(a,d){return d.indexOf&&-1<d.indexOf("function")?eval("(function(){return "+d+" })()"):d})}catch(a){}return null};m.mergeJson=
function(b,a){var d={};if(!Ext.isEmpty(b))for(var e in b)d[e]=b[e];if(!Ext.isEmpty(a))for(e in a)d[e]=a[e];return d};m.showFormatJson=function(b,a,d){try{b&&Ext.isFunction(b.blur)&&b.blur();Ext.isEmpty(d)&&(d="\u67e5\u770bJSON\u6570\u636e");var e=parseInt((.6*document.body.clientWidth).toFixed(0)),f=parseInt((.7*document.body.clientHeight).toFixed(0)),g=Ext.create("Ext.window.Window",{title:d,height:f,width:e,minHeight:500,minWidth:600,animateTarget:b,layout:"fit",resizable:!0,maximizable:!0,iconCls:"extIcon extSee",
autoScroll:!0,modal:!0,constrain:!0,buttons:[{text:"\u4fdd\u7559\u8f6c\u4e49\u7b26",iconCls:"extIcon extConvertCode whiteColor",handler:function(){if(c.Base.toBool(this.keepChar,!1)){var k=(new JSONFormat(a,4)).toString();g.update("\x3cdiv style\x3d'padding: 20px;'\x3e"+k+"\x3c/div\x3e");this.setText("\u4fdd\u7559\u8f6c\u4e49\u7b26");this.keepChar=!1}else k=a.replace(/\\/g,"\\\\"),k=k.replace(/\\"/g,'\\\\"'),k=(new JSONFormat(k,4)).toString(),g.update("\x3cdiv style\x3d'padding: 20px;'\x3e"+k+"\x3c/div\x3e"),
this.setText("\u89e3\u6790\u8f6c\u4e49\u7b26"),this.keepChar=!0}},"-\x3e",{text:"\u590d\u5236JSON\u6570\u636e",iconCls:"extIcon extCopy2 whiteColor",handler:function(){c.Dialog.toast("\u590d\u5236\u6210\u529f\uff01");c.Base.copyToBoard(a)}}]}),h=(new JSONFormat(a,4)).toString();g.update("\x3cdiv style\x3d'padding: 20px;'\x3e"+h+"\x3c/div\x3e");g.show()}catch(k){console.error(k),c.Dialog.showText(b,null,"\u67e5\u770b\u6570\u636e",a)}};return m}();c.Json=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){c.Listeners.onInitLoginPanel=window.onInitLoginPanel;c.Listeners.onAfterManagerLogin=window.onAfterLogin||window.onAfterManagerLogin;c.Listeners.onBeforeManagerLogin=window.onBeforeLogin||window.onBeforeManagerLogin;c.Listeners.onSystemNoticeShow=window.onSystemNoticeShow;c.Listeners.onInitSystemWelcomeItems=window.initWelcomeItems;c.Listeners.onInitLinkFieldDefaultValue=window.getLinkFieldDefaultValue}m.addExtCreateFilter=function(b,a){c.System.addFilterByEntityCreate(b,
a)};m.fireExtCreateFilter=function(b,a,d,e){if(b=c.System.extCreateFilter[b])for(var f=0;f<b.length;f++){var g=b[f];if(Ext.isFunction(g)){var h=new c.ComponentInvokeInfo;h.method=a;h.xtype=d;h.config=e;g(h)}}};return m}();c.Listeners=v;v=function(){return function(m){this.enable=!0;if(m)for(var b in m)this[b]=m[b]}}();c.ExtCreateFilter=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.loadJsonAnim=function(b,a,d){c.Lottie.loadJsonAnimByEl(c.Base.getTargetBodyElement(b),a,d)};m.loadJsonAnimByEl=function(b,a,d){var e=function(){c.Lottie.loadedLottieJs=!0;b?(Ext.isEmpty(b.id)&&(b.id="fastchar-id-"+$.md5(c.Base.buildUUID16())),c.Cache.memory[b.id+"Lottie"]=bodymovin.loadAnimation({container:b,renderer:"svg",loop:!0,autoplay:!0,path:a,rendererSettings:{progressiveLoad:!1,hideOnTransparent:!0}}),c.Cache.memory[b.id+"Lottie"].cacheId=b.id+
"Lottie",d&&c.Cache.memory[b.id+"Lottie"].addEventListener("data_ready",d)):console.error("\u52a0\u8f7dLottie\u52a8\u753b\u5931\u8d25\uff01\u65e0\u6cd5\u83b7\u53d6\u76ee\u6807\u63a7\u4ef6\u7684BodyElement\uff01")};this.loadedLottieJs?e():c.System.addScript({src:c.Lottie.lottieJsPath},e)};m.unloadJsonAnim=function(b){if(b=c.Lottie.getLottie(b))b.destroy(),c.Cache.memory[b.cacheId]=null};m.unloadJsonAnimByEl=function(b){if(b=c.Lottie.getLottieByEl(b))b.destroy(),c.Cache.memory[b.cacheId]=null};m.unloadJsonAnimById=
function(b){if(b=c.Lottie.getLottieByElId(b))b.destroy(),c.Cache.memory[b.cacheId]=null};m.getLottie=function(b){return c.Lottie.getLottieByEl(c.Base.getTargetBodyElement(b))};m.getLottieByEl=function(b){return b?c.Lottie.getLottieByElId(b.id):null};m.getLottieByElId=function(b){return c.Cache.memory[b+"Lottie"]};m.showLottie=function(b,a){b=parseInt((.6*document.body.clientWidth).toFixed(0));var d=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:"\u67e5\u770b\u52a8\u6548",
height:d,width:b,layout:"border",resizable:!0,maximizable:!0,constrain:!0,modal:!0,padding:"10 10 10 10",bodyStyle:{background:"#ffffff"},listeners:{show:function(e){e.setLoading("\u52a0\u8f7d\u52a8\u6548\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Lottie.loadJsonAnim(e,a,function(){e.setLoading(!1)})}}}).show()};m.lottieJsPath="base/lottie/lottie.min.js";return m}();c.Lottie=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.selAddressInMap=function(b,a,d,e){return new Ext.Promise(function(f,g){var h="";Ext.isEmpty(a)||Ext.isEmpty(d)||0===parseFloat(a)||0===parseFloat(d)||(h=a+","+d);var k=Ext.create("Ext.panel.Panel",{layout:"border",region:"center",iframePanel:!0,border:0}),l=function(t,w){Ext.Msg.prompt(t,"\u8bf7\u8f93\u5165\u5750\u6807\u7ecf\u7eac\u5ea6(lng,lat)",function(z,x){"ok"===z&&(x=x.toString().replaceAll(" ","").replaceAll("\uff0c",","),window.mapFrame&&(w?window.mapFrame.window.AMap.convertFrom([x.split(",")],
w,function(y,A){window.mapFrame.window.setLngLatAddress(A.locations[0].toString())}):window.mapFrame.window.setLngLatAddress(x)))})},n=Ext.create("Ext.form.FormPanel",{url:"addData",method:"POST",region:"north",fileUpload:!0,autoScroll:!1,layout:{type:"hbox",align:"stretch"},defaults:{margin:"5 5 5 5"},items:[{name:"map.taskTitle",fieldLabel:"\u4f4d\u7f6e\u641c\u7d22",labelWidth:60,labelAlign:"right",id:"txtSearch",columnWidth:1,flex:1,allowBlank:!1,useHistory:!0,emptyText:"\u8f93\u5165\u5730\u5740",
xtype:"textfield"},{xtype:"button",width:100,text:"\u641c\u7d22",handler:function(){p()}},{xtype:"button",width:120,text:"\u67e5\u627e\u9ad8\u5fb7\u5750\u6807",handler:function(){l("\u67e5\u627e\u9ad8\u5fb7\u5750\u6807")}},{xtype:"button",width:120,text:"\u67e5\u627eGPS\u5750\u6807",handler:function(){l("\u67e5\u627eGPS\u5750\u6807","gps")}}],listeners:{render:function(t){try{new Ext.util.KeyMap({target:t.getEl(),key:13,fn:p,scope:Ext.getBody()})}catch(w){console.error(w)}}}}),p=function(){n.getForm().isValid()&&
window.mapFrame.window.searchAddress(Ext.getCmp("txtSearch").getValue())};g=Ext.create("Ext.panel.Panel",{layout:{type:"hbox",align:"stretch"},region:"south",border:0,height:42,defaults:{margin:"5 5 5 5"},items:[{xtype:"textfield",id:"lblAddress",fieldLabel:"\u9009\u62e9\u4f4d\u7f6e",labelWidth:60,value:e,labelAlign:"right",flex:1},{xtype:"textfield",id:"lblLngLat",readOnly:!0,width:160,value:h},{xtype:"button",width:100,text:"\u786e\u5b9a",handler:function(){var t=Ext.getCmp("lblLngLat"),w=t.getValue(),
z=w.split(",")[0];w=w.split(",")[1];c.Base.runCallBack(f,{lng:z,lat:w,addr:Ext.getCmp("lblAddress").getValue(),pro:t.province,city:t.city,area:t.area});u.close()}}]});var q=Ext.create("Ext.panel.Panel",{layout:"border",border:0,items:[n,k,g]});g=parseInt((.6*document.body.clientWidth).toFixed(0));var r=parseInt((.7*document.body.clientHeight).toFixed(0)),u=Ext.create("Ext.window.Window",{title:"\u9009\u62e9\u4f4d\u7f6e",height:r,width:g,minHeight:500,minWidth:600,iconCls:"extIcon extMap",layout:"fit",
resizable:!0,maximizable:!0,animateTarget:b,constrain:!0,items:[q],modal:!0,listeners:{show:function(){var t=c.System.formatUrlVersion("base/map/select.html",{mapVersion:c.System.getExt("amap-version").value,mapKey:c.System.getExt("amap-key").value});k.update("\x3ciframe name\x3d'mapFrame'  src\x3d'"+t+"' style\x3d'width: 100%;height: 100%;overflow: hidden;border: 0;' /\x3e")},close:function(t){c.Base.runCallBack(f)},destroy:function(){window.onMapLoadDone=null;window.closeMapMask=null;window.showMapMask=
null;window.showMapAlert=null;window.setMarkCurrPos=null}}});u.show();q.setLoading("\u6b63\u5728\u5b9a\u4f4d\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");window.onMapLoadDone=function(){Ext.isEmpty(h)?window.mapFrame.window.startLocation():window.mapFrame.window.setLngLatAddress(h)};window.closeMapMask=function(){q.setLoading(!1)};window.showMapMask=function(t){t?q.setLoading(t):q.setLoading(!0)};window.showMapAlert=function(t){c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",t)};window.setMarkCurrPos=
function(t,w,z,x,y){Ext.getCmp("lblAddress").setValue(w);w=Ext.getCmp("lblLngLat");w.setValue(t);w.province=z;w.city=x;w.area=y}})};m.showAddressInMap=function(b,a,d,e){var f=Ext.create("Ext.panel.Panel",{layout:"border",region:"center",border:0,iframePanel:!0}),g=parseInt((.6*document.body.clientWidth).toFixed(0)),h=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:"\u67e5\u770b\u4f4d\u7f6e",height:h,width:g,minHeight:500,minWidth:600,iconCls:"extIcon extMap",
layout:"fit",resizable:!0,maximizable:!0,animateTarget:b,constrain:!0,modal:!0,items:[f],listeners:{show:function(){var k={lnglat:a,mapVersion:c.System.getExt("amap-version").value,mapKey:c.System.getExt("amap-key").value,mapTitle:d,mapAddress:e};f.update("\x3ciframe  src\x3d'"+c.System.formatUrlVersion("base/map/show.html",k)+"' style\x3d'width: 100%;height: 100%;overflow: hidden;border: 0;' /\x3e")},destroy:function(){window.closeMapMask=null}}}).show();f.setLoading("\u6b63\u5728\u8bf7\u6c42\u5730\u5740\u4fe1\u606f\u2026\u2026");
window.closeMapMask=function(){f.setLoading(!1)}};m.selRectangleInMap=function(b,a,d,e,f,g){return new Ext.Promise(function(h,k){Ext.isEmpty(g)&&(g=0);var l=Ext.create("Ext.panel.Panel",{layout:"border",region:"center",iframePanel:!0,border:0}),n=Ext.create("Ext.form.FormPanel",{method:"POST",region:"north",fileUpload:!0,autoScroll:!0,height:50,layout:"column",imgRotate:g,defaults:{margin:"5 5 5 5"},items:[{name:"map.taskTitle",fieldLabel:"\u4f4d\u7f6e\u641c\u7d22",labelWidth:60,labelAlign:"right",
id:"txtSearch",columnWidth:1,useHistory:!0,emptyText:"\u8f93\u5165\u5730\u5740",xtype:"textfield"},{xtype:"button",width:100,text:"\u641c\u7d22",handler:function(){p()}},{xtype:"button",width:100,text:"\u9009\u53d6",handler:function(){window.mapRectangleFrame.window.selectRectangle()}},{xtype:"button",width:100,text:"\u951a\u70b9\u7ba1\u7406",handler:function(){c.Map.manageMapAnchorPoints(this,window.mapRectangleFrame)}},{xtype:"button",width:120,hidden:Ext.isEmpty(e),text:"\u5411\u5de6\u65cb\u8f6c\u56fe\u7247",
handler:function(){n.imgRotate+=5;360<n.imgRotate&&(n.imgRotate=0);window.mapRectangleFrame.window.setImgLayerUrl(c.Image.rotateOSSImgUrl(e,n.imgRotate))}},{xtype:"button",width:120,hidden:Ext.isEmpty(e),text:"\u5411\u53f3\u65cb\u8f6c\u56fe\u7247",handler:function(){n.imgRotate-=5;0>n.imgRotate&&(n.imgRotate=360);window.mapRectangleFrame.window.setImgLayerUrl(c.Image.rotateOSSImgUrl(e,n.imgRotate))}}],listeners:{render:function(t){try{new Ext.util.KeyMap({target:t.getEl(),key:13,fn:p,scope:Ext.getBody()})}catch(w){console.error(w)}}}}),
p=function(){n.getForm().isValid()&&window.mapRectangleFrame.window.searchAddress(Ext.getCmp("txtSearch").getValue())};k=Ext.create("Ext.panel.Panel",{layout:"column",region:"south",border:0,height:42,defaults:{margin:"5 5 5 5"},items:[{xtype:"textfield",id:"lblSouthWestLngLat",fieldLabel:"\u897f\u5357\u89d2(\u5de6\u4e0b)",labelAlign:"right",readOnly:!0,columnWidth:.35},{xtype:"textfield",id:"lblNorthEastLngLat",fieldLabel:"\u4e1c\u5317\u89d2(\u53f3\u4e0a)",readOnly:!0,columnWidth:.35},{xtype:"textfield",
id:"lblRectangleSize",labelWidth:60,fieldLabel:"\u77e9\u5f62\u5bbd\u9ad8",readOnly:!0,columnWidth:.3},{xtype:"button",width:100,text:"\u786e\u5b9a",handler:function(){var t=Ext.getCmp("lblSouthWestLngLat").getValue(),w=Ext.getCmp("lblNorthEastLngLat").getValue();c.Base.runCallBack(h,{southWestLngLat:t,southWestLng:t.split(",")[0],southWestLat:t.split(",")[1],northEastLngLat:w,northEastLng:w.split(",")[0],northEastLat:w.split(",")[1],anchors:window.mapRectangleFrame.pointDataArray,rotate:n.imgRotate});
u.close()}}]});var q=Ext.create("Ext.panel.Panel",{layout:"border",border:0,items:[n,l,k]});k=parseInt((.5*document.body.clientWidth).toFixed(0));var r=parseInt((.7*document.body.clientHeight).toFixed(0)),u=Ext.create("Ext.window.Window",{title:"\u9009\u62e9\u56fe\u5c42\u4f4d\u7f6e",height:r,width:k,minHeight:500,minWidth:600,iconCls:"extIcon extMap",layout:"fit",resizable:!0,maximizable:!0,animateTarget:b,constrain:!0,items:[q],modal:!0,listeners:{show:function(){var t=c.System.formatUrlVersion("base/map/rectangle.html",
{mapVersion:c.System.getExt("amap-version").value,mapKey:c.System.getExt("amap-key").value});l.update("\x3ciframe name\x3d'mapRectangleFrame'  src\x3d'"+t+"' width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' /\x3e")},close:function(t){c.Base.runCallBack(h)}}});u.show();window.onMapLoadDone=function(){var t=c.Image.rotateOSSImgUrl(e,g);window.mapRectangleFrame.pointDataArray=f;window.mapRectangleFrame.window.setImgLayerUrl(t);a&&d&&(q.setLoading(!1),window.mapRectangleFrame.window.selectRectangle(a,
d,t));if(window.mapRectangleFrame.pointDataArray){t=[];for(var w=0;w<window.mapRectangleFrame.pointDataArray.length;w++)t.push(window.mapRectangleFrame.pointDataArray[w].gdPoint);window.mapRectangleFrame.window.setAnchorPoints(t,!1)}};window.closeMapMask=function(){q.setLoading(!1)};window.showMapMask=function(t){t?q.setLoading(t):q.setLoading(!0)};window.alert=function(t){c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",t)};window.setSelectBounds=function(t,w,z){var x=Ext.getCmp("lblSouthWestLngLat");
x&&x.setValue(t);(t=Ext.getCmp("lblNorthEastLngLat"))&&t.setValue(w);(w=Ext.getCmp("lblRectangleSize"))&&w.setValue(z.width+"px - "+z.height+"px")}})};m.manageMapAnchorPoints=function(b,a){b&&b.blur();a.pointDataArray||(a.pointDataArray=[]);var d=Ext.create("Ext.data.Store",{autoLoad:!0,data:a.pointDataArray}),e=function(h,k){Ext.Msg.prompt(h,"\u8bf7\u8f93\u5165\u5750\u6807\u7ecf\u7eac\u5ea6(lng,lat)",function(l,n){"ok"===l&&(n=n.toString().replaceAll(" ","").replaceAll("\uff0c",","),a&&(k?a.window.AMap.convertFrom([n.split(",")],
k,function(p,q){p=q.locations[0];d.findRecord("gdPoint",p.toString(),0,!1,!1,!0)?c.Dialog.toast("\u5750\u6807\u5df2\u5b58\u5728\uff01"):d.add({gdPoint:p.toString()})}):d.findRecord("gdPoint",n,0,!1,!1,!0)?c.Dialog.toast("\u5750\u6807\u5df2\u5b58\u5728\uff01"):d.add({gdPoint:n})))})},f=Ext.create("Ext.grid.Panel",{selModel:c.Grid.getGridSelModel(),store:d,columnLines:!0,cellTip:!0,columns:[{header:"\u9ad8\u5fb7\u5750\u6807",dataIndex:"gdPoint",align:"center",flex:1,field:{xtype:"textfield"},renderer:c.Renders.normal()}],
selType:"cellmodel",tbar:[{xtype:"button",border:1,text:"\u5220\u9664",iconCls:"extIcon extDelete",handler:function(){var h=f.getSelectionModel().getSelection();0===h.length?c.Dialog.toast("\u8bf7\u60a8\u9009\u62e9\u9700\u8981\u5220\u9664\u7684\u5750\u6807\uff01"):Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u60a8\u786e\u5b9a\u7acb\u5373\u5220\u9664\u9009\u4e2d\u7684\u5750\u6807\u5417\uff1f",function(k,l){"yes"===k&&(Ext.Array.each(h,function(n){d.remove(n)}),f.getSelectionModel().deselectAll(),c.Dialog.toast("\u5220\u9664\u6210\u529f\uff01"))})}},
{xtype:"button",border:1,text:"\u6dfb\u52a0\u9ad8\u5fb7\u5750\u6807",iconCls:"extIcon extAdd",handler:function(){e("\u6dfb\u52a0\u9ad8\u5fb7\u5750\u6807")}},{xtype:"button",border:1,text:"\u6dfb\u52a0GPS\u5750\u6807",iconCls:"extIcon extAdd",handler:function(){e("\u6dfb\u52a0GPS\u5750\u6807","gps")}}],listeners:{selectionchange:function(){}}}),g=Ext.create("Ext.window.Window",{title:"\u56fe\u5c42\u951a\u70b9\u7ba1\u7406",height:300,width:400,minWidth:400,minHeight:300,layout:"fit",resizable:!0,modal:!0,
constrain:!0,iconCls:"extIcon extFolder",animateTarget:b,items:[f],buttons:[{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){var h=[],k=[];d.each(function(l,n){l=l.get("gdPoint");h.push(l);k.push({gdPoint:l})});a&&(a.pointDataArray=k,a.window.setAnchorPoints(h,!0));g.close()}}],listeners:{close:function(){}}});g.show()};m.showImgLayerInMap=function(b,a,d,e,f,g,h){return new Ext.Promise(function(k,l){var n=Ext.create("Ext.panel.Panel",{layout:"border",region:"center",iframePanel:!0,
border:0});l=parseInt((.6*document.body.clientWidth).toFixed(0));var p=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:"\u67e5\u770b\u56fe\u5c42\u4f4d\u7f6e",height:p,width:l,minHeight:500,minWidth:600,iconCls:"extIcon extMap",layout:"fit",resizable:!0,maximizable:!0,animateTarget:b,constrain:!0,items:[n],modal:!0,listeners:{show:function(){var q=c.System.formatUrlVersion("base/map/showRectangle.html",{mapVersion:c.System.getExt("amap-version").value,mapKey:c.System.getExt("amap-key").value});
n.update("\x3ciframe name\x3d'mapFrame'  src\x3d'"+q+"' width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' /\x3e")},close:function(q){k.called||(k.called=!0,k())}}}).show();Ext.isEmpty(f)&&(f=6);window.onMapLoadDone=function(){window.mapFrame.window.showImgLayerInMap(a,d,e,f,g,h)};window.alert=function(q){c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",q)}})};return m}();c.Map=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.copyMenu=function(b){var a=[];b.items&&b.items.each(function(d,e){e={icon:d.icon,text:d.text,handler:d.handler};null!=d.getMenu()&&(e.menu=c.Menu.copyMenu(d.getMenu()));a.push(e)});return a};m.fireMenuEvent=function(b,a){b&&b.items&&b.items.each(function(d,e){if(d.hasOwnProperty(a)&&Ext.isFunction(d[a]))d[a]();Ext.isFunction(d.getMenu)&&c.Menu.fireMenuEvent(d.getMenu(),a)})};m.isSplitLineLast=function(b){if(b){if(b.items&&0<b.items.length)return"-"===
b.items[b.items.length-1];if(Ext.isArray(b)&&0<b.length)return"-"===b[b.length-1]}return!1};m.refreshItem=function(b){if(b&&b.items){var a=[];b.items.each(function(d,e){"menuseparator"===d.xtype&&(0<a.length&&"menuseparator"===a[a.length-1].xtype?d.hide():d.show());d.isHidden()||a.push(d);Ext.isFunction(d.getMenu)&&c.Menu.refreshItem(d.getMenu())});0<a.length&&"menuseparator"===a[a.length-1].xtype&&a[a.length-1].hide()}};return m}();c.Menu=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.bindToContainer=function(b,a,d){if(b.muuriGrid)d(b.muuriGrid);else{var e=function(){c.MuuriTool.loadedMuuriJs=!0;var f=null;Ext.isFunction(b.getMuuriGridContainerId)&&(f=b.getMuuriGridContainerId());Ext.isEmpty(f)?console.warn("Muuri\u6e32\u67d3\u5931\u8d25\uff01\u76ee\u6807ID\u4e3a\u7a7a\uff01"):(f=new Muuri("#"+f,a),b.muuriGrid=f,d(f))};this.loadedMuuriJs?e():c.System.addScript({src:c.MuuriTool.muuriJsPath},function(){c.System.addScript({src:c.MuuriTool.webAnimasJsPath},
e)})}};m.justBindToContainer=function(b,a,d){c.MuuriTool.releaseMuuriGrid(b);c.MuuriTool.bindToContainer(b,a,d)};m.getMuuriGrid=function(b){return b.muuriGrid?b.muuriGrid:null};m.releaseMuuriGrid=function(b){var a=c.MuuriTool.getMuuriGrid(b);a&&(a.destroy(!0),b.muuriGrid=null)};m.muuriJsPath="base/muuri/muuri.min.js";m.webAnimasJsPath="base/muuri/web-animations.min.js";return m}();c.MuuriTool=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.safeObject=function(b){return b?b:{}};m.safeSplit=function(b,a){return Ext.isEmpty(b)?[]:b.split(a)};return m}();c.Objects=v})(FastExt||(FastExt={}));var FastOverrider;
(function(c){var v=function(){return function(){var a=Ext.create;Ext.create=function(){for(var e=[],f=0;f<arguments.length;f++)e[f]=arguments[f];try{if(1<e.length&&Ext.isObject(e[1])&&e[1].filter&&e[1].filter.enable){var g=e[1].filter;FastExt.Listeners.fireExtCreateFilter(g.key,g.method,e[0],e[1])}return a.apply(this,e)}catch(h){return FastExt.System.isDebug()&&FastExt.Server.reportException(FastExt.ErrorHandler.geErrorInfo(h)),null}};var d=Ext.scrollbar.size;Ext.scrollbar.size=function(){var e=d.apply(this,
arguments);e.width=8;e.height=8;return e}}}();c.ExtOverrider=v;v=function(){return function(){Ext.override(Ext.Component,{onFastPowerContextMenu:function(a,d,e){a.stopEvent();FastExt.Power.showPowerConfig(this,a)},afterRender:function(){try{FastExt.System.isInitSystem()&&(this.power=FastExt.Base.toBool(this.power,!0))&&(0<this.getXTypes().indexOf("field/")||Ext.Array.contains(FastExt.Power.types,this.getXType()))&&(this.code=FastExt.Power.getPowerCode(this),this.power&&!this.up("[powerUI\x3dfalse]")&&
this.code)&&(this.managerPower=FastExt.Power.checkManagerPower(this),FastExt.Power.setPower(this.code,FastExt.Base.copy(this.managerPower)),FastExt.Power.hasPower(this,"show")?FastExt.Power.hasPower(this,"edit")||(this.editable=!1,Ext.isFunction(this.setReadOnly)&&this.setReadOnly(!0)):(this.hideable=!1,this.setHidden(!0),this.setDisabled(!0),this.clearListeners(),Ext.isFunction(this.collapse)&&this.collapse()),FastExt.Power.config&&(this.powerConfig=FastExt.Power.checkPower(this.code),FastExt.Power.setPowerStyle(this),
this.getEl().on("contextmenu",this.onFastPowerContextMenu,this)))}finally{this.callParent(arguments)}}});Ext.override(Ext.Component,{setDisabled:function(a){return FastExt.Power.config?this.enable():this.callParent(arguments)}});Ext.override(Ext.form.field.Base,{markInvalid:function(a){FastExt.Power.config||this.callParent(arguments)}})}}();c.PowerComponentOverride=v;v=function(){return function(){Ext.override(Ext.Component,{constructor:function(a){this.callParent(arguments);this.addCls("fast-"+this.xtype)},
setZIndex:function(){var a=this.callParent(arguments);(this.justTop||this.cfg&&this.cfg.justTop)&&this.el.setZIndex(FastExt.Component.pageMaxZIndex);return a},refreshAllowBlankTip:function(){FastExt.Base.toBool(this.allowBlank,!0)||Ext.isEmpty(this.fieldLabel)||!this.allowBlankTip||this.setFieldLabel('\x3csvg class\x3d"svgIcon fileIcon redColor fontSize8" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extSnow"\x3e\x3c/use\x3e\x3c/svg\x3e\x26nbsp;'+this.configFieldLabel)},show:function(){try{if(FastExt.System.isInitSystem()&&
("window"===this.getXType()||"messagebox"===this.getXType())&&!FastExt.Base.toBool(this.sessionWin,!1)&&FastExt.System.sessionOutAlert)return this.hide(),null}catch(a){console.error(a)}return this.callParent(arguments)},onResize:function(a,d,e,f){this.callParent(arguments);this.needCacheUI&&(a!==Ext.getBody().getWidth()&&FastExt.Cache.setCache(this.cacheUICode+"Width",a),d!==Ext.getBody().getHeight()&&FastExt.Cache.setCache(this.cacheUICode+"Height",d))},onFastBodyElMouseLeave:function(a){this.helpTip&&
(this.helpTip.close(),this.helpTip=null)},onFastBodyElMouseOver:function(){this.help&&this.buildHelpTip()},onFastBodyElContextMenu:function(){this.help&&this.buildHelpTip()},buildHelpTip:function(){try{var a=this;if(a.helpTip)0<a.helpTip.showDelay?(a.helpTipTimeout&&clearTimeout(a.helpTipTimeout),a.helpTipTimeout=setTimeout(function(){a.helpTip&&a.helpTip.show()},a.helpTip.showDelay)):a.helpTip.show();else{var d=a.help;window.getHelpContent&&(d=window.getHelpContent(a.help));var e=a.helpAnchor;Ext.isEmpty(e)&&
(e="left");var f=a.helpShowDelay;Ext.isEmpty(f)&&(f=0);var g=a.helpMaxWidth;Ext.isEmpty(g)&&(g=500);var h=a.bodyEl;h||(h=a.el);a.helpTip=Ext.create("Ext.tip.ToolTip",{target:h,resizable:!1,anchor:e,anchorOffset:0,autoHide:!1,hideDelay:0,focusOnToFront:!1,maxWidth:g,closeAction:"destroy",hideAction:"destroy",html:d,showDelay:f,autoShow:0===f,listeners:{beforedestroy:function(){a.helpTip=null;a.helpTipTimeout&&clearTimeout(a.helpTipTimeout)},hide:function(){this.close()},move:function(k,l,n,p){l=k.anchor;
n=(a.getWidth()-20)/2;if("left"===l||"right"===l)n=(a.getHeight()-20)/2;Ext.isEmpty(a.helpAnchorOffset)||-1==parseInt(a.helpAnchorOffset)||(n=a.helpAnchorOffset);k.anchorOffset=n}}})}}catch(k){console.error(k)}},finishRender:function(){this.callParent(arguments);try{if(!FastExt.Power.isPower()&&this.help){var a=this.bodyEl;a||(a=this.el);Ext.isEmpty(this.helpType)&&(this.helpType=FastEnum.HelpEnumType.mouse_right_click);a.on("mouseleave",this.onFastBodyElMouseLeave,this);if(this.helpType==FastEnum.HelpEnumType.mouse_right_click)a.on("contextmenu",
this.onFastBodyElContextMenu,this);else if(this.helpType==FastEnum.HelpEnumType.mouse_in_out)a.on("mouseover",this.onFastBodyElMouseOver,this)}}catch(d){console.error(d)}},initComponent:function(){try{this.labelAlign&&!Ext.isEmpty(this.fieldLabel)&&(this.userCls="fast-filefield-label-"+this.labelAlign);this.labelSeparator="";if("default"===this.emptyText&&(this.emptyText="\u8bf7\u586b\u5199",!Ext.isEmpty(this.fieldLabel))){this.emptyText="\u8bf7\u586b\u5199"+this.fieldLabel;var a=this.xtype;this.parentXtype&&
(a=this.parentXtype);if(0<=a.indexOf("combo")||0<=a.indexOf("link")||0<=a.indexOf("date")||0<=a.indexOf("map")||0<=a.indexOf("pca"))this.emptyText="\u8bf7\u9009\u62e9"+this.fieldLabel}this.configFieldLabel=this.fieldLabel;this.refreshAllowBlankTip();this.validateOnChange=this.validateOnBlur=!1;this.collapseToolText=this.closeToolText="\u5173\u95ed";this.expandToolText="\u5c55\u5f00";if(!("window"!==this.getXType()&&"panel"!==this.getXType()||Ext.isEmpty(this.getTitle())&&Ext.isEmpty(this.subtitle))&&
(this.resizable||this.split)){this.cacheUICode=$.md5(this.getTitle()+this.subtitle+$("title").text()+this.width+this.height);var d=FastExt.Cache.getCache(this.cacheUICode+"Width"),e=FastExt.Cache.getCache(this.cacheUICode+"Height"),f=FastExt.Base.toBool(FastExt.Cache.getCache(this.cacheUICode+"Collapse"),this.collapsed);null!=d&&(this.setWidth(d),this.setFlex(0));null!=e&&(this.setHeight(e),this.setFlex(0));this.collapsed=f;this.needCacheUI=!0;this.setCollapsed(f)}FastExt.Base.toBool(this.iframePanel,
!1)&&(this.disabledCls="iframe-disabled-panel");Ext.isEmpty(this.firstCls)||(this.baseCls=this.firstCls+" "+this.baseCls)}catch(g){console.error(g)}finally{this.callParent(arguments)}},destroy:function(){this.callParent(arguments);try{this.tip&&(this.tip.destroy(),this.tip=null),this.menu&&(this.menu.destroy(),this.menu=null)}catch(a){}}})}}();c.ComponentOverride=v;v=function(){return function(){Ext.override(Ext.panel.Panel,{collapse:function(){this.callParent(arguments);this.needCacheUI&&FastExt.Cache.setCache(this.cacheUICode+
"Collapse",!0)},expand:function(a){this.callParent(arguments);this.needCacheUI&&FastExt.Cache.setCache(this.cacheUICode+"Collapse",!1)},onMouseLeaveFloated:function(a){if(FastExt.Base.toBool(this.holdFloatView,!1))this.onMouseEnterFloated(a);else this.callParent(arguments)},close:function(){FastExt.Base.toBool(this.canClose,!0)&&this.callParent(arguments)}})}}();c.PanelOverride=v;v=function(){return function(){Ext.override(Ext.LoadMask,{constructor:function(){this.callParent(arguments);var a=this.getId()+
"-msgEl",d=$("\x3cdiv id\x3d'"+this.getId()+"-anim' style\x3d'height: 70px;width: 70px;'\x3e\x3c/div\x3e");$("#"+a).prepend(d)},getAnimEl:function(){var a=$("#"+this.getId()+"-anim");return 0<a.length?a[0]:null},show:function(){var a=this.getAnimEl();a&&FastExt.Lottie.loadJsonAnimByEl(a,"base/lottie/loading.json");if(this.target&&(this.target.disabledLoadMaskOnce||this.target.disabledLoadMask))return this.target.disabledLoadMaskOnce=!1,this;if(this.isElement)this.ownerCt.mask(this.useMsg?this.msg:
"",this.msgCls),this.fireEvent("show",this);else return this.callParent(arguments)},hide:function(){try{var a=this.getAnimEl();a&&FastExt.Lottie.unloadJsonAnimByEl(a)}catch(d){}return this.callParent(arguments)}})}}();c.LoadMaskOverride=v;v=function(){return function(){Ext.override(Ext.button.Button,{afterRender:function(){try{this.tipText&&(this.tip=new Ext.ToolTip({target:this.el,trackMouse:!0,renderTo:Ext.getBody(),dismissDelay:0,html:this.tipText})),FastExt.Base.toBool(this.local)&&(FastExt.System.isLocal()||
this.setHidden(!0)),this.callParent(arguments)}catch(a){console.error(a)}finally{FastExt.Button.checkGridToolbarButton(this)}}})}}();c.ButtonOverride=v;v=function(){return function(){Ext.override(Ext.grid.Panel,{initComponent:function(){this.callParent(arguments);if(this.ownerGrid)FastExt.Grid.onGridInitComponent(this.ownerGrid);else FastExt.Grid.onGridInitComponent(this)},finishRender:function(){this.callParent(arguments);if(this.ownerGrid)FastExt.Grid.onGridAfterRender(this.ownerGrid);else FastExt.Grid.onGridAfterRender(this)},
destroy:function(){try{this.contextMenu&&this.contextMenu.destroy(),this.columnHeadMenu&&this.columnHeadMenu.destroy(),FastExt.Cache.memory["GridSelectHistory"+this.code]=null}catch(a){}this.callParent(arguments)}});Ext.override(Ext.grid.CellContext,{setRow:function(a){try{if(!this.view)return this;a&&this.callParent(arguments);return this}catch(d){console.error(d)}return this}});Ext.override(Ext.grid.column.Column,{afterRender:function(){try{this.code=FastExt.Power.getPowerCode(this),this.renderer||
(this.renderer=FastExt.Renders.normal()),this.rendererFunction&&(this.renderer=eval(this.rendererFunction)),FastExt.Grid.configColumnProperty(this),FastExt.Grid.configColumnListener(this)}catch(a){console.error(a)}finally{this.callParent(arguments)}},destroy:function(){this.searchMenu&&this.searchMenu.destroy();this.editMenu&&this.editMenu.destroy();this.batchEditMenu&&this.batchEditMenu.destroy();this.callParent(arguments)}});Ext.override(Ext.grid.selection.SpreadsheetModel,{onHeaderClick:function(){this.callParent(arguments)},
deselectAll:function(a,d){FastExt.Base.toBool(d,!1)||this.view&&this.view.ownerGrid&&this.view.ownerGrid.selectHistoryConfig&&1===this.view.ownerGrid.selectHistoryConfig.state&&this.view.ownerGrid.clearSelectRecordHistory();this.callParent(arguments)},selectAll:function(){this.callParent(arguments);this.selected.allSelected=!0},getSelection:function(a){return!FastExt.Base.toBool(a,!1)&&this.view&&this.view.ownerGrid&&this.view.ownerGrid.selectHistoryConfig&&1===this.view.ownerGrid.selectHistoryConfig.state?
this.view.ownerGrid.getSelectRecordHistory():this.callParent(arguments)},getNumbererColumnConfig:function(){var a=this.callParent(arguments);a.text="\u5e8f\u53f7";a.align="center";a.resizable=!0;0<parseInt(a.width)&&(a.width=52);a.configWidth=a.width;return a}});Ext.override(Ext.grid.ColumnLayout,{calculate:function(a){try{this.callParent(arguments)}catch(d){}}})}}();c.GridOverride=v;v=function(){return function(){Ext.override(Ext.data.Store,{constructor:function(){this.callParent(arguments);this.entity&&
(this.autoDestroy=!0)},destroy:function(){try{if(this.columnRenderKey)if(Ext.isArray(this.columnRenderKey))for(var a=0,d=this.columnRenderKey;a<d.length;a++){var e=d[a];FastExt.Cache.memory[e]=null;null==window[e]}else FastExt.Cache.memory[this.columnRenderKey]=null,null==window[this.columnRenderKey];this.entity&&FastExt.Server.destroyList(this.getId())}catch(f){}this.callParent(arguments)}})}}();c.StoreOverride=v;v=function(){return function(){Ext.override(Ext.layout.container.Accordion,{nextCmp:function(a){return(a=
a.next())&&a.isHidden()?this.nextCmp(a):a},prevCmp:function(a){return(a=a.prev())&&a.isHidden()?this.prevCmp(a):a},onBeforeComponentCollapse:function(a){try{var d=this.owner,e=void 0,f=void 0;if(1===this.owner.items.getCount())return!1;this.processing||(this.processing=!0,f=d.deferLayouts,d.deferLayouts=!0,e=this.nextCmp(a)||this.prevCmp(a),e.isHidden()?(d.deferLayouts=f,this.processing=!1,this.onBeforeComponentCollapse(e)):(this.multi||e&&e.expand(),d.deferLayouts=f,this.processing=!1))}catch(g){console.error(g)}}})}}();
c.LayoutOverride=v;v=function(){return function(){Ext.override(Ext.dom.Element,{syncContent:function(a){try{this.callParent(arguments)}catch(d){console.error(d)}},constructor:function(a){this.callParent(arguments)},onFastMouseUp:function(a,d){d&&d.className&&0<=d.className.toString().indexOf("x-tree-elbow-img")?FastExt.Cache.memory.holdGridRecordSelectHistory=!0:FastExt.Cache.memory.holdGridRecordSelectHistory=!1},removeCls:function(){try{return this.getData()?this.callParent(arguments):void 0}catch(a){console.error(a)}return this}})}}();
c.DomOverride=v;v=function(){return function(){Ext.override(Ext.toolbar.Paging,{initComponent:function(){this.inputItemWidth=70;this.callParent(arguments);this.child("#refresh").setIconCls("extIcon extRefresh grayColor");this.on("beforechange",this.onFastBeforeChange,this)},onFastBeforeChange:function(a,d,e){return a.checkStoreUpdate(function(){a.store.loadPage(d)})},checkStoreUpdate:function(a){var d=this;return d.store.entity?0<d.store.getUpdatedRecords().length?(Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192",
"\u5f53\u524d\u9875\u6709\u672a\u63d0\u4ea4\u4fee\u6539\u7684\u6570\u636e\uff0c\u662f\u5426\u63d0\u4ea4\u4fee\u6539\uff1f",function(e,f){"yes"==e?FastExt.Store.commitStoreUpdate(d.store).then(function(){a()}):a()}),!1):!0:!0}})}}();c.ToolbarOverride=v;v=function(){return function(){Ext.override(Ext.util.Grouper,{sortFn:function(a,d){return 0}})}}();c.UtilOverride=v;v=function(){return function(){Ext.override(Ext.resizer.Splitter,{onRender:function(){this.collapseOnDblClick=!1;this.callParent(arguments)}})}}();
c.ResizerOverride=v;v=function(){return function(){Ext.override(Ext.dd.DragTracker,{onMouseDown:function(a){this.callParent(arguments);if(!(this.disabled||a.target&&a.target.className&&(0<=a.target.className.toString().indexOf("x-tool")||0<=a.target.className.toString().indexOf("x-column"))))for(var d=Ext.ComponentQuery.query("[iframePanel\x3dtrue]"),e=0;e<d.length;e++)d[e].oldDisabled=d[e].disabled,d[e].setDisabled(!0)},onMouseUp:function(a){this.callParent(arguments);for(var d=Ext.ComponentQuery.query("[iframePanel\x3dtrue]"),
e=0;e<d.length;e++)d[e].setDisabled(d[e].oldDisabled)},endDrag:function(a){this.callParent(arguments);for(var d=Ext.ComponentQuery.query("[iframePanel\x3dtrue]"),e=0;e<d.length;e++)d[e].setDisabled(d[e].oldDisabled)}})}}();c.DDOverride=v;v=function(){return function(){Ext.override(Ext.form.Basic,{submit:function(a){a=a||{};a.submitEmptyText=!1;a.timeout=180;return this.doAction(a.standardSubmit||this.standardSubmit?"standardsubmit":this.api?"directsubmit":"submit",a)},getValues:function(a,d,e,f,g){for(var h=
this.callParent(arguments),k={},l=0,n=this.getFields().items;l<n.length;l++){var p=n[l];p.extraParams&&(k=FastExt.Json.mergeJson(k,p.extraParams));p.multiSplit&&(k[p.name]=p.getValue().split(p.multiSplit))}return a?h+"\x26"+Ext.Object.toQueryString(k):FastExt.Json.mergeJson(h,k)},isValid:function(){try{var a=void 0;Ext.suspendLayouts();var d="",e=0,f="\u8bf7\u6b63\u786e\u586b\u5199\u6570\u636e\uff01";a=this.getFields().filterBy(function(h){var k=!h.validate();k&&0===e&&(d=h.getFieldLabel(),f=FastExt.Form.getFieldError(h)[0],
e++);return k});Ext.resumeLayouts(!0);var g=1>a.length;g||(Ext.isEmpty(d)?FastExt.Dialog.toast("\u8bf7\u5c06\u6570\u636e\u586b\u5199\u5b8c\u6574\uff01"):Ext.isEmpty(f)?FastExt.Dialog.toast("\u3010"+d+"\u3011\u9519\u8bef\uff01"):FastExt.Dialog.toast("\u3010"+d+"\u3011\u9519\u8bef\uff1a"+f),FastExt.Component.shakeComment(this.owner.ownerCt));return g}catch(h){FastExt.Dialog.showException(h)}}});Ext.override(Ext.form.field.File,{onRender:function(){this.callParent(arguments);this.multiple&&this.fileInputEl&&
this.fileInputEl.dom.setAttribute("multiple","multiple")}});Ext.override(Ext.form.field.Time,{initComponent:function(){this.invalidText="\u65e0\u6548\u7684\u65f6\u95f4\u683c\u5f0f!";this.callParent(arguments)}});Ext.override(Ext.form.field.Text,{validate:function(){var a=this.callParent(arguments);a&&"textfield"===this.xtype&&!this.disabled&&!this.readOnly&&this.useHistory&&this.saveHistory();return a},isUseHistory:function(){return"textfield"===this.xtype&&!this.disabled&&!this.readOnly&&this.useHistory},
isUseLetterKeyboard:function(){return"textfield"===this.xtype&&!this.disabled&&!this.readOnly&&this.letterKeyboard},onChange:function(a,d){this.callParent(arguments);this.isUseHistory()&&this.checkHistory();this.isUseLetterKeyboard()&&document.getElementById(this.getInputId()).setAttribute("type","text")},finishRender:function(){this.callParent(arguments);this.isUseHistory()&&(this.checkHistory(),this.inputEl.on("click",this.onFastHistoryInputClick,this));this.isUseLetterKeyboard()&&document.getElementById(this.getInputId()).setAttribute("type",
"password")},onFastHistoryInputClick:function(){this.checkHistory()&&(this.historyShown?this.hideHistory():this.showHistory())},onFastHideHistoryMenu:function(){var a=this.getEditorMenu();a&&(a.holdShow=!1);this.hideHistoryTask&&this.hideHistoryTask.delay(100)},getHistory:function(){this.code||(this.code=FastExt.Power.getPowerCode(this));var a=FastExt.Cache.getCache(this.code+FastExt.System.getManagerId());this.defaultHistory&&(Ext.isEmpty(a)&&(a={}),a=Ext.Object.merge(a,this.defaultHistory));return a},
checkHistory:function(){var a=this.getHistory();if(a&&0<Object.keys(a).length)return this.getTrigger("history").show(),!0;this.getTrigger("history").hide();return!1},clearHistory:function(){this.code||(this.code=FastExt.Power.getPowerCode(this));FastExt.Cache.setCache(this.code+FastExt.System.getManagerId(),{});FastExt.Dialog.toast("\u5df2\u6e05\u7a7a\u5386\u53f2\u8bb0\u5f55\uff01");this.checkHistory()},showHistory:function(){this.code||(this.code=FastExt.Power.getPowerCode(this));this.hideHistoryTask&&
this.hideHistoryTask.cancel();this.historyMenu&&this.historyMenu.destroy();var a=this,d=a.getEditorMenu();d&&(d.holdShow=!0);this.historyMenu=new Ext.menu.Menu({padding:"0 0 0 0",power:!1,showSeparator:!1,maxHeight:300,style:{background:"#ffffff"},listeners:{hide:{fn:this.onFastHideHistoryMenu,scope:this}}});var e=this.getHistory();if(e){Ext.isArray(e)&&(e={});this.historyMenu.add({text:"\u6e05\u7a7a\u5386\u53f2\u8bb0\u5f55",iconCls:"extIcon extClear",handler:function(){a.clearHistory()}});d=Object.keys(e);
d.sort(function(k,l){k=e[k].date;return FastExt.Dates.parseDate(e[l].date).getTime()-FastExt.Dates.parseDate(k).getTime()});for(var f=0;f<d.length;f++){var g=d[f],h=e[g];this.historyMenu.add({text:FastExt.Base.toMaxString(g,15)+(h.default?"":" [ "+h.date+" ] "),iconCls:h.default?"extIcon extColumn":"extIcon extHistory",realText:g,handler:function(){a.setValue(this.realText);a.fireEvent("selectHistoryValue",a,this.realText)}})}this.historyMenu.showBy(this.bodyEl,"tl-bl?");this.historyShown=!0;this.hideHistoryTask||
(this.hideHistoryTask=new Ext.util.DelayedTask(function(){this.historyShown=!1},this))}},hideHistory:function(){this.historyMenu&&this.historyMenu.close();this.historyShown=!1},saveHistory:function(){var a=this.getValue(),d=FastExt.Cache.getCache(this.code+FastExt.System.getManagerId());d||(d={});Ext.isEmpty(a)||(d[a]={date:Ext.Date.format(new Date,"Y-m-d H:i:s")},FastExt.Cache.setCache(this.code+FastExt.System.getManagerId(),d))},initComponent:function(){try{var a=this;"password"===a.inputType?a.addTriggers({eayOpen:{cls:"extIcon extEye editColor",
hidden:!0,handler:function(){a.up("menu")&&(a.up("menu").holdShow=!0);this.getTrigger("eayOpen").hide();this.getTrigger("eayClose").show();var d=document.getElementById(this.getInputId());d.blur();d.setAttribute("type","password");setTimeout(function(){FastExt.Base.inputFocusEnd(d);a.up("menu")&&(a.up("menu").holdShow=!1)},100)}},eayClose:{cls:"extIcon extNoSee",handler:function(){a.up("menu")&&(a.up("menu").holdShow=!0);this.getTrigger("eayOpen").show();this.getTrigger("eayClose").hide();var d=document.getElementById(this.getInputId());
d.blur();d.setAttribute("type","text");setTimeout(function(){FastExt.Base.inputFocusEnd(d);a.up("menu")&&(a.up("menu").holdShow=!1)},100)}}}):a.isUseHistory()&&a.addTriggers({history:{cls:"extIcon extHistory2",hidden:!0,handler:a.onFastHistoryInputClick}})}finally{this.callParent(arguments)}},destroy:function(){this.historyMenu&&this.historyMenu.destroy();this.callParent(arguments)}});Ext.override(Ext.form.field.ComboBox,{initComponent:function(){try{this.searchable&&(this.editable=!0,this.queryMode=
"local",this.caseSensitive=this.anyMatch=!0,this.validator=function(a){return this.allowBlank?!0:!this.searchable||FastExt.Base.toBool(this.newable,!1)||this.getStore().findRecord(this.valueField,this.getValue(),0,!1,!1,!0)?!0:"\u6570\u636e\u3010"+a+"\u3011\u65e0\u6548\uff0c\u8bf7\u9009\u62e9\u4e0b\u62c9\u6846\u91cc\u7684\u9009\u9879\uff01"})}finally{this.callParent(arguments)}},toggle:function(){this.getPicker().hidden?this.collapse():this.searchable?this.doQuery(this.getRawValue(),!1,!0):this.expand()}})}}();
c.FormOverride=v;v=function(){return function(){Ext.override(Ext.menu.Menu,{hide:function(){if((this.powerMenu||!FastExt.Power.menuShowing)&&!this.holdShow)return this.callParent(arguments)},onShortcutKey:function(){try{this.callParent(arguments)}catch(a){}},delayClose:function(a){(new Ext.util.DelayedTask(this.close,this)).delay(a)}});Ext.override(Ext.menu.Item,{focus:function(){if(!this.isDisabled()&&!this.isDisabled()){var a=this.icon,d=/([^/]*.svg)/;a&&d.test(a)&&(a=FastExt.Server.getIcon(d.exec(a)[1].trim(),
"#ffffff"),(d=Ext.get(this.getId()+"-iconEl"))&&d.setStyle("background-image","url("+a+")"));return this.callParent(arguments)}},onFocusLeave:function(){this.callParent(arguments);if(!this.isDisabled()){var a=this.icon,d=/([^/]*.svg)/;a&&d.test(a)&&(d=Ext.get(this.getId()+"-iconEl"))&&d.setStyle("background-image","url("+a+")")}}})}}();c.MenuOverride=v;v=function(){return function(){Ext.override(Ext.Window,{setIcon:function(a){this.callParent(arguments);var d=/([^/]*.svg)/;a&&d.test(a)&&(this.icon=
FastExt.Server.getIcon(d.exec(a)[1].trim(),"#ffffff"))},restore:function(){Ext.isEmpty(this.oldMaxHeight)||(this.maxHeight=this.oldMaxHeight);Ext.isEmpty(this.oldMaxWidth)||(this.maxWidth=this.oldMaxWidth);return this.callParent(arguments)},maximize:function(){Ext.isEmpty(this.maxHeight)||(this.height=Math.min(this.getHeight(),this.maxHeight),this.oldMaxHeight=this.maxHeight,delete this.maxHeight);Ext.isEmpty(this.maxWidth)||(this.width=Math.min(this.getWidth(),this.maxWidth),this.oldMaxWidth=this.maxWidth,
delete this.maxWidth);return this.callParent(arguments)},afterRender:function(){this.callParent(arguments)},onShowComplete:function(){this.callParent(arguments);this.toFront(!0);this.focus();if(FastExt.Base.toBool(this.autofocusField,!0)){var a=this.query("form");a&&0<a.length&&a[0].getForm().getFields().each(function(d){if(d.readOnly||d.isDisabled())return!0;if("textfield"===d.xtype||"numberfield"===d.xtype||"contentfield"===d.xtype||"textareafield"===d.xtype||"htmlcontentfield"===d.xtype)return d.focus(!0,
100),!1})}},initComponent:function(){try{Ext.isEmpty(this.tools)&&(this.tools=[]),(!this.modal&&0>this.id.indexOf("messagebox")&&FastExt.Base.toBool(this.unpin,!0)||FastExt.Base.toBool(this.unpin,!1))&&this.tools.push({type:"unpin",tooltip:"\u56fa\u5b9a\u7a97\u53e3",callback:function(a,d,e){e=a.getHeader().getTools();"unpin"===d.type?(d.setType("pin"),d.setTooltip("\u53d6\u6d88\u56fa\u5b9a\u7a97\u53e3"),a.canClose=!1):(d.setType("unpin"),d.setTooltip("\u56fa\u5b9a\u7a97\u53e3"),a.canClose=!0);for(a=
0;a<e.length;a++){var f=e[a];if("close"===f.type){"unpin"===d.type?f.show():f.hide();break}}}}),this.animateTarget==window&&(this.animateTarget=null),this.animateTarget||(this.animateTarget=FastExt.Base.getTargetElement(FastExt.System.currClickTarget)),0<=this.getId().indexOf("ghost")&&(this.animateTarget=null),FastExt.Base.toBool(FastExt.System.getExt("window-anim").value,!0)||(this.animateTarget=null),"toast"===FastExt.Base.toString(this.xtype,"")&&(this.animateTarget=null),FastExt.Base.toBool(this.animateDisable,
!1)&&(this.animateTarget=null),this.liveDrag=!0}catch(a){console.error(a)}finally{this.callParent(arguments)}}})}}();c.WindowOverride=v;v=function(){return function(){Ext.override(Ext.window.MessageBox,{confirm:function(a,d,e,f){FastExt.Dialog.showConfirm(a,d,e);return this},prompt:function(a,d,e,f,g,h){FastExt.Dialog.showPrompt(a,d,e,g,h);return this},alert:function(a,d,e,f){FastExt.Dialog.showAlert(a,d,e);return this},show:function(a){this.closeToolText=null;a=a||{};FastExt.Base.toBool(a.progress,
!1)||FastExt.Base.toBool(a.wait,!1)?a.animateTarget=null:(Ext.isEmpty(a.animateTarget)&&(a.animateTarget=FastExt.Base.getTargetElement(FastExt.System.currClickTarget)),FastExt.Base.toBool(FastExt.System.getExt("window-anim").value,!0)||(a.animateTarget=null));return this.callParent(arguments)},onShowComplete:function(){this.callParent(arguments);this.toFront(!0);this.focus()}})}}();c.MessageBoxOverride=v;v=function(){return function(){Ext.override(Ext.tip.ToolTip,{show:function(){m.DRAGGING||this.callParent(arguments)},
onShow:function(){this.callParent(arguments);this.disableDocMouseDown&&Ext.destroy(this.mousedownListener)},onDocMouseDown:function(a){try{this.callParent(arguments)}catch(d){}}})}}();c.TooltipOverride=v;v=function(){return function(){}}();c.TabPanelOverrider=v;v=function(){return function(){Ext.override(Ext.list.Tree,{constructor:function(){this.callParent(arguments);this.element.on("contextmenu",this.onContextMenu,this)},onContextMenu:function(a){var d=a.getTarget("[data-recordId]");d&&(d=d.getAttribute("data-recordId"),
d=this.itemMap[d],this.hasListener("itemcontextmenu")&&this.fireEvent("itemcontextmenu",this,d,a),this.setSelection(d.getNode()))}})}}();c.TreeListOverrider=v;var m=function(){function a(){Ext.override(Ext.ux.BoxReorderer,{startDrag:function(){this.callParent(arguments);a.DRAGGING=!0},endDrag:function(){this.callParent(arguments);a.DRAGGING=!1}})}return a}();c.BoxReordererOverrider=m;for(var b in c)c[b]()})(FastOverrider||(FastOverrider={}));
(function(c){var v=function(){return function(){Ext.define("Ext.plugin.ShowLazyItems",{extend:"Ext.plugin.Abstract",alias:"plugin.showlazyitems",init:function(m){this.callParent(arguments);this.items&&this.eagerInstantiation&&(this.items=m.prepareItems(this.items));m.onShowComplete=Ext.Function.createInterceptor(m.onShowComplete,this.onComponentShow,this)},onComponentShow:function(){this.cmp.add(this.items);this.cmp.onComponentShow=null}})}}();c.Plugins=v})(FastExt||(FastExt={}));
(function(c){var v=function(){return function(){this.edit=this.show=!0}}();c.PowerSet=v;v=function(){function m(){}m.isPower=function(){return window.isPower()};m.hasPower=function(b,a){return b.managerPower&&b.managerPower.hasOwnProperty(a)?b.managerPower[a]:!0};m.checkPower=function(b){this.powers[b]||(this.powers[b]=c.Base.copy(this.defaultPower));b=this.powers[b];if(!Ext.isEmpty(b))for(var a in this.defaultPower)b.hasOwnProperty(a)||(b[a]=this.defaultPower[a]);return b};m.checkManagerPower=function(b){if(!c.System.manager||
!c.System.managerPowers&&(Ext.isEmpty(c.System.manager.managerExtPower)||0===c.System.manager.role.roleType))return null;c.System.managerPowers||(c.System.managerPowers=c.Json.jsonToObject(c.System.manager.managerExtPower));c.System.managerPowers||(c.System.managerPowers={});(b=c.System.managerPowers[b.code])||(b=c.Base.copy(c.Power.defaultPower));for(var a in c.Power.defaultPower)b.hasOwnProperty(a)||(b[a]=c.Power.defaultPower[a]);return b};m.pushPower=function(b,a){this.powers[b]=a};m.setPower=
function(b,a){this.powers[b]||(this.powers[b]=a)};m.getSavePowerData=function(){return Ext.encode(this.powers)};m.getPowerCode=function(b){if(null!=b){if(!Ext.isEmpty(b.code))return b.code;var a=null;if(Ext.isFunction(b.up))if("2.0"===c.System.powerVersion){var d=b.up("[menuContainer\x3dtrue]");d?a=d.getTitle():(d=b.up("window"))&&(a=d.getTitle())}else(d=b.up("window"))&&(a=d.getTitle());b.name&&(a+=b.name);b.title&&(a+=b.title);b.text&&(a+=b.text);b.subtext&&(a+=b.subtext);b.dataIndex&&(a+=b.dataIndex);
Ext.isFunction(b.getFieldLabel)&&Ext.isEmpty(b.getFieldLabel())&&(a+=b.getFieldLabel());if(a)return b.buildCodeText=a,$.md5(a)}return null};m.setPowerStyle=function(b){var a=Ext.all("[code\x3d"+b.code+"]");Ext.each(a,function(d,e){if(e=c.Power.checkPower(b.code))e.show?(d.removeCls("no-show-power"),e.edit?d.removeCls("no-edit-power"):d.addCls("no-edit-power")):d.addCls("no-show-power")})};m.showPowerConfig=function(b,a){if(c.System.isInitSystem()){var d=c.Power.checkPower(b.code);c.Power.menuShowing=
!0;var e=Ext.create("Ext.container.Container",{layout:{type:"vbox",pack:"center"},border:0,defaults:{height:20,power:!1},items:[{xtype:"checkbox",name:"updateAlert",checked:!0,boxLabel:"\u5141\u8bb8\u663e\u793a",value:d.show,listeners:{change:function(f,g,h,k){d.show=g;c.Power.setPowerStyle(b)}}},{xtype:"checkbox",name:"updateAlert",checked:!0,boxLabel:"\u5141\u8bb8\u7f16\u8f91",hidden:!c.Grid.isColumnType(b),value:d.edit,listeners:{change:function(f,g,h,k){d.edit=g;c.Power.setPowerStyle(b)}}}]});
(new Ext.menu.Menu({padding:"0 0 0 10",powerMenu:!0,showSeparator:!1,style:{background:"#ffffff"},items:[e],listeners:{beforehide:function(f,g){c.Power.menuShowing=!1;c.Power.pushPower(b.code,d)}}})).showAt(a.getXY())}};m.types=[FastEnum.PowerType.gridcolumn,FastEnum.PowerType.menuitem,FastEnum.PowerType.button];m.config=!1;m.menuShowing=!1;m.powers=[];m.defaultPower=new c.PowerSet;return m}();c.Power=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.getRenderFunStr=function(b){return c.Cache.getCache(b.getRenderCacheKey())};m.getRenderColumn=function(b,a){try{if(Ext.isFunction(b.getHeaderContainer)){var d=b.getHeaderContainer();if(d)return d.getHeaderAtIndex(a)}}catch(e){console.error(e)}return null};m.getRenderKey=function(b,a,d){b=$.md5(a+":"+b);d||(d={getId:function(){return(new Date).getTime()}});a=$.md5(b+d.getId());d.columnRenderKey||(d.columnRenderKey=[]);d.columnRenderKey.push(a);return $.md5(b+
d.getId())};m.onClickFromDataClick=function(b){b=Ext.util.Base64.decode($(b).attr("data-click-function"));eval(b)};m.toSingleLineText=function(b){return Ext.isEmpty(b)?this.toEmptyTip():b.toString().replace(RegExp("\n","g"),"").replace(RegExp("\t","g"),"").replace(/<\/?.+?>/g,"")};m.toHtmlContent=function(b){return Ext.isEmpty(b)?this.toEmptyTip():b.toString().replace(RegExp("\n","g"),"\x3cbr/\x3e").replace(RegExp("\t","g"),"\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;").replace(RegExp(" ","g"),"\x26nbsp;")};
m.toEmptyTip=function(){return c.Renders.toEmpty("\u65e0")};m.toEmpty=function(b){Ext.isEmpty(b)&&(b="\u65e0");return"\x3cspan style\x3d'color: #ccc;'\x3e"+b+"\x3c/span\x3e"};m.toClickText=function(b,a){return c.Power.config?b:'\x3cspan class\x3d"fast-grid-click" data-click-function\x3d"'+Ext.util.Base64.encode(a)+'" onclick\x3d"FastExt.Renders.onClickFromDataClick(this)" \x3e'+b+"\x3c/span\x3e"};m.normal=function(b,a){return function(d,e,f,g,h,k,l,n){if(Ext.isEmpty(d))return c.Renders.toEmptyTip();
b||(b="");if(Ext.isEmpty(a))d+=b;else{if("left"===a||"l"===a||c.Base.toBool(a,!1))d=b+d;if("right"===a||"r"===a)d+=b}return n?c.Renders.toHtmlContent(d):c.Renders.toSingleLineText(d)}};m.money=function(){return function(b,a,d,e,f){return c.Power.config?b:Ext.isEmpty(b)?c.Renders.toEmptyTip():"\uffe5"+c.Renders.toSingleLineText(b)}};m.text=function(){return function(b,a,d,e,f,g,h,k){return c.Power.config?b:Ext.isEmpty(b)?c.Renders.toEmptyTip():k?c.Renders.toHtmlContent(b):"\x3cspan style\x3d'white-space: pre;'\x3e"+
c.Renders.toSingleLineText(b)+"\x3c/span\x3e"}};m.bigText=function(){return function(b,a,d,e,f,g,h){if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return c.Renders.toEmptyTip();a=c.Renders.getRenderKey(f,e,g);c.Cache.memory[a]=b;return"\x26nbsp;\x3cspan onclick\x3d\"FastExt.Dialog.showText(null,null,'\u67e5\u770b\u5185\u5bb9',MemoryCache['"+(a+"'])\"  class\x3d'fast-grid-action'  \x3e")+c.Base.getSVGIcon("extSee")+"\x26nbsp;\u67e5\u770b\u5185\u5bb9\x3c/span\x3e\x26nbsp;"}};m.bigText2=function(){return function(b,
a,d,e,f,g,h){if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return c.Renders.toEmptyTip();a=c.Renders.getRenderKey(f,e,g);c.Cache.memory[a]=b;return c.Renders.toClickText(b,"FastExt.Dialog.showText(null,null,'\u67e5\u770b\u5185\u5bb9',MemoryCache['"+a+"'])")}};m.image=function(b,a){return function(d,e,f,g,h,k,l,n){try{if(c.Power.config)return d;var p=c.Renders.getRenderKey(h,g,k);e="14px";f="auto";if(Ext.isEmpty(d)||"null"===d)return"\x3cimg style\x3d'object-fit: cover; border:1px solid #cccccc;height:"+
e+";' src\x3d'images/default_img.png'   alt\x3d'' /\x3e";d.startWith("//")&&(d="http:"+d);try{b&&Ext.isNumber(b)&&(e=b+"px"),a&&Ext.isNumber(a)&&(f=a+"px")}catch(u){}var q=d.split("@")[0],r=q.substring(q.lastIndexOf("/")+1);if(c.FileModule.json().match(r))return"\x26nbsp;\x3cspan onclick\x3d\"FastExt.Dialog.showLottie(this,'"+c.System.formatUrlVersion(q)+"')\"  class\x3d'fast-grid-action'  \x3e"+c.Base.getSVGIcon("extSee")+"\x26nbsp;\u67e5\u770b\u52a8\u6548\x3c/span\x3e\x26nbsp;";window[p]="\x3cimg  alt\x3d'' style\x3d'object-fit: cover;border:1px solid #cccccc;width: 100px; min-height:14px;  '  width\x3d'100'  class\x3d'lazyload' onerror\x3d\"javascript:this.src \x3d 'images/default_img.png';\" src\x3d'"+
q+"' /\x3e";c.Cache.memory[p]=q;return"\x3cimg class\x3d'lazyload'  alt\x3d'' data-details-id\x3d'"+p+"'  data-container-id\x3d'"+(l?l.getId():"none")+"'  style\x3d'object-fit: cover;border:1px solid #cccccc;height:"+e+";width: "+f+"; min-width:14px; min-height:14px; ' width\x3d'"+f.replace("px","")+"' height\x3d'"+e.replace("px","")+"'  onclick\x3d\"FastExt.Dialog.showImage(this,'"+p+"')\"   onerror\x3d\"javascript:this.src \x3d 'images/default_img.png';\" src\x3d'"+c.Image.smallOSSImgUrl(q)+"'  /\x3e"}catch(u){return console.error(u),
"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u56fe\u7247\x3c/span\x3e"}}};m.image2=function(){return function(b,a,d,e,f,g,h){if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return c.Renders.toEmptyTip();a=c.Renders.getRenderKey(f,e,g);c.Cache.memory[a]=b;return c.Renders.toClickText("\u67e5\u770b\u56fe\u7247","FastExt.Dialog.showImage(this,'"+a+"')")}};m.mp4=function(b){return function(a,d,e,f,g){if(c.Power.config)return a;if(Ext.isEmpty(a)||"null"===a)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u6587\u4ef6\x3c/span\x3e";
d=a.split("@");e=d[0];a=e.substring(e.lastIndexOf("/")+1);1<d.length&&(a=d[1]);b&&(a="\u64ad\u653e\u89c6\u9891");d="FastExt.Dialog.showVideo(this,'"+c.System.formatUrlVersion(e)+"');";return c.Renders.toClickText("\x3cspan style\x3d'margin-right: 5px;'\x3e"+c.Base.getSVGIcon("extFileMP4")+"\x3c/span\x3e"+a,d)}};m.mp3=function(){return function(b,a,d,e,f){if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u6587\u4ef6\x3c/span\x3e";a=b.split("@");
d=a[0];b=d.substring(d.lastIndexOf("/")+1);1<a.length&&(b=a[1]);a="FastExt.Dialog.showMusic(this,'"+c.System.formatUrlVersion(d)+"');";return c.Renders.toClickText("\x3cspan style\x3d'margin-right: 5px;'\x3e"+c.Base.getSVGIcon("extFileMP3")+"\x3c/span\x3e"+b,a)}};m.office=function(){return function(b,a,d,e,f,g,h,k){if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u6587\u4ef6\x3c/span\x3e";e=b.split("@");d=e[0];f=d.split("?")[0];a=f.substring(f.lastIndexOf("/")+
1);1<e.length&&(a=e[1]);e=c.Base.getSVGClassName(f,a);b="\x26nbsp;\x3cspan onclick\x3d\"FastExt.File.officeViewer('"+(c.System.formatUrlVersion(b)+"')\"  class\x3d'fast-grid-action'  \x3e")+c.Base.getSVGIcon("extEye")+"\x26nbsp;\u9884\u89c8\x3c/span\x3e\x26nbsp;";d=" FastExt.Base.openUrl('"+c.System.formatUrlVersion(d)+"','_blank')";return b+c.Renders.toClickText("\x3cspan style\x3d'margin-right: 5px;'\x3e"+c.Base.getSVGIcon(e)+"\x3c/span\x3e"+a,d)}};m.file=function(b){return function(a,d,e,f,g,h,
k,l){if(c.Power.config)return a;if(Ext.isEmpty(a)||"null"===a)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u6587\u4ef6\x3c/span\x3e";var n=a.split("@"),p=n[0],q=p.split("?")[0],r=q.substring(q.lastIndexOf("/")+1);1<n.length&&(r=n[1]);Ext.isEmpty(b)||(r=e.get(b));if(c.FileModule.image().match(q,r))return c.Renders.image()(a,d,e,f,g,h,k,l);if(c.FileModule.mp4().match(q,r))return c.Renders.mp4()(a,d,e,f,g,h,k,l);if(c.FileModule.pdf().match(q,r)||c.FileModule.word().match(q,r)||c.FileModule.excel().match(q,
r)||c.FileModule.ppt().match(q,r))return c.Renders.office()(a,d,e,f,g,h,k,l);a=c.Base.getSVGClassName(q,r);p=" FastExt.Base.openUrl('"+c.System.formatUrlVersion(p)+"','_blank')";return c.Renders.toClickText("\x3cspan style\x3d'margin-right: 5px;'\x3e"+c.Base.getSVGIcon(a)+"\x3c/span\x3e"+r,p)}};m.files=function(){return function(b,a,d,e,f,g,h,k){if(c.Power.config)return b;try{if(Ext.isEmpty(b)||"null"===b)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u6587\u4ef6\x3c/span\x3e";var l=b;if(Ext.isString(b)&&
!Ext.isEmpty(b))try{l=Ext.decode(b)}catch(w){console.error(w)}if(0===l.length)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u6587\u4ef6\x3c/span\x3e";var n=c.Renders.getRenderKey(f,e,g);f="";for(var p=!1,q=!1,r=0;r<l.length;r++){var u=l[r];if(!p){var t=u.split("@");p=1<t.length;q=2<t.length}f+="\x3cdiv style\x3d'margin: 5px;display: inline-block;'\x3e"+c.Renders.file()(u,a,d,e,r,g,h,k)+"\x3c/div\x3e"}if(k)return f;c.Cache.memory[n]="\x3cdiv style\x3d'overflow: scroll;max-height: 300px;'\x3e"+
f+"\x3c/div\x3e";c.Cache.memory[n+"Val"]=b;b="FastExt.File.showFiles(this,null,[FastExt.FileModule.file()],MemoryCache['"+n+"Val'],'\u67e5\u770b\u9644\u4ef6',true,"+p+","+q+")";window[n]=f;return'\x26nbsp;\x3cspan onclick\x3d"'+b+"\"   data-details-id\x3d'"+n+"' class\x3d'fast-grid-action'  \x3e"+c.Base.getSVGIcon("extFolder")+"\x26nbsp;\u5171\u6709"+l.length+"\u4e2a\u6587\u4ef6\x3c/span\x3e\x26nbsp;"}catch(w){return console.error(w),"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u6587\u4ef6\x3c/span\x3e"}}};
m.images=function(){return function(b,a,d,e,f,g,h,k){try{if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u56fe\u7247\x3c/span\x3e";var l=b;if(Ext.isString(b)&&!Ext.isEmpty(b))try{l=Ext.decode(b)}catch(q){console.error(q)}if(0===l.length)return"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u56fe\u7247\x3c/span\x3e";var n=c.Renders.getRenderKey(f,e,g);b="";f=[];for(var p=0;p<l.length;p++)b+=c.Renders.image(24)(l[p],a,d,e,p,g,h,k)+"\x26nbsp;\x26nbsp;",
f.push({url:l[p]});if(k)return b;c.Cache.memory[n]=f;a="FastExt.Dialog.showImage(null,MemoryCache['"+n+"'])";window[n]=b;return'\x26nbsp;\x3cspan onclick\x3d"'+a+"\"   data-details-id\x3d'"+n+"' class\x3d'fast-grid-action'  \x3e"+c.Base.getSVGIcon("extImage")+"\x26nbsp;\u5171\u6709"+l.length+"\u5f20\u56fe\u7247\x3c/span\x3e\x26nbsp;"}catch(q){return console.error(q),"\x3cspan style\x3d'color: #ccc;'\x3e\u6682\u65e0\u56fe\u7247\x3c/span\x3e"}}};m.html=function(){return function(b,a,d,e,f,g,h,k){if(c.Power.config)return b;
if(Ext.isEmpty(b)||"null"===b)return c.Renders.toEmptyTip();a=c.Renders.getRenderKey(f,e,g);c.Cache.memory[a]=b;return"\x26nbsp;\x3cspan onclick\x3d\"FastExt.Dialog.showEditorHtml(this,'\u67e5\u770b\u5185\u5bb9',MemoryCache['"+(a+"'])\"  class\x3d'fast-grid-action'  \x3e")+c.Base.getSVGIcon("extSee")+"\x26nbsp;\u67e5\u770b\u5185\u5bb9\x3c/\x3e\x26nbsp;"}};m.html2=function(){return function(b,a,d,e,f,g,h,k){return c.Power.config?b:Ext.isEmpty(b)||"null"===b?c.Renders.toEmptyTip():k?b:c.Renders.toSingleLineText(b)}};
m.json=function(){return function(b,a,d,e,f,g,h){if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return c.Renders.toEmptyTip();a=c.Renders.getRenderKey(f,e,g);c.Cache.memory[a]=b;a="FastExt.Dialog.showJson(this,'\u67e5\u770bJSON\u5185\u5bb9',MemoryCache['"+a+"'])";return c.Renders.toClickText(c.Renders.toSingleLineText(b),a)}};m.json2=function(){return function(b,a,d,e,f,g,h){if(c.Power.config)return b;if(Ext.isEmpty(b)||"null"===b)return c.Renders.toEmptyTip();a=c.Renders.getRenderKey(f,
e,g);c.Cache.memory[a]=b;return c.Renders.toClickText("\u67e5\u770bJSON\u5185\u5bb9","FastExt.Dialog.showJson(this,'\u67e5\u770bJSON\u5185\u5bb9',MemoryCache['"+a+"'])")}};m.link=function(b,a,d){return function(e,f,g,h,k){if(c.Power.config)return e;try{var l=g.get(b);if(Ext.isEmpty(e)||"null"===e)return c.Renders.toEmpty(l);f="new "+a+"().showDetails(null, {'t."+d+"':'"+l+"'})";return c.Renders.toClickText(c.Renders.toSingleLineText(e),f)}catch(n){return console.error(n),c.Renders.toEmptyTip()}}};
m.target=function(b,a,d){return function(e,f,g,h,k){if(c.Power.config)return e;try{if(Ext.isEmpty(e)||"null"===e)return c.Renders.toEmptyTip();d||(d="getTargetEntity");if(!Ext.isFunction(window[d]))return e;var l=g.get(a),n=g.get(b),p=window[d](l,a);if(p){var q="new "+p.entityCode+"().showDetails(null, {'t."+p.entityId+"':'"+n+"'})";return c.Renders.toClickText(c.Renders.toSingleLineText(e),q)}return e}catch(r){return console.error(r),c.Renders.toEmptyTip()}}};m.map=function(b,a,d){return function(e,
f,g,h,k){if(c.Power.config)return e;try{if(Ext.isEmpty(e)||"null"===e)return c.Renders.toEmptyTip();var l=g.get(b),n=g.get(a),p=g.get(d);return l&&n?(f=l+","+n,g="FastExt.Map.showAddressInMap(null,'"+f+"','','"+e+"')",p&&(g="FastExt.Map.showAddressInMap(null,'"+f+"','"+p+"','"+e+"')"),c.Renders.toClickText(e,g)):e}catch(q){return c.Renders.toEmptyTip()}}};m.mapImgLayer=function(b,a,d,e,f,g,h){return function(k,l,n,p,q){if(c.Power.config)return k;try{if(Ext.isEmpty(k)||"null"===k)return c.Renders.toEmptyTip();
var r=n.get(b),u=n.get(a),t=n.get(d),w=n.get(e);w&&(r=c.Image.rotateOSSImgUrl(r,w));var z=n.get(f);Ext.isEmpty(z)&&(z=6);var x=n.get(g),y=n.get(h);Ext.isEmpty(x)&&(x=1);Ext.isEmpty(y)&&(y=20);return r&&u&&t?c.Renders.toClickText(k," FastExt.Map.showImgLayerInMap(null,'"+r+"','"+u+"','"+t+"',"+z+","+x+","+y+")"):k}catch(A){return c.Renders.toEmptyTip()}}};m.password=function(){return function(b,a,d,e,f){return c.Power.config?b:Ext.isEmpty(b)?c.Renders.toEmptyTip():"\x3cspan\x3e******\x3c/span\x3e"}};
m.href=function(b){return function(a,d,e,f,g){if(c.Power.config)return a;Ext.isEmpty(b)&&(b=a);return Ext.isEmpty(a)||"null"===a?c.Renders.toEmptyTip():c.Renders.toClickText(a,"FastExt.Base.openUrl('"+b+"','_blank')")}};m.fileSize=function(){return function(b,a,d,e,f){if(c.Power.config)return b;try{return Ext.isEmpty(b)||"null"===b?c.Renders.toEmptyTip():1048576<=b?(b/1024/1024).toFixed(2)+"M":1024<=b?(b/1024).toFixed(2)+"KB":b+"B"}catch(g){return console.error(g),c.Renders.toEmptyTip()}}};m.duration=
function(){return function(b,a,d,e,f){if(c.Power.config)return b;try{if(Ext.isEmpty(b)||"null"===b)return c.Renders.toEmptyTip();var g=parseInt(b)/1E3,h=parseInt((g/3600).toString()),k=parseInt((g/60%60).toString()),l=parseInt((g%60).toString());return 0<h?h+"\u65f6"+k+"\u5206"+l+"\u79d2":0<k?k+"\u5206"+l+"\u79d2":l+"\u79d2"}catch(n){return console.error(n),c.Renders.toEmptyTip()}}};m.dateFormat=function(b){return function(a,d,e,f,g){if(c.Power.config)return a;try{if(Ext.isEmpty(a)||"null"===a)return c.Renders.toEmptyTip();
Ext.isEmpty(b)&&(b="Y-m-d H:i:s");var h=c.Base.guessDateFormat(a);e.set();return Ext.Date.format(Ext.Date.parse(a,h),b)}catch(k){return console.error(k),a}}};m.dateFormatTip=function(b,a){return function(d,e,f,g,h){if(c.Power.config)return d;try{if(Ext.isEmpty(d)||"null"===d)return c.Renders.toEmptyTip();var k=c.Base.guessDateFormat(d),l=Ext.Date.parse(d,k);return c.Dates.formatDateTip(l,b,a)}catch(n){return console.error(n),d}}};m.timestamp=function(b){return function(a,d,e,f,g){if(c.Power.config)return a;
try{if(Ext.isEmpty(a)||"null"===a)return c.Renders.toEmptyTip();Ext.isEmpty(b)&&(b="Y-m-d H:i:s");return Ext.Date.format(new Date(parseInt(a)),b)}catch(h){return console.error(h),a}}};m.timestampTip=function(b,a){return function(d,e,f,g,h){if(c.Power.config)return d;try{return Ext.isEmpty(d)||"null"===d?c.Renders.toEmptyTip():c.Dates.formatDateTip(new Date(parseInt(d)),b,a)}catch(k){return console.error(k),d}}};m.enum=function(b,a,d){return function(e,f,g,h,k,l,n,p){if(c.Power.config)return e;try{if(Ext.isEmpty(e))return c.Renders.toEmptyTip();
Ext.isEmpty(d)&&(d="text");Ext.isEmpty(a)&&(a="id");return"\x3cdiv style\x3d'display: inline;' data-set\x3d'false' data-enum\x3d'"+b+"' data-enum-value\x3d'"+a+"' data-enum-text\x3d'"+d+"' data-id\x3d'"+e+"'\x3e\x3cspan style\x3d'color: #ccc;'\x3e"+(e+"\x3c/span\x3e\x3c/div\x3e")}finally{c.Store.getEnumDataByRender(b)}}};m.exception=function(){return function(b,a,d,e,f,g,h){if(c.Power.config)return b;try{if(Ext.isEmpty(b))return c.Renders.toEmptyTip();var k=c.Renders.getRenderKey(f,e,g);c.Cache.memory[k]=
b;return"\x26nbsp;\x3cspan onclick\x3d\"FastExt.Dialog.showCode(null,MemoryCache['"+(k+"'])\"  class\x3d'fast-grid-action'  \x3e")+c.Base.getSVGIcon("extSee")+"\x26nbsp;\u67e5\u770b\u5f02\u5e38\u5185\u5bb9\x3c/span\x3e\x26nbsp;"}catch(l){return"\x3cspan style\x3d'color: #ccc;'\x3e"+b+"\x3c/span\x3e"}}};m.color=function(){return function(b,a,d,e,f){if(c.Power.config)return b;try{return Ext.isEmpty(b)?c.Renders.toEmptyTip():"\x3cdiv style\x3d'background: "+c.Color.toColor(b)+";padding: 0 25px;height: 14px;display: inline;'\x3e\x3c/div\x3e"}catch(g){return"\x3cspan style\x3d'color: #ccc;'\x3e"+
b+"\x3c/span\x3e"}}};return m}();c.Renders=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){m.initExtAjaxConfig();m.initJQueryConfig()}m.getGlobalParams=function(){return{fromOS:c.Base.getOS(),managerWeb:!0,webVersion:c.System.getExt("version").value,__browser:Ext.browser.name,__managerId:c.System.getManagerId()}};m.initExtAjaxConfig=function(){Ext.Ajax.on("beforerequest",function(b,a,d){try{c.Server.isSilenceRequest()||(c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).set(0),c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).animate(.7))}catch(e){}finally{a=
c.Server.getGlobalParams(),a.__httpTool="extjs",b.setExtraParams(a)}});Ext.Ajax.on("requestcomplete",function(b,a,d){try{if(203===a.status)c.System.sessionOut();else if(204===a.status)c.System.sessionOut("\u60a8\u7684\u8d26\u6237\u5df2\u5728\u5176\u4ed6\u7ec8\u7aef\u767b\u5f55\uff01");else if(403===a.status)c.Dialog.showAlert("\u8bf7\u6c42\u5f02\u5e38",a.responseText);else try{var e=eval("("+a.responseText+")");203!==e.code&&204!==e.code||c.System.sessionOut(e.message)}catch(f){}}catch(f){}finally{c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).animate(1),
c.Server.checkVersion(a),c.Server.checkManager(a)}});Ext.Ajax.on("requestexception",function(b,a,d,e){try{c.Server.isSilenceRequest()||c.Dialog.showException(a.responseText,"\u8bf7\u6c42\u5f02\u5e38\uff01")}catch(f){}finally{c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).animate(1)}})};m.initJQueryConfig=function(){$(document).ajaxStart(function(b){try{c.Server.isSilenceRequest()||(c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).set(0),
c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).animate(.7))}catch(a){}finally{$.ajaxSetup({data:c.Server.getGlobalParams()})}});$(document).ajaxComplete(function(b,a,d){try{if(203===a.status)c.System.sessionOut();else if(204===a.status)c.System.sessionOut("\u60a8\u7684\u8d26\u6237\u5df2\u5728\u5176\u4ed6\u7ec8\u7aef\u767b\u5f55\uff01");else if(403===a.status)c.Dialog.showAlert("\u8bf7\u6c42\u5f02\u5e38",a.responseText);else try{var e=eval("("+a.responseText+")");203!==
e.code&&204!==e.code||c.System.sessionOut(e.message)}catch(f){}}catch(f){}finally{c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).animate(1),c.Server.checkVersion(a),c.Server.checkManager(a)}});$(document).ajaxError(function(b,a,d){try{c.Server.isSilenceRequest()||c.Dialog.showException(a.responseText,"\u8bf7\u6c42\u5f02\u5e38")}catch(e){}finally{c.System.getProgressLine(c.Color.toColor(c.System.getExt("front-color").value)).animate(1)}})};m.checkVersion=function(b){try{if(!c.Power.isPower()&&
Ext.isFunction(b.getResponseHeader)){var a=b.getResponseHeader("Project-Version-Code");if(!c.Base.toBool(b.getResponseHeader("Project-Debug"),!0)&&!Ext.isEmpty(a)&&parseInt(a)>parseInt(c.System.getExt("version").value)&&!(0<$("#newVersionTip").length)){$("body").append($("\x3cdiv id\x3d'newVersionTip' style\x3d'position: fixed;right: 50px;bottom: 50px;width: 160px;height: 160px;z-index: 2147483647;cursor: pointer;'\x3e\x3c/div\x3e"));var d=$("#newVersionTip");c.Lottie.loadJsonAnimByEl(d[0],"base/lottie/new_version.json");
d.on("click",function(){location.reload()})}}}catch(e){}};m.checkManager=function(b){if(Ext.isFunction(b.getResponseHeader)&&c.System.manager&&(b=b.getResponseHeader("Project-Manager-ID"),!Ext.isEmpty(b)&&$.md5(c.System.getManagerId().toString())!==b&&!Ext.getCmp("ManagerInfoChangeWin"))){b=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",layout:{type:"vbox",pack:"center",align:"middle"},defaults:{margin:"5 5 5 5"},border:0,items:[{xtype:"lottie",width:150,height:120,jsonPath:"base/lottie/error_normal.json"},
{xtype:"label",maxWidth:250,margin:"5 5 10 5",html:"\u7cfb\u7edf\u68c0\u6d4b\u5230\u60a8\u7684\u767b\u5f55\u4fe1\u606f\u53d1\u751f\u53d8\u5316\uff0c\u5efa\u8bae\u60a8\u5237\u65b0\u9875\u9762\uff01"}]});var a=Ext.create("Ext.window.Window",{title:"\u8d26\u6237\u63d0\u9192",iconCls:"extIcon extManager",id:"ManagerInfoChangeWin",width:280,layout:{type:"vbox",pack:"center",align:"middle"},constrain:!0,resizable:!1,animateDisable:!0,items:[b],modal:!0,buttons:["-\x3e",{text:"\u77e5\u9053\u4e86",iconCls:"extIcon extOk",
handler:function(){a.close()}},{text:"\u7acb\u5373\u5237\u65b0",iconCls:"extIcon extReset",handler:function(){location.reload()}},"-\x3e"]});a.show()}};m.isSilenceRequest=function(){return c.Base.toBool(m.silence,!1)};m.setSilence=function(b){m.silence=b};m.loginUrl=function(){return"controller/login"};m.validOperateUrl=function(){return"controller/valid"};m.showConfigUrl=function(){return"showConfig"};m.importEntityExcelUrl=function(){return"entity/importData"};m.loadEntityDataUrl=function(){return"entity/loadData"};
m.logout=function(b){Ext.isEmpty(b)&&(b="\u6b63\u5728\u9000\u51fa\u767b\u5f55\u4e2d\u2026\u2026");c.Dialog.showWait(b);$.post("controller/logout",function(){location.reload()})};m.updateEntity=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/update",b,function(d){203!==d.code&&Ext.isFunction(a)&&(d.success?a(!0,d.message):a(!1,d.message))})};m.updateDBEntity=function(b,a){c.Power.isPower()?
a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/batchUpdate",b,function(d){203!==d.code&&Ext.isFunction(a)&&(d.success?a(!0,d.message):a(!1,d.message))})};m.replaceDBEntity=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/replace",b,function(d){203!==d.code&&Ext.isFunction(a)&&
(d.success?a(!0,d.message):a(!1,d.message))})};m.deleteAttach=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("deleteAttach",b,function(d){203!==d.code&&Ext.isFunction(a)&&(d.success?a(!0,d.message):a(!1,d.message))})};m.deleteEntity=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
$.post("entity/delete",b,function(d){203!==d.code&&Ext.isFunction(a)&&a(d.success,d.message)})};m.rebackEntity=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/reback",b,function(d){203!==d.code&&Ext.isFunction(a)&&a(d.success,d.message)})};m.copyEntity=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
$.post("entity/copy",b,function(d){203!==d.code&&Ext.isFunction(a)&&(d.success?a(!0,d.message):a(!1,d.message))})};m.clearEntity=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/clear",b,function(d){203!==d.code&&Ext.isFunction(a)&&(d.success?a(!0,d.message):a(!1,d.message))})};m.clearRepeatEntity=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
$.post("entity/repeat",b,function(d){203!==d.code&&Ext.isFunction(a)&&(d.success?a(!0,d.message):a(!1,d.message))})};m.showExtConfig=function(b,a,d){c.Power.isPower()?d(!1):$.post("ext/config/showExtConfig",{configKey:b,configType:a},function(e){Ext.isFunction(d)&&(e.success?d(!0,e.data.configValue,e.message):d(!1,null,e.message))})};m.saveExtConfig=function(b,a,d,e,f){c.Power.isPower()?e(!1):(b={configKey:b,configType:a,configValue:d},Ext.isEmpty(f)||(b=c.Json.mergeJson(b,f)),$.post("ext/config/saveExtConfig",
b,function(g){Ext.isFunction(e)&&(g.success?e(!0,g.message):e(!1,g.message))}))};m.deleteExtConfig=function(b,a,d){c.Power.isPower()?d(!1):$.post("ext/config/deleteExtConfig",{configKey:b,configType:a},function(e){Ext.isFunction(d)&&(e.success?d(!0,e.message):d(!1,e.message))})};m.exportExcel=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/export",b,function(d){203!==d.code&&
Ext.isFunction(a)&&(d.success?a(!0,d.data,d.message):a(!1,null,d.message))})};m.excelModule=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u751f\u6210\u6a21\u677f\uff01"):$.post("entity/module",b,function(d){203!==d.code&&Ext.isFunction(a)&&(d.success?a(!0,d.data,d.message):a(!1,null,d.message))})};m.showColumns=function(b,a,d){d||(d={});$.post("ext/config/showEntityColumn?entityCode\x3d"+b,d,function(e){Ext.isFunction(a)&&
(e.success?a(!0,e.data.configValue,e.message):a(!1,null,e.message))})};m.getIcon=function(b,a){b="icons/"+b;if(Ext.isEmpty(a))return b;a.startWith("#")&&(a=a.substring(1));return"icon?path\x3d"+b+"\x26color\x3d"+a};m.showSystemConfig=function(b){$.post("ext/config/showSystemConfig",function(a){Ext.isFunction(b)&&(a.success?b(!0,a.data,a.message):b(!1,null,a.message))})};m.deleteSystemConfig=function(b){$.post("ext/config/deleteSystemConfig",function(a){Ext.isFunction(b)&&b(a.success,a.message)})};
m.loadMonitor=function(b){m.setSilence(!0);$.post("monitor",function(a){m.setSilence(!1);Ext.isFunction(b)&&b(a.success,a.data)})};m.countReport=function(b){c.Power.isPower()?b(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("countReport",function(a){Ext.isFunction(b)&&b(a.success,a.data)})};m.checkWaitNotice=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
(m.setSilence(!0),$.post("controller/waitNotice",b,function(d){m.setSilence(!1);Ext.isFunction(a)&&a(d.success,d.data)}))};m.doneWaitNotice=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("controller/doneNotice",{noticeId:b},function(d){Ext.isFunction(a)&&a(d.success,d.message,d.data)})};m.clearWaitNotice=function(b){c.Power.isPower()?b(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
$.post("controller/clearNotice",function(a){Ext.isFunction(b)&&b(a.success,a.message,a.data)})};m.downData=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/downData",b,function(d){Ext.isFunction(a)&&a(d.success,d.message,d.data)})};m.updateAllLayer=function(b){c.Power.isPower()?b(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
$.post("updateAllLayer",function(a){Ext.isFunction(b)&&b(a.success,a.message)})};m.updateAllSame=function(b){c.Power.isPower()?b(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("updateAllSame",function(a){Ext.isFunction(b)&&b(a.success,a.message)})};m.updateLayer=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
$.post("entity/updateLayer",b,function(d){Ext.isFunction(a)&&a(d.success,d.message)})};m.updateSame=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/updateSame",b,function(d){Ext.isFunction(a)&&a(d.success,d.message)})};m.showEcharts=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):
$.post("entity/echarts",b,function(d){Ext.isFunction(a)&&a(d.success,d.message,d.data)})};m.saveCache=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("saveToCache",{source:b},function(d){Ext.isFunction(a)&&a(d.success,d.message,d.data)})};m.reportException=function(b){try{Ext.isEmpty(b)||"null"===b||(Ext.isObject(b)&&(b=c.Json.objectToJson(b)),0<=b.indexOf("\u8868\u5355\u586b\u5199\u4e0d\u5b8c\u6574")||
$.post("base/system/tool/jsException",{jsException:b},function(a){c.System.isDebug()&&c.System.isLocal()&&a.success&&c.Dialog.toast("\u5df2\u4e0a\u62a5JS\u9519\u8bef\uff01")}))}catch(a){}};m.loadSource=function(b,a){c.Power.isPower()?a(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/loadSource",{entityCode:b},function(d){Ext.isFunction(a)&&a(d.success,d.message,d.data)})};m.saveSource=function(b,a,d){c.Power.isPower()?
d(!1,"\u5f53\u524d\u6b63\u5728\u8fdb\u884c\u754c\u9762\u6743\u9650\u914d\u7f6e\uff0c\u4e0d\u53ef\u64cd\u4f5c\u6570\u636e\uff01"):$.post("entity/saveSource",{entityCode:b,content:a},function(e){Ext.isFunction(d)&&d(e.success,e.message,e.data)})};m.destroyList=function(b){c.Power.isPower()||$.post("entity/destroyList",{storeId:b},function(a){})};m.saveSystemConfig=function(b,a){var d={};d[b]=a;$.post("ext/config/saveSystemConfig",d,function(e){})};return m}();c.Server=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function m(){}m.getStoreMenuText=function(b,a,d){Ext.isEmpty(d)&&(d="\x3e");return a?c.System.getPlainMenu(a,d):b&&b.entity?c.System.getPlainMenu(b.entity.menu,d):null};m.commitStoreUpdate=function(b,a){return new Ext.Promise(function(d,e){if(b&&b.entity&&b.entity.idProperty&&!b.commiting){e=b.getUpdatedRecords();var f=b.getNewRecords();e=e.concat(f);if(0===e.length)d(!0),b.commiting=!1;else{b.commiting=!0;f={entityCode:b.entity.entityCode};b.entity.menu&&(f.menu=c.Store.getStoreMenuText(b));
for(var g=0;g<e.length;g++){for(var h=e[g],k=0;k<b.entity.idProperty.length;k++){var l=b.entity.idProperty[k];f["data["+g+"]."+l]=h.get(l)}for(var n in h.modified)k=h.modified[n],l=h.get(n),!Ext.isString(k)&&Ext.isEmpty(l)?f["data["+g+"]."+n]="\x3cnull\x3e":f["data["+g+"]."+n]=h.get(n)}c.Server.updateEntity(f,function(p,q){b.commiting=!1;d(p);p?(c.Dialog.toast(a?a:q),b.commitChanges()):(b.rejectChanges(),Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",q))})}}})};m.commitStoreDelete=function(b,a){return new Ext.Promise(function(d,
e){if(b.entity&&b.entity.idProperty){e={entityCode:b.entity.entityCode};b.entity.menu&&(e.menu=c.Store.getStoreMenuText(b));for(var f=0;f<a.length;f++)for(var g=a[f],h=0;h<b.entity.idProperty.length;h++){var k=b.entity.idProperty[h];e["data["+f+"]."+k]=g.get(k)}c.Server.deleteEntity(e,function(l,n){d(l);l?(c.Dialog.toast(n),l=b.currentPage,0>=b.count()-a.length&&--l,b.loadPage(Math.max(l,1))):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",n)})}})};m.commitStoreReback=function(b,a){return new Ext.Promise(function(d,
e){if(b.entity&&b.entity.idProperty){e={entityCode:b.entity.entityCode};b.entity.menu&&(e.menu=c.Store.getStoreMenuText(b));for(var f=0;f<a.length;f++)for(var g=a[f],h=0;h<b.entity.idProperty.length;h++){var k=b.entity.idProperty[h];e["data["+f+"]."+k]=g.get(k)}c.Server.rebackEntity(e,function(l,n){d(l);l?(l=b.currentPage,0>=b.count()-a.length&&--l,b.loadPage(Math.max(l,1))):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",n)})}})};m.commitStoreCopy=function(b,a){return new Ext.Promise(function(d,e){if(b.entity&&
b.entity.idProperty){e={entityCode:b.entity.entityCode};b.entity.menu&&(e.menu=m.getStoreMenuText(b));for(var f=!1,g=0;g<a.length;g++)for(var h=a[g],k=0;k<b.entity.idProperty.length;k++){var l=b.entity.idProperty[k],n=h.get(l);e["data["+g+"]."+l]=n;Ext.isEmpty(n)||(f=!0)}f?c.Server.copyEntity(e,function(p,q){d(p);p?(c.Dialog.toast(q),p=b.currentPage,0>=b.count()-a.length&&--p,b.loadPage(Math.max(p,1))):Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",q)}):c.Dialog.toast("\u9009\u4e2d\u7684\u6570\u636e\u4e0d\u53ef\u590d\u5236\uff01")}})};
m.isModified=function(b){for(var a in b.data)try{if(b.isModified(a))return!0}catch(d){}return!1};m.getEntityDataStore=function(b,a,d){if(Ext.isEmpty(b))c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u53c2\u6570entity\u4e0d\u53ef\u4e3a\u7a7a\uff01");else return b={fields:[],pageSize:20,where:a,entity:b,remoteSort:c.Base.toBool(b.remoteSort,!0),treeConfig:d,proxy:{type:"ajax",url:"entity/list",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(e,f,
g,h){try{var k=eval("("+f.responseText+")");k.success||c.Dialog.showAlert("\u6570\u636e\u83b7\u53d6\u5931\u8d25",k.message,null,!0,!0)}catch(l){c.Dialog.showAlert("\u6570\u636e\u83b7\u53d6\u5931\u8d25",f.responseText,null,!0,!0)}}},reader:{type:"json",root:"list",totalProperty:"totalRow"}},listeners:{beforeload:function(e,f,g){e.recordSelectHistory=!1;try{if(c.Power.isPower())return console.log("\u6743\u9650\u914d\u7f6e\u9ed8\u8ba4\uff0c\u53d6\u6d88\u6570\u636e\u52a0\u8f7d\uff01"),!1;if(!e.entity||
!e.entity.entityCode)return!1;var h=e.proxy.extraParams,k={entityCode:e.entity.entityCode,limit:e.pageSize,storeId:e.getId()};if(e.where)for(var l in e.where)k["where['"+l+"']"]=e.where[l];if(d){Ext.isEmpty(d.parentIdValue)&&(d.parentIdValue=-1);k.page=-1;k.fromTree=!0;k.treeParentIdName=d.parentIdName;var n=f.node.data[d.idName],p=c.Base.toBool(f.node.isFirstInstance,!1);Ext.isEmpty(n)&&(n=d.parentIdValue);k["where['^treeSearch']"]=!1;k["where['^treeLevel']"]=parseInt(f.node.data.depth)+1;e.grid&&
c.Grid.hasSearchColumn(e.grid)?(c.Base.deleteObjectAttr("where['"+d.parentIdName+"']",k,h),c.Base.deleteObjectAttr("where['"+d.idName+"']",k,h),k["where['^treeSearch']"]=!0):p&&-1!==d.parentIdValue?(k["where['"+d.idName+"']"]=n,c.Base.deleteObjectAttr("where['"+d.parentIdName+"']",k,h)):(c.Base.deleteObjectAttr("where['"+d.idName+"']",k,h),k["where['"+d.parentIdName+"']"]=n)}if(e.grid){k.power=c.Base.toBool(e.grid.power,!0);e.grid.listParams&&(k=c.Json.mergeJson(k,e.grid.listParams));e.grid.fromStoreChange=
!0;0<e.grid.getSelection().length?e.grid.getSelectionModel().deselectAll(!1,!0):e.grid.fireEvent("selectionchange",e.grid);e.grid.fromStoreChange=!1;if(e.grid.where)for(l in e.grid.where)k["where['"+l+"']"]=e.grid.where[l];e.getSorters().each(function(r){var u=c.Grid.getColumn(e.grid,r.getProperty());k["indexSort['"+r.getProperty()+"']"]=u.getIndex()});c.Grid.checkColumnSearch(e.grid);if(Ext.isFunction(e.grid.onBeforeLoad)){var q=e.grid.onBeforeLoad(e.grid,e,k);if(!c.Base.toBool(q,!0))return!1}}e.getProxy().setExtraParams(c.Json.mergeJson(h,
k));return!0}catch(r){c.Dialog.showException(r,"store:beforeload")}}},autoLoad:!1},d?(c.System.silenceGlobalSave||(b.root={expanded:!0}),b=Ext.create("Ext.data.TreeStore",b)):b=Ext.create("Ext.data.Store",b),b.on("load",function(e){setTimeout(function(){try{e.grid&&e.grid.syncRowHeights()}catch(f){}},300)}),b};m.getEnumDataStore=function(b,a,d,e,f,g,h){return new Ext.Promise(function(k,l){c.Store.getEnumDataArray(b,a,d,e,f,g).then(function(n){h?k(n):k(Ext.create("Ext.data.Store",{autoLoad:!1,enumName:b,
data:n}))})})};m.getEnumDataArray=function(b,a,d,e,f,g){return new Ext.Promise(function(h,k){e||(e={});if(Ext.isEmpty(b))h([]);else{Ext.isEmpty(f)&&(f=!0);Ext.isEmpty(g)&&(g=!1);var l=$.md5(b+Ext.JSON.encode(e)),n=function(){var p=Ext.clone(c.Cache.getEnumCache(b,l));a&&(p=Ext.Array.insert(p,0,a));d&&(p=Ext.Array.push(p,d));return p};f&&c.Cache.existEnumCache(b,l)&&!g?h(n()):$.post("showEnums?enumName\x3d"+b,e,function(p){try{p.success?(c.Cache.setEnumCache(b,l,p.data),h(n())):Ext.Msg.alert("\u679a\u4e3e\u83b7\u53d6\u5931\u8d25",
p.message)}catch(q){c.Dialog.showException(q,"\u83b7\u53d6\u679a\u4e3e\u6570\u636e\u6e90\uff01[getEnumDataStore]")}})}})};m.getEnumData=function(b,a,d){return new Ext.Promise(function(e,f){d||(d="id");Ext.isEmpty(a)?e(null):c.Store.getEnumDataArray(b).then(function(g){for(var h=0;h<g.length;h++){var k=g[h];if(!Ext.isEmpty(k[d])&&k[d].toString()===a.toString()){e(k);return}}e(null)})})};m.getEnumDataByRender=function(b){try{var a="Enum@"+b+"@Loading";c.Base.toBool(c.Cache.memory[a],!1)||(c.Cache.memory[a]=
!0,c.Store.getEnumDataArray(b).then(function(d){for(var e=$("[data-enum\x3d"+b+"][data-set\x3d'false']"),f=0;f<e.length;f++){var g=$(e[f]),h=g.attr("data-id"),k=g.attr("data-enum-value"),l=g.attr("data-enum-text");if(Ext.isEmpty(k)||"undefined"===k)k="id";if(Ext.isEmpty(l)||"undefined"===k)l="text";for(var n=0;n<d.length;n++){var p=d[n];if(c.Base.toString(p[k],"")===h.toString()){if(p)k=p[l],p=p.color,h=Ext.isEmpty(k)?"\x3cspan style\x3d'color: #ccc;'\x3e"+h+"\x3c/span\x3e":"\x3cspan style\x3d'color: "+
c.Color.toColor(p,"#000000")+";'\x3e"+k+"\x3c/span\x3e";else return;g.html(h);g.attr("data-set","true");break}}}c.Cache.memory[a]=null}))}catch(d){}};m.getPageDataStore=function(b,a){b&&0!==b.length||(b=c.Store.maxPageSize);a&&0!==a.length||(a=10);for(var d=[],e=0;e<b/10;e++)d.push({text:(e+1)*a+"\u6761",id:(e+1)*a});return Ext.create("Ext.data.Store",{id:"pageSizeDataStore",fields:["id","text"],data:d})};m.getCompareDataStore=function(b){var a=[{id:-1,text:"~",desc:"\u7a7a\u503c"},{id:-2,text:"!~",
desc:"\u975e\u7a7a\u503c"},{id:0,text:"\x3d",desc:"\u7b49\u4e8e"},{id:1,text:"!\x3d",desc:"\u4e0d\u7b49\u4e8e"},{id:2,text:"?",desc:"\u5305\u542b"},{id:3,text:"!?",desc:"\u4e0d\u5305\u542b"},{id:4,text:"\x3e",desc:"\u5927\u4e8e"},{id:6,text:"\x3e\x3d",desc:"\u5927\u7b49\u4e8e"},{id:5,text:"\x3c",desc:"\u5c0f\u4e8e"},{id:7,text:"\x3c\x3d",desc:"\u5c0f\u7b49\u4e8e"},{id:8,text:"*",desc:"\u5339\u914d"},{id:9,text:"!*",desc:"\u4e0d\u5339\u914d"},{id:10,text:"#",desc:"\u91cd\u590d"},{id:11,text:"!#",desc:"\u4e0d\u91cd\u590d"}];
b.date&&(a=[{id:-1,text:"~",desc:"\u7a7a\u503c"},{id:-2,text:"!~",desc:"\u975e\u7a7a\u503c"},{id:0,text:"\x3d",desc:"\u7b49\u4e8e"},{id:1,text:"!\x3d",desc:"\u4e0d\u7b49\u4e8e"},{id:4,text:"\x3e",desc:"\u5927\u4e8e"},{id:6,text:"\x3e\x3d",desc:"\u5927\u7b49\u4e8e"},{id:5,text:"\x3c",desc:"\u5c0f\u4e8e"},{id:7,text:"\x3c\x3d",desc:"\u5c0f\u7b49\u4e8e"}]);b&&b.full&&a.splice(2,0,{id:-3,text:"??",desc:"\u68c0\u7d22"});return Ext.create("Ext.data.Store",{data:a})};m.getCompareLinkDataStore=function(){return Ext.create("Ext.data.Store",
{data:[{id:0,text:"\x26",desc:"\u5e76\u4e14"},{id:1,text:"||",desc:"\u6216\u8005"}]})};m.getGridColumnStore=function(b,a){var d=[];if(b){b=b.getColumns();for(var e=0;e<b.length;e++){var f=b[e];Ext.isEmpty(f.dataIndex)||(!c.Base.toBool(a,!1)||c.Grid.canColumnSearch(f))&&d.push({text:f.configText,id:f.dataIndex,index:e})}}return Ext.create("Ext.data.Store",{fields:["id","text","index"],data:d})};m.getChartGridColumnStore=function(b){var a=[];if(b){b=b.getColumns();for(var d=0;d<b.length;d++){var e=
b[d];Ext.isEmpty(e.dataIndex)||(c.Grid.isNumberColumn(e)&&c.Base.toBool(e.chart,!0)||c.Grid.isIdPropertyColumn(e)||c.Base.toBool(e.chart,!0))&&a.push({text:e.configText,id:e.dataIndex,index:d})}}return Ext.create("Ext.data.Store",{fields:["id","text","index"],data:a})};m.getYesOrNoDataStore=function(){return Ext.create("Ext.data.Store",{id:"yesOrNoDataStore",fields:["id","text"],data:[{text:"\u662f",id:1},{text:"\u5426",id:0}]})};m.getThemeDataStore=function(){return Ext.create("Ext.data.Store",{id:"themeDataStore",
fields:["id","text"],data:[{text:"\u5706\u6da6\u7acb\u4f53",id:"extjs/theme/fast-theme-wrap"},{text:"\u6e05\u723d\u6241\u5e73",id:"extjs/theme/fast-theme-flat"}]})};m.getSystemLayoutDataStore=function(){return Ext.create("Ext.data.Store",{id:"systemLayoutDataStore",fields:["id","text"],data:[{text:"\u4f20\u7edf\u5e03\u5c40",id:"normal"},{text:"\u684c\u9762\u5e03\u5c40",id:"desktop"}]})};m.getFontSizeDataStore=function(){return Ext.create("Ext.data.Store",{id:"fontSizeDataStore",fields:["id","text"],
data:[{text:"14px",id:"14px"},{text:"16px",id:"16px"},{text:"18px",id:"18px"}]})};m.getFrontRadiusDataStore=function(){return Ext.create("Ext.data.Store",{id:"fontSizeDataStore",fields:["id","text"],data:[{text:"8px",id:"8px"},{text:"88px",id:"88px"}]})};m.setRecordValue=function(b,a,d){d.dataIndex=a;if(Ext.isFunction(d.setRecordValue))d.setRecordValue(b,!1);else{var e=d.getValue();Ext.isDate(d.getValue())?b.set(a,Ext.Date.format(e,d.format)):b.set(a,e)}b.store&&c.Base.toBool(d.autoUpdate,!1)&&c.Store.commitStoreUpdate(b.store)};
m.isSameRecord=function(b,a){return b.store&&b.store.entity&&a.store&&a.store.entity&&b.store.entity.entityCode===a.store.entity.entityCode?c.Store.isSameRecordByEntity(b.store.entity,b,a):!1};m.isSameRecordByEntity=function(b,a,d){if(!b.idProperty)return!1;for(var e=0;e<b.idProperty.length;e++){var f=b.idProperty[e];if(a.get(f)!==d.get(f))return!1}return!0};m.mergeStoreParamBySelect=function(b,a){if(b){var d=b.proxy.extraParams;b.treeConfig&&(delete d["where['"+b.treeConfig.idName+"']"],delete d["where['"+
b.treeConfig.parentIdName+"']"]);return c.Json.mergeJson(a,d)}return a};m.maxPageSize=50;return m}();c.Store=v})(FastExt||(FastExt={}));
(function(c){var v=function(){function b(){}Object.defineProperty(b,"fontSize",{get:function(){return window.fontSize?window.fontSize:this._fontSize},enumerable:!1,configurable:!0});b.isDesktopLayout=function(){var a=c.Objects.safeObject(c.System.getExt("system-layout")).value;return Ext.isEmpty(a)?!1:"desktop"===a.toLowerCase()};b.isThemeWrap=function(){return 0<=c.Color.toColor(c.System.theme.value).indexOf("fast-theme-wrap")};b.removeLoading=function(){window.removeLoading()};b.checkBrowserVersion=
function(){return Ext.isIE&&11>Ext.ieVersion?(Ext.create("Ext.window.Window",{title:"\u7cfb\u7edf\u63d0\u9192",width:250,height:100,layout:"fit",icon:"icons/icon_error.svg",resizable:!1,closable:!1,html:"\x3cdiv style\x3d'background:#eeeeee; padding:10px;'\x3e\u60a8\u5f53\u524d\u7684IE\u7248\u672c\u592a\u4f4e\uff0c\u81f3\u5c11\u572811.0\u4ee5\u4e0a\u7684IE\u624d\u80fd\u4f7f\u7528\u672c\u7cfb\u7edf\uff01\x3c/div\x3e",modal:!0}).show(),!1):!0};b.getBodyContainer=function(){c.System.systemBodyContainer||
(Ext.getDoc().on("contextmenu",function(a){a.stopEvent()}),Ext.tip.QuickTipManager.init(),Ext.QuickTips.init(),c.System.systemBodyContainer=Ext.create("Ext.container.Viewport",{id:"bodyContainer",layout:"card",border:0,renderTo:Ext.getBody()}));Ext.isEmpty(window.systemErrorMessage)||(c.Dialog.toast(window.systemErrorMessage),window.systemErrorMessage=void 0);return c.System.systemBodyContainer};b.getValue=function(a){return(a=c.System[a])?a:{value:""}};b.addScript=function(a,d){if(null!=a){var e=
document.getElementsByTagName("head").item(0),f=document.createElement("script"),g=!1;f.type="text/javascript";if(null!=a.src&&0<a.src.length)f.src=c.System.formatUrlVersion(a.src);else if(null!=a.href&&0<a.href.length)f.src=c.System.formatUrlVersion(a.href);else if(a.text){try{f.appendChild(document.createTextNode(a.text))}catch(h){f.text=a.text}g=!0}else{null!=d&&d();return}e.appendChild(f);g?null!=d&&d():(f.onload=f.readystatechange=function(){null!=d&&d()},f.onerror=function(){alert("\u811a\u672c\u6587\u4ef6"+
a.src+"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u60a8\u7a0d\u540e\u91cd\u8bd5\uff01")})}};b.addStyle=function(a,d){var e=document.getElementsByTagName("head").item(0),f=document.createElement("style");f.type="text/css";f.styleSheet?f.styleSheet.cssText=a:f.innerHTML=a;null!=d&&d();e.appendChild(f);return f};b.removeStyle=function(a){for(var d=document.getElementsByTagName("style"),e=0;e<d.length;e++){var f=d[e];f.code===a&&f.parentNode.removeChild(f)}};b.addStylesheet=function(a,d){if(null!=a){var e=
document.getElementsByTagName("head").item(0),f=document.createElement("link");f.rel="stylesheet";f.href=c.System.formatUrl(a.href);e.appendChild(f);f.onload=f.readystatechange=function(){null!=d&&d()};f.onerror=function(){alert("\u7cfb\u7edfLink\u6587\u4ef6"+a.href+"\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u60a8\u7a0d\u540e\u91cd\u8bd5\uff01")}}};b.getProgressLine=function(a){try{Ext.isEmpty(a)&&(a="#f8c633");if(0>=$("#progress").length)return{set:function(){},animate:function(){}};c.System.progressLine||
(c.System.progressLine=new ProgressBar.Line("#progress",{color:a,duration:1E3,easing:"easeInOut",from:{color:"#9c58b6"},to:{color:a},step:function(d,e,f){e.path.setAttribute("stroke",d.color)}}));return c.System.progressLine}catch(d){}return{set:function(){},animate:function(){}}};b.initConfig=function(){c.System.baseUrl=window.location.href;0<c.System.baseUrl.indexOf("#")&&(c.System.baseUrl=c.System.baseUrl.split("#")[0]);c.System.baseUrl.toString().endWith("/")||(c.System.baseUrl+="/");var a={};
c.Power.isPower()&&window.parent&&Ext.isFunction(window.parent.getMenuPower)&&(a={menuPower:window.parent.getMenuPower()});Ext.Ajax.request({url:c.Server.showConfigUrl(),params:a,success:function(d,e){d=c.Json.jsonToObject(d.responseText).data;for(var f in d)d.hasOwnProperty(f)&&(c.System[f]=d[f]);f=c.System.getAllExt();for(d=0;d<f.length;d++)e=f[d],c.System[e.name]=e;c.System.loadAppJs()},failure:function(d,e){c.Dialog.showException(d.responseText,"\u83b7\u53d6\u7cfb\u7edf\u914d\u7f6e\uff01[system.initConfig]")}})};
b.loadAppJs=function(){c.System.loadAppJsByCallback(0,function(){c.System.globalConfig()})};b.loadAppJsByCallback=function(a,d){a>=c.System.app.length?(Ext.MessageBox.updateProgress(1,"\u5df2\u52a0\u8f7d\u6210\u529f\uff0c\u6b63\u5728\u663e\u793a\u4e2d"),c.System.addStyle(c.System.menusCss,function(){c.System.initAppJsProperty();d()})):(Ext.MessageBox.updateProgress(parseFloat(String(a+1))/parseFloat(c.System.app.length),"\u6b63\u5728\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85"),c.System.addScript({src:c.System.app[a]},
function(){c.System.loadAppJsByCallback(a+1,d)}))};b.initAppJsProperty=function(){for(var a=c.System.entities,d=0;d<a.length;d++){var e=a[d];try{var f=eval(e.entityCode+".prototype");if(f){for(var g in e)f[g]=e[g];e.js=!0;var h=eval("new "+e.entityCode+"().getList");if(h){var k=h.toString(),l=RegExp("let (\\w+)[ ]?\x3d[ ]?this[,; ]?").exec(k);f.getListThisVarName=l?l[1]:"me";l=RegExp("[let,]?[ ]?(\\w+)[ ]?\x3d[ ]?Ext.create\\((['\"])Ext.grid.Panel\\2").exec(k);f.getListGridVarName=l?l[1]:"grid"}}}catch(n){e.js=
!1}}};b.globalConfig=function(){if(c.Power.isPower()&&window.parent&&Ext.isFunction(window.parent.getExtPower)){c.Power.config=!0;c.Power.powers=c.Json.jsonToObject(window.parent.getExtPower());c.Power.powers||(c.Power.powers={});c.System.managerPowers=c.Json.jsonToObject(window.parent.getParentExtPower());if(c.System.managerPowers)for(var a in c.Power.powers)if(c.System.managerPowers.hasOwnProperty(a)){var d=c.System.managerPowers[a],e;for(e in d)d[e]||(c.Power.powers[a][e]=!1)}window.getExtPower=
function(){return c.Power.getSavePowerData()}}Ext.on("mousedown",function(f){c.System.currClickTarget=f.target});window.addEventListener("popstate",function(f){c.System.selectTab(c.System.getMenuIdFromLocation())},!1);c.System.init=!0;c.System.isDesktopLayout()?c.Desktop.initSystem():c.System.initSystem()};b.initSystem=function(){c.System.removeLoading();var a=this,d=c.System.getBodyContainer();d.removeAll();var e=c.Color.toColor(a["theme-color"].value),f=parseInt((.25*document.body.clientWidth).toFixed(0)),
g=Ext.create("Ext.panel.Panel",{border:0,region:"center",cls:"treelist-with-nav",scrollable:"y",items:[{xtype:"treelist",id:"leftTreeList",reference:"treelist",expanderOnly:!1,singleExpand:c.System.menuSingleExpand,ui:"nav",scrollable:"y",expanderFirst:!1,selectOnExpander:!0,highlightPath:!0,store:{type:"tree",root:{expanded:!0,children:a.menus}},viewModel:{formulas:{selectionItem:function(n){(n=n("treelist.selection"))&&n.data.leaf&&a.showTab(n.data.method,n.data.id,n.data.text,n.data.icon);return n}}}}],
listeners:{resize:function(n,p,q,r,u,t){n=128>=p;q=Ext.getCmp("leftTreeList");r=q.ownerCt.ownerCt;q.setMicro(n);n?r.setWidth(44):r.setWidth(p)}}});a.tabPanelContainer=Ext.create("Ext.tab.Panel",{region:"center",id:"tabs",plain:!0,style:{marginTop:"-8px"},items:[],tabBar:{userCls:"systemTab",layout:{overflowHandler:"menu"}},recordTab:function(){c.System.recordTab()},plugins:["tabreorderer","tabclosemenu"]});var h=Ext.create("Ext.panel.Panel",{layout:"border",region:"center",border:0,style:{background:"#eeeeee"},
items:[a.tabPanelContainer]}),k=Ext.create("Ext.panel.Panel",{layout:"border",region:"west",border:0,width:f,minWidth:44,maxWidth:500,subtitle:"\u5de6\u4fa7\u83dc\u5355",split:!0,style:{background:"#32404e"},items:[{xtype:"image",height:35,border:0,padding:"5 5 5 5",region:"south",src:c.Server.getIcon("icon_v_menu.svg"),cls:"leftBottom",listeners:{el:{click:function(){44>=k.getWidth()?null!=k.oldWidth?k.setWidth(Math.max(200,k.oldWidth)):k.setWidth(200):(k.oldWidth=k.getWidth(),k.setWidth(44))}}}},
g]});a.tabPanelContainer.add({title:"\u9996\u9875",xtype:"panel",id:"tabWelcome",reorderable:!1,closable:!1,layout:"fit",iconCls:"extIcon extIndex",justFixed:!0,items:[c.System.getWelcomePanel()],listeners:{beforeactivate:function(n){if(!c.System.silenceGlobalSave)try{a.selectMenu(a.lastTabId,!0)}catch(p){}},activate:function(n){c.System.clearAllTabTheme();c.System.silenceGlobalSave||a.restoredTab&&c.System.pushLocationHistory({text:n.title})}}});e=Ext.create("Ext.panel.Panel",{layout:"border",border:0,
bodyStyle:{background:e},items:[c.System.getSystemHeaderPanel(),k,h]});d.add(e);var l=function(){window.indexLottie&&(window.indexLottie.destroy(),window.indexLottie=null);var n=a.getMenuIdFromLocation(),p=a.existMenu(n);if(c.Base.toBool(a["tab-record"].value,!0))Ext.MessageBox.updateProgress(1,"\u5373\u5c06\u5b8c\u6210\u64cd\u4f5c\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85","\u7cfb\u7edf\u521d\u59cb\u5316\u6210\u529f\uff01\u83b7\u53d6\u83dc\u5355\u4e2d\u2026"),a.restoreTab().then(function(q){c.Dialog.hideWait();
q=c.Json.jsonToObject(q);a.restoredTab=!0;if(q&&(Ext.each(q,function(r){n===r.id?r.active=!0:p&&(r.active=!1);var u=c.System.getMenu(r.id);u&&(r.method=u.method,r.icon=u.icon);a.showTab(r.method,r.id,r.title,r.icon,r.active,!0,r.where,r.closable,r.reorderable)}),p&&a.selectTab(n),0!==q.length&&a.tabPanelContainer.getActiveTab()||a.tabPanelContainer.setActiveTab(Ext.getCmp("tabWelcome")),c.Listeners.onFinishSystem))c.Listeners.onFinishSystem()});else if(c.Dialog.hideWait(),a.tabPanelContainer.setActiveTab(Ext.getCmp("tabWelcome")),
c.Listeners.onFinishSystem)c.Listeners.onFinishSystem()};c.Base.toBool(a.needInit,!1)?(c.Dialog.hideWait(),c.Listeners.onAfterInitSystem=function(){l();c.Listeners.onAfterInitSystem=null},c.System.startSilenceSaveConfig(null,"\u6b63\u5728\u5347\u7ea7\u5f53\u524d\u8d26\u6237\u7684\u7cfb\u7edf\u914d\u7f6e")):l()};b.getSystemHeaderPanel=function(a){var d=c.Color.toColor(c.System["theme-color"].value),e=c.Color.toColor(c.System["front-color"].value),f=c.System["system-logo"].value,g=c.Eval.runObject(c.System.getAllExt(),
$("title").text());Ext.isEmpty(f)&&(f="icons/icon_head_system.svg");Ext.isEmpty(a)&&(a="headContainer");e=[{xtype:"image",src:this.formatUrl(f),height:35,width:35,cls:"headLogo",margin:"10 5 5 5",style:{borderRadius:"10px"}},{xtype:"label",margin:"0 0 0 5",html:"\x3cdiv class\x3d'headTitle' style\x3d'color: "+e+";' \x3e"+g+"\x3c/div\x3e"},"-\x3e",c.System.isSuperRole()?{xtype:"button",iconCls:"extIcon extSearch searchColor",text:"\u7cfb\u7edf\u5168\u5c40\u641c\u7d22",minWidth:155,cls:"headButton",
code:"SystemGlobalSearchButton",handler:function(){c.System.showGlobalSearch(this)}}:null,{xtype:"button",iconCls:"extIcon extManager2 searchColor",text:c.System.manager.managerName,minWidth:155,cls:"headButton",handler:function(){c.System.showManagerInfo(this)}},{xtype:"button",iconCls:"extIcon extExits redColor",text:"\u9000\u51fa\u767b\u5f55",cls:"headButton",handler:function(){c.System.logout()}}];if(c.Listeners.onInitSystemHeaderItems)c.Listeners.onInitSystemHeaderItems(e);a=Ext.create("Ext.toolbar.Toolbar",
{height:55,padding:"0 0 0 0",border:0,flex:1,power:!1,cls:a,id:"SystemHeadButtons",style:{background:d},items:e});d=Ext.create("Ext.toolbar.Toolbar",{border:0,padding:"0 0 0 0",flex:1,height:3,style:{background:d},html:'\x3cdiv class\x3d"progress" id\x3d"progress"\x3e\x3c/div\x3e'});return Ext.create("Ext.container.Container",{layout:"absolute",region:"north",height:55,border:0,hidden:c.Power.config,items:[a,d],listeners:{afterlayout:function(){c.Base.toBool(this.bindFullscreen,!1)||(this.bindFullscreen=
!0,this.getEl().on("dblclick",function(){c.System.fullscreen?c.System.outFullscreen():c.System.inFullScreen()}))}}})};b.sessionOut=function(a){Ext.isEmpty(a)&&(a="\u7cfb\u7edf\u68c0\u6d4b\u5230\u60a8\u7684\u4f1a\u8bdd\u5df2\u5931\u6548\uff0c\u8bf7\u60a8\u91cd\u65b0\u767b\u5f55\uff01");Ext.getCmp("ManagerSessionOutWin")||this.sessionOutAlert||(c.Dialog.hideWait(),this.sessionOutAlert=!0,a=Ext.create("Ext.form.FormPanel",{bodyPadding:5,method:"POST",region:"center",layout:{type:"vbox",pack:"center",
align:"middle"},defaults:{margin:"5 5 5 5"},border:0,items:[{xtype:"lottie",width:150,height:120,jsonPath:"base/lottie/error_normal.json"},{xtype:"label",maxWidth:250,margin:"5 5 10 5",html:a}]}),Ext.create("Ext.window.Window",{title:"\u8d26\u6237\u63d0\u9192",iconCls:"extIcon extSessionOut",id:"ManagerSessionOutWin",width:280,layout:{type:"vbox",pack:"center",align:"middle"},maximizable:!1,sessionWin:!0,fixed:!0,draggable:!1,animateDisable:!0,constrain:!0,resizable:!1,alwaysOnTop:!0,toFrontOnShow:!0,
items:[a],modal:!0,listeners:{destroy:function(d,e){c.Power.isPower()?window.parent.close():location.reload()}},buttons:["-\x3e",{text:"\u91cd\u65b0\u767b\u5f55",iconCls:"extIcon extLogin",handler:function(){c.Server.logout("\u9000\u51fa\u7cfb\u7edf\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026")}},"-\x3e"]}).show())};b.logout=function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u793a","\x3cdiv style\x3d'line-height: 170%;'\x3e\x3cb style\x3d'font-size: 16px;'\x3e\u60a8\u786e\u5b9a\u9000\u51fa\u5f53\u524d\u767b\u5f55\u7684\u8d26\u6237\u5417\uff1f\x3c/b\x3e\x3cbr/\x3e\x3cb style\x3d'font-size: 14px;'\x3e\u5f53\u524d\u8d26\u6237\uff1a"+
(c.System.manager.managerName+"\x3c/b\x3e\x3c/div\x3e"),function(a){"yes"===a&&c.Server.logout()})};b.showManagerInfo=function(a){if(c.System.manager.infoWin)c.Component.shakeComment(c.System.manager.infoWin);else{var d=[{name:"\u8d26\u6237\u540d\u79f0",value:c.System.manager.managerName},{name:"\u8d26\u6237\u767b\u5f55\u540d",value:c.System.manager.managerLoginName},{name:"\u8d26\u6237\u72b6\u6001",value:c.System.manager.managerStateStr},{name:"\u8d26\u6237\u89d2\u8272",value:c.System.manager.role.roleName},
{name:"\u89d2\u8272\u7c7b\u578b",value:c.System.manager.role.roleTypeStr},{name:"\u89d2\u8272\u72b6\u6001",value:c.System.manager.role.roleStateStr},{name:"\u5141\u8bb8\u767b\u5f55",value:c.System.manager.onlineTypeStr},{name:"\u6700\u540e\u4e00\u6b21\u767b\u5f55",value:c.System.manager.lastLoginTime}];if(c.Listeners.onShowManagerInfo)c.Listeners.onShowManagerInfo(d);d=c.Grid.createDetailsGrid(d,{power:!1,hideHeaders:!0},{},{align:"center"});c.System.manager.infoWin=Ext.create("Ext.window.Window",
{title:"\u767b\u5f55\u7cfb\u7edf\u7684\u8d26\u6237\u4fe1\u606f",layout:"fit",constrain:!0,iconCls:"extIcon extManager2",resizable:!0,minHeight:200,minWidth:400,height:400,width:350,animateTarget:a,items:[d],listeners:{close:function(e,f){c.System.manager.infoWin=null}},buttons:[{text:"\u9000\u51fa\u767b\u5f55",iconCls:"extIcon extExits whiteColor",handler:function(){c.System.logout()}},"-\x3e",{text:"\u66f4\u591a\u64cd\u4f5c",iconCls:"extIcon extMore whiteColor",menu:[{text:"\u521d\u59cb\u5316\u914d\u7f6e",
columnWidth:1,iconCls:"extIcon extRefresh extRole",handler:function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u5c06\u521d\u59cb\u5316\u7cfb\u7edf\u8bb0\u5fc6\u914d\u7f6e\uff0c\u786e\u5b9a\u7ee7\u7eed\u5417\uff1f",function(e,f){"yes"==e&&c.System.startSilenceSaveConfig()})}},{text:"\u4fee\u6539\u767b\u5f55\u5bc6\u7801",iconCls:"extIcon extResetPassword redColor",handler:function(){c.System.modifyPassword(this)}}]}]})}c.System.manager.infoWin.show()};b.getExt=function(a){return window.getExt(a)};
b.isDebug=function(){return c.Base.toBool(c.System.getExt("debug").value,!1)};b.isLocal=function(){return c.Base.toBool(c.System.getExt("local").value,!1)};b.getAllExt=function(){return window.getAllExt()};b.isInitSystem=function(){try{if(c.System.init)return!0}catch(a){}return!1};b.isSuperRole=function(){return this.manager&&this.manager.role&&0===this.manager.role.roleType?!0:!1};b.getManagerId=function(){return this.manager?this.manager.managerId:-1};b.inFullScreen=function(){try{var a=document.documentElement;
a.requestFullscreen?a.requestFullscreen():a.msRequestFullscreen?a.msRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.webkitRequestFullscreen&&a.webkitRequestFullscreen()}catch(d){console.error(d)}finally{this.fullscreen=!0}};b.outFullscreen=function(){try{var a=document;a.exitFullscreen?a.exitFullscreen():a.msExitFullscreen?a.msExitFullscreen():a.mozCancelFullScreen?a.mozCancelFullScreen():a.webkitExitFullscreen&&a.webkitExitFullscreen()}catch(d){console.error(d)}finally{this.fullscreen=
!1}};b.validOperate=function(a,d,e){if(a){var f=Cookies.get("ValidOperate"+$.md5(a));e||(e=86400);if(f)d();else{var g="normal"===c.System.getExt("login-type").value;f=5*c.Base.getNumberValue(c.System.fontSize)+8;var h=function(){var p=k.form;if(p.isValid()){var q=k.form.findField("loginPassword").getValue();p.submit({params:{loginPassword:$.md5(q),operate:a,timeout:e},waitMsg:"\u6b63\u5728\u4e3a\u60a8\u9a8c\u8bc1\u4e2d\u2026\u2026",success:function(r,u){n.close();d()},failure:function(r,u){l();u.result&&
Ext.Msg.alert("\u9a8c\u8bc1\u5931\u8d25",u.result.message,function(){-3===u.result.code&&k.form.findField("validateCode").focus()})}})}},k=Ext.create("Ext.form.FormPanel",{url:c.Server.validOperateUrl(),method:"POST",fileUpload:!0,border:0,width:"100%",layout:"anchor",region:"center",bodyStyle:{},padding:"10 10 0 10",items:[{xtype:"textfield",fieldLabel:"\u767b\u5f55\u8d26\u53f7",labelAlign:"right",labelWidth:f,margin:"10 10 0 0",name:"loginName",allowBlank:!1,readOnly:!0,value:c.System.manager.managerLoginName,
blankText:"\u8bf7\u8f93\u5165\u5f53\u524d\u767b\u5f55\u540d",emptyText:"\u8bf7\u8f93\u5165\u5f53\u524d\u767b\u5f55\u540d",anchor:"100%"},{xtype:"textfield",fieldLabel:"\u767b\u5f55\u5bc6\u7801",labelAlign:"right",labelWidth:f,inputType:"password",margin:"10 10 0 0",allowBlank:!1,blankText:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",emptyText:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",submitValue:!1,name:"loginPassword",anchor:"100%"},{xtype:"fieldcontainer",labelWidth:0,anchor:"100%",layout:{type:"hbox",
align:"stretch"},hidden:g,items:[{xtype:"textfield",fieldLabel:"\u9a8c\u8bc1\u7801",labelAlign:"right",labelWidth:f,margin:"10 10 0 0",allowBlank:g,flex:1,name:"validateCode",emptyText:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",blankText:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"},{xtype:"image",margin:"10 10 0 0",width:70,id:"imgCode",height:32}]},{xtype:"fieldcontainer",labelWidth:0,anchor:"100%",layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",text:"\u53d6\u6d88",iconCls:"extIcon extReset",
flex:1,tipText:"\u53d6\u6d88\u9a8c\u8bc1",margin:"10 5 10 10",handler:function(){n.close()}},{xtype:"button",text:"\u786e\u5b9a",tipText:"\u786e\u5b9a\u9a8c\u8bc1",margin:"10 10 10 5",iconCls:"extIcon extOk",flex:1,handler:function(){h()}}]}],listeners:{render:function(p){try{new Ext.util.KeyMap({target:p.getEl(),key:13,fn:h,scope:Ext.getBody()})}catch(q){console.error(q)}}}}),l=function(){try{k.form.findField("validateCode").reset(),Ext.getCmp("imgCode").setSrc("showCaptcha?t\x3d"+Math.random())}catch(p){}};
f=Ext.create("Ext.panel.Panel",{region:"south",layout:"fit",width:"100%",border:0,html:"\x3cdiv align\x3d'center' style\x3d'font-size: small;color:red;text-decoration:none; padding-left: 40px;padding-right: 40px;padding-bottom: 10px;'\x3e\x3cb\x3e\u5b8c\u6210\u9a8c\u8bc1\u540e\u5c06\u7ee7\u7eed\u6267\u884c\u300a"+a+"\u300b\u64cd\u4f5c\x3c/b\x3e\x3c/div\x3e"});var n=Ext.create("Ext.window.Window",{title:"\u5f53\u524d\u64cd\u4f5c\u9700\u8981\u5b89\u5168\u9a8c\u8bc1",iconCls:"extIcon extPower",width:380,
resizable:!1,layout:"vbox",toFrontOnShow:!0,modal:!0,constrain:!0,items:[k,f]});n.show(null,function(){try{g||(l(),Ext.get("imgCode").on({click:function(){l()}}))}catch(p){}})}}};b.formatUrlVersion=function(a,d){if(Ext.isEmpty(a))return a;var e=a.split("@"),f=a=e[0];0>a.indexOf("v\x3d")&&(f=0<a.indexOf("?")?a+"\x26v\x3d"+c.System.getExt("version").value:a+"?v\x3d"+c.System.getExt("version").value);if(d)for(var g in d)d.hasOwnProperty(g)&&(f=f+"\x26"+g+"\x3d"+d[g]);e[0]=f;return e.join("@")};b.formatUrl=
function(a,d){return Ext.isEmpty(a)?a:a.startWith("http://")||a.startWith("https://")?this.formatUrlVersion(a,d):this.http?this.formatUrlVersion(this.http+a,d):this.formatUrlVersion(a,d)};b.asyncMethod=function(a){return new Ext.Promise(function(d,e){try{var f=eval(a);d(f)}catch(g){d(null),console.error(g)}})};b.getMenu=function(a){return c.System.getMenuData(a)};b.getMenuData=function(a){var d=function(e,f,g){for(var h=0;h<f.length;h++){var k=Ext.clone(f[h]);k.parent=e;if(k.id===g||k.children&&(k=
d(k,k.children,g),null!=k))return k}return null};return d(null,c.System.menus,a)};b.findLastTag=function(){for(var a=c.System.tabPanelContainer.items.items.length-1;0<=a;a--){var d=c.System.tabPanelContainer.items.items[a];if(d&&!c.Base.toBool(d.tab.closable,!0)&&!c.Base.toBool(d.tab.reorderable,!0))return d}return null};b.recordTab=function(){return new Ext.Promise(function(a,d){try{var e=[];c.System.tabPanelContainer.items.each(function(f,g){g={};Ext.isEmpty(f.method)||(g.method=f.method,g.where=
f.where,g.title=f.title,g.icon=f.icon,g.id=f.id,g.closable=f.closable,g.reorderable=f.reorderable,g.active=f===c.System.tabPanelContainer.getActiveTab(),e.push(g))});c.Server.setSilence(!0);c.Server.saveExtConfig($.md5("SystemTabs"),"TabRecord",c.Json.objectToJson(e),function(f,g){a(f);c.Server.setSilence(!1)})}catch(f){d(f)}})};b.restoreTab=function(){return new Ext.Promise(function(a,d){try{c.Server.showExtConfig($.md5("SystemTabs"),"TabRecord",function(e,f){a(f)})}catch(e){d(e)}})};b.selectTab=
function(a,d,e){if(!a)return!1;if(c.System.isDesktopLayout())return c.Desktop.showWindowMenu(null,c.Desktop.getMenu(a)),!1;var f=Ext.getCmp(a);c.System.lastTabId===a&&d&&c.Component.shakeComment(f);return f?(this.tabPanelContainer.setActiveTab(f),e&&this.tabPanelContainer.moveAfter(f,Ext.getCmp("tabWelcome")),f.focus(),!0):this.selectMenu(a,!1)};b.selectMenu=function(a,d){try{if(c.System.isDesktopLayout())c.Desktop.showWindowMenu(null,c.System.getMenu(a));else{Ext.isEmpty(d)&&(d=!1);var e=Ext.getCmp("leftTreeList");
if(e){var f=e.getStore().getNodeById(a);if(!f)return!1;var g=f.get("parentId");if(!Ext.isEmpty(g)){var h=e.getStore().getNodeById(g);if(d){e.setSelection(h);h.collapse();return}"root"!==g&&(h.expand(!1,!0),this.selectMenu(g,d))}e.setSelection(f);return!0}}}catch(k){c.Dialog.showException(k,"\u9009\u62e9\u83dc\u5355\uff01[system.selectMenu]")}};b.existMenu=function(a){return Ext.isEmpty(a)?!1:null!=c.System.getMenu(a)};b.getPlainMenu=function(a,d){Ext.isEmpty(d)&&(d="\x3e");if(a){if(a.parent){var e=
c.System.getPlainMenu(a.parent,d);if(e)return e+d+a.text}else if(a.parentId&&"root"!==a.parentId.toLowerCase()&&(e=c.System.getPlainMenu(this.getMenu(a.parentId),d)))return e+d+a.text;return a.text}return null};b.getPathMenu=function(a){if(a){if(a.parent){var d=c.System.getPathMenu(a.parent);if(d)return d.push(a),d}return[a]}return null};b.getPlainIconMenu=function(a,d){a=c.System.getPathMenu(a);d='\x3cdiv style\x3d"line-height: 20px;display: flex" \x3e';for(var e=0;e<a.length;e++){var f=a[e];f='\x3cimg src\x3d"'+
f.icon+'" width\x3d"20px" height\x3d"20px" /\x3e\x3cspan style\x3d"margin-left: 5px;"\x3e'+f.text+"\x3c/span\x3e ";0!=e&&(f="\x3cspan style\x3d'font-size: 12px;margin: 0 5px;color: #cccccc;' class\x3d'extIcon extArrowRight2'\x3e\x3c/span\x3e"+f);d+=f}return d+"\x3c/div\x3e"};b.getPlainIconMenuHtmlBySVG=function(a){return'\x3cdiv style\x3d"line-height: 20px;display: flex" \x3e\x3csvg style\x3d\'width: 20px;height: 20px;\' class\x3d"svgIconFill" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#'+a.iconCls+
'"\x3e\x3c/use\x3e\x3c/svg\x3e\x3cspan style\x3d"margin-left: 5px;"\x3e'+a.text+"\x3c/span\x3e\x3c/div\x3e "};b.searchMenuByEntityCode=function(a){var d=function(e){if(!e)return null;for(var f=0;f<e.length;f++){var g=e[f];if(g.method&&0<=g.method.indexOf(a)||g.children&&(g=d(g.children)))return g}return null};return d(this.menus)};b.searchMenusByEntityCode=function(a){var d=function(e){var f=[];if(!e)return null;for(var g=0;g<e.length;g++){var h=e[g];h.method&&0<=h.method.indexOf(a)&&f.push(h);h.children&&
(h=d(h.children))&&f.push.apply(f,h)}return f};return d(this.menus)};b.getAllMethodMenu=function(a){Ext.isEmpty(a)&&(a="");var d=function(f,g){if(f)for(var h=0;h<f.length;h++){var k=f[h];k.method&&0<=k.method.indexOf(a)&&g.push(k);d(k.children,g)}},e=[];d(c.System.menus,e);return e};b.showTab=function(a,d,e,f,g,h,k,l,n){var p=this,q=p.getMenu(d);q||(q={method:a,id:d,text:e,icon:f});if(c.System.isDesktopLayout())c.Desktop.showWindowMenu(this,q);else if(!c.System.tabPanelContainer.getActiveTab()||d!==
c.System.tabPanelContainer.getActiveTab().getId()){f&&0!==f.length||(f=c.Server.getIcon("icon_function.svg"));Ext.isEmpty(h)&&(h=!0);Ext.isEmpty(g)&&(g=!0);var r=function(t,w){if(t){var z=p.getMenu(t.getId());if(z&&(t=Ext.get(t.tabBtnId+"-btnIconEl"))){var x=z.color;w&&(x=c.Color.toColor(p["theme-color"].value));t.setStyle("background-image","url("+c.Server.getIcon(z.iconName,x)+")")}}},u=Ext.getCmp(d);u||(u=e,q&&(u=c.System.getPlainIconMenu(q," \x3e\x3e ")),u=c.System.tabPanelContainer.add({xtype:"panel",
id:d,code:d,icon:f,layout:"fit",title:e,border:0,menuId:d,menuContainer:!0,closable:c.Base.toBool(l,!0),reorderable:c.Base.toBool(n,!0),methodInvoked:!1,method:a,where:k,items:[],tabBtnId:null,tabConfig:{help:u,tabId:d,helpType:FastEnum.HelpEnumType.mouse_in_out,helpAnchor:FastEnum.TooltipAnchorType.top,helpMaxWidth:parseInt((.8*document.body.clientWidth).toFixed(0)),listeners:{destroy:function(t){t.helpTip&&t.helpTip.close()}},handler:function(t){t&&"menuitem"===t.xtype&&c.System.selectTab(t.tabId,
!1,!0)}},doFixed:function(){this.tab.setClosable(!this.tab.closable);if(this.tab.closable)this.reorderable=this.tab.reorderable=!0,(t=c.System.findLastTag())&&c.System.tabPanelContainer.moveAfter(this,t);else{var t=c.System.findLastTag();t&&c.System.tabPanelContainer.moveAfter(this,t);this.reorderable=this.tab.reorderable=!1}Ext.isFunction(c.System.tabPanelContainer.recordTab)&&c.System.tabPanelContainer.recordTab()},doCopyUrl:function(){c.Base.copyToBoard(c.System.baseUrl+"#/"+this.title+"/"+this.id);
c.Dialog.toast("\u590d\u5236\u6210\u529f\uff01")},anchorLeftMenu:function(){c.System.selectMenu(this.id)},openInWindow:function(){var t=this,w=parseInt((.8*document.body.clientWidth).toFixed(0)),z=parseInt((.9*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:t.title,height:z,width:w,minHeight:500,minWidth:800,icon:t.icon,layout:"fit",resizable:!0,constrain:!0,maximizable:!0,listeners:{show:function(x){x.shown=!0;c.System.asyncMethod(t.method).then(function(y){if(null!=
y){var A=y.down("[entityList\x3dtrue]");A&&(A.where=c.Json.mergeJson(t.where,A.where),A.code=$.md5(t.id),A.buildCodeText=t.title);x.add(y)}})}}}).show()},listeners:{deactivate:function(t){if(t&&!t.destroyed&&!t.destroying&&!c.System.silenceGlobalSave)try{r(t,!1);var w=t.down("[entityList\x3dtrue]");if(w&&w.onTabDeactivate)w.onTabDeactivate(t)}catch(z){console.error(z)}},activate:function(t){t&&(p.lastTabId=t.id,c.System.changeTabTheme(t.id,function(){c.System.silenceGlobalSave||(p.existMenu(t.id)&&
p.selectMenu(t.id,!1),r(t,!0));if(!t.methodInvoked||c.System.silenceGlobalSave)p.asyncMethod(a).then(function(y){try{if(y){t.methodInvoked=!0;var A=y.down("[entityList\x3dtrue]");A&&(A.where=c.Json.mergeJson(t.where,A.where),A.code=$.md5(t.id),A.buildCodeText=t.title);t.add(y)}}catch(B){console.error(B)}});else{var w=t.down("[entityList\x3dtrue]");if(w&&w.onTabActivate)w.onTabActivate(t);if(w&&w.hasListener("aftertabactive")&&!w.fireEvent("aftertabactive"))return}if(!c.System.silenceGlobalSave){try{var z=
window.location.href;if(0<z.indexOf("#")){var x=z.substring(z.lastIndexOf("/")+1);if(t.id===x)return}c.System.pushLocationHistory({text:t.title,id:t.id})}catch(y){console.error(y)}p.recordTab()}}))},afterlayout:function(t,w,z){if(c.System.tabPanelContainer&&!c.System.silenceGlobalSave)try{Ext.get(this.tabBtnId).dom.ondblclick=function(){var x=t.getId();c.System.tabPanelContainer.items.each(function(y,A){0!==A&&y.id===x&&y.closable&&Ext.isFunction(y.close)&&y.close()})},c.System.tabPanelContainer.getActiveTab()&&
c.System.tabPanelContainer.getActiveTab().getId()===t.getId()&&r(t,!0)}catch(x){}},destroy:function(t,w){c.System.silenceGlobalSave||p.recordTab()}},initEvents:function(){this.tabBtnId=this.getEl().getAttribute("aria-labelledby")}}));g&&(c.System.silenceGlobalSave?c.System.tabPanelContainer.setActiveTab(u):c.System.tabPanelContainer.getActiveTab()&&c.System.tabPanelContainer.getActiveTab().getId()===u.getId()||(h&&(d=p.findLastTag())&&c.System.tabPanelContainer.moveAfter(u,d),c.System.tabPanelContainer.setActiveTab(u)))}};
b.changeTabTheme=function(a,d){try{var e=c.System.getMenu(a);if(e&&e.baseCls){var f=c.System.getExt("tab-theme").value;c.Base.toBool(f,!1)&&(c.System.clearAllTabTheme(),c.System.getBodyContainer().setUserCls(e.baseCls))}else c.System.clearAllTabTheme()}catch(g){console.error(g)}finally{d()}};b.clearAllTabTheme=function(){c.System.getBodyContainer().setUserCls("")};b.closeAllTab=function(){c.System.isDesktopLayout()?c.Desktop.closeAllDesktopWin():c.System.tabPanelContainer&&c.System.tabPanelContainer.items.each(function(a,
d){a.closable&&a.close()})};b.addTab=function(a,d,e,f){var g=Ext.getCmp(d);g||(g=this.tabPanelContainer.add({title:e,xtype:"container",id:d,code:d,icon:f,border:0,menuContainer:!0,closable:!0,reorderable:!0,layout:"fit",items:[a]}));this.tabPanelContainer.setActiveTab(g)};b.getMenuIdFromLocation=function(){var a=decodeURIComponent(window.location.href);return 0<a.indexOf("#")?a.substring(a.lastIndexOf("/")+1):null};b.pushLocationHistory=function(a){var d=c.System.getMenuIdFromLocation();d&&d===a.id||
(d={title:a.text,url:a.id?c.System.baseUrl+"#/"+a.text+"/"+a.id:c.System.baseUrl},window.history.pushState(d,a.text,d.url))};b.modifyPassword=function(a){var d=Ext.create("Ext.form.FormPanel",{url:"controller/modifyPassword",method:"POST",fileUpload:!0,border:0,width:"100%",layout:"anchor",region:"center",bodyStyle:{},items:[{xtype:"textfield",fieldLabel:"\u5f53\u524d\u5bc6\u7801",labelAlign:"right",labelWidth:60,margin:"10 10 10 10",name:"managerPassword",allowBlank:!1,inputType:"password",blankText:"\u8bf7\u8f93\u5165\u7528\u6237\u5f53\u524d\u5bc6\u7801",
anchor:"100%"},{xtype:"textfield",fieldLabel:"\u65b0\u5bc6\u7801",labelAlign:"right",labelWidth:60,margin:"10 10 10 10",name:"newPassword",allowBlank:!1,inputType:"password",blankText:"\u8bf7\u8f93\u5165\u7528\u6237\u65b0\u5bc6\u7801",anchor:"100%"},{xtype:"textfield",fieldLabel:"\u786e\u8ba4\u5bc6\u7801",labelAlign:"right",labelWidth:60,margin:"10 10 10 10",name:"reNewPassword",allowBlank:!1,inputType:"password",blankText:"\u8bf7\u786e\u8ba4\u5bc6\u7801",anchor:"100%"},{xtype:"hiddenfield",name:"managerId",
value:this.manager.managerId},{xtype:"fieldcontainer",labelWidth:0,layout:"column",items:[{xtype:"button",text:"\u7acb\u5373\u4fee\u6539",margin:"10 10 10 5",iconCls:"extIcon extOk",columnWidth:1,handler:function(){e()}}]}],listeners:{render:function(g){try{new Ext.util.KeyMap({target:g.getEl(),key:13,fn:e,scope:Ext.getBody()})}catch(h){console.error(h)}}}}),e=function(){var g=d.form;g.isValid()&&g.submit({waitMsg:"\u6b63\u5728\u4fee\u6539\u4e2d\u2026\u2026",success:function(h,k){c.Dialog.toast(k.result.message);
f.close();k.result.success&&Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u60a8\u5f53\u524d\u7684\u5bc6\u7801\u5df2\u88ab\u4fee\u6539\uff0c\u8bf7\u60a8\u91cd\u65b0\u767b\u5f55\uff01",function(){c.Server.logout()})},failure:function(h,k){k.result&&Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192",k.result.message)}})},f=Ext.create("Ext.window.Window",{title:"\u4fee\u6539\u7ba1\u7406\u5458\u767b\u5f55\u5bc6\u7801",height:250,iconCls:"extIcon extResetPassword redColor",width:400,layout:"border",resizable:!1,maximizable:!1,
animateTarget:a,constrain:!0,items:[d],modal:!0});f.show()};b.getEntity=function(a){for(var d=this.entities,e=0;e<d.length;e++){var f=d[e];if(f.entityCode===a)return f}return null};b.showMenuColumns=function(a,d){return new Ext.Promise(function(e,f){var g=Ext.create("Ext.data.TreeStore",{proxy:{type:"ajax",url:"showMenuColumn",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(l,n,p,q){l=eval("("+n.responseText+")");l.success||c.Dialog.showAlert("\u6570\u636e\u83b7\u53d6\u5931\u8d25",
l.message,null,!0,!0)}},reader:{type:"json"}},root:{expanded:!0},listeners:{load:function(l,n,p){},beforeload:function(l,n){Ext.apply(l.proxy.extraParams,{checked:d})}}}),h=Ext.create("Ext.tree.Panel",{store:g,rootVisible:!1,bufferedRenderer:!1,animate:!0,containerScroll:!0,autoScroll:!0,lastCheckNode:null,viewConfig:{loadMask:{msg:"\u52a0\u8f7d\u529f\u80fd\u83dc\u5355\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026"}},listeners:{checkchange:function(l,n,p,q){n?(l.bubble(function(r){r.set("checked",!0)}),
l.cascadeBy(function(r){r.set("checked",!0)})):l.cascadeBy(function(r){r.set("checked",!1)})}}}),k=Ext.create("Ext.window.Window",{title:"\u641c\u7d22\u94fe\u914d\u7f6e",width:400,height:470,layout:"fit",iconCls:"extIcon extLink",resizable:!0,animateTarget:a,maximizable:!0,constrain:!0,items:[h],modal:!0,buttons:[{text:"\u91cd\u7f6e",iconCls:"extIcon extReset",handler:function(){g.reload()}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){for(var l=h.getChecked(),n=[],p="",q=0;q<l.length;q++){if(l[q].isLeaf()){var r=
{};r.text=l[q].data.text;r.id=l[q].data.id;r.dataIndex=l[q].data.dataIndex;r.parentId=l[q].data.parentId;var u=h.getStore().findNode("id",r.parentId,0,!1,!1,!0);if(u){var t={};u=u.data;t.text=u.text;t.id=u.id;t.method=u.method;t.icon=u.icon;r.parent=t;n.push(r)}}p+=","+l[q].data.id}e({checked:p,columns:n});k.close()}}]});k.show()})};b.showPowerMenus=function(a,d,e){return new Ext.Promise(function(f,g){var h=Ext.create("Ext.data.TreeStore",{proxy:{type:"ajax",url:"showPowerMenus",actionMethods:{create:"POST",
read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(p,q,r,u){p=eval("("+q.responseText+")");p.success||c.Dialog.showAlert("\u6570\u636e\u83b7\u53d6\u5931\u8d25",p.message,null,!0,!0)}},reader:{type:"json"}},root:{expanded:!0},listeners:{load:function(p,q,r){},beforeload:function(p,q){Ext.apply(p.proxy.extraParams,{checked:d,parent:e})}}}),k=Ext.create("Ext.tree.Panel",{store:h,rootVisible:!1,bufferedRenderer:!1,animate:!0,containerScroll:!0,autoScroll:!0,viewConfig:{loadMask:{msg:"\u52a0\u8f7d\u529f\u80fd\u83dc\u5355\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026"}},
listeners:{checkchange:function(p,q,r,u){q?(p.bubble(function(t){t.set("checked",!0)}),p.cascadeBy(function(t){t.set("checked",!0)})):p.cascadeBy(function(t){t.set("checked",!1)})}}});g=parseInt((.5*document.body.clientWidth).toFixed(0));var l=parseInt((.8*document.body.clientHeight).toFixed(0)),n=Ext.create("Ext.window.Window",{title:"\u6743\u9650\u914d\u7f6e\uff08\u9009\u62e9\u529f\u80fd\u83dc\u5355\uff09",height:l,width:g,minHeight:400,minWidth:470,layout:"fit",iconCls:"extIcon extSelect",resizable:!0,
animateTarget:a,maximizable:!0,constrain:!0,items:[k],modal:!0,buttons:[{text:"\u91cd\u7f6e",iconCls:"extIcon extReset",handler:function(){h.reload()}},{text:"\u786e\u5b9a",iconCls:"extIcon extOk",handler:function(){for(var p=k.getChecked(),q="",r=0;r<p.length;r++)q+=","+p[r].data.id;f(q);n.close()}}]});n.show()})};b.showPowerExt=function(a,d,e,f){return new Ext.Promise(function(g,h){window.getMenuPower=function(){return d};window.getExtPower=function(){return e};window.getParentExtPower=function(){return f};
window.close=function(){Ext.getCmp("ExtPowerWindow").close()};h=parseInt((.5*document.body.clientWidth).toFixed(0));var k=parseInt((.8*document.body.clientHeight).toFixed(0)),l=Ext.create("Ext.window.Window",{id:"ExtPowerWindow",title:"\u914d\u7f6e\u754c\u9762\u6743\u9650\uff08\u5728\u7ec4\u4ef6\u4e0a\u53f3\u51fb\u9f20\u6807\u8fdb\u884c\u7f16\u8f91\u6743\u9650\uff09",iconCls:"extIcon extPower",layout:"fit",resizable:!1,maximized:!0,fixed:!0,draggable:!1,width:h,height:k,listeners:{show:function(n){n.update("\x3ciframe name\x3d'extPowerFrame'  src\x3d'power?managerId\x3d0' width\x3d'100%' height\x3d'100%' frameborder\x3d'0' scrolling\x3d'no' /\x3e")}},
buttons:[{text:"\u4fdd\u5b58\u6743\u9650\u914d\u7f6e",iconCls:"extIcon extSave whiteColor",handler:function(){g(window.extPowerFrame.window.getExtPower());l.close()}}]});l.show()})};b.showList=function(a,d,e,f){if(!Ext.isString(a))throw"\u64cd\u4f5c\u5931\u8d25\uff01\u53c2\u6570menuId\u5fc5\u987b\u4e3aString\u7c7b\u578b\uff01\u8bf7\u68c0\u67e5\u8c03\u7528showList\u65b9\u6cd5\u7684\u76f8\u5173\u529f\u80fd\uff01";if(!Ext.isString(d))throw"\u64cd\u4f5c\u5931\u8d25\uff01\u53c2\u6570entityCode\u5fc5\u987b\u4e3aString\u7c7b\u578b\uff01\u8bf7\u68c0\u67e5\u8c03\u7528showList\u65b9\u6cd5\u7684\u76f8\u5173\u529f\u80fd\uff01";
if(!Ext.isEmpty(e)&&!Ext.isObject(e))throw"\u64cd\u4f5c\u5931\u8d25\uff01\u53c2\u6570where\u5fc5\u987b\u4e3aObject\u5bf9\u8c61\u7c7b\u578b\uff01\u8bf7\u68c0\u67e5\u8c03\u7528showList\u65b9\u6cd5\u7684\u76f8\u5173\u529f\u80fd\uff01";var g=c.System.getEntity(d);if(!g)throw"\u64cd\u4f5c\u5931\u8d25\uff01\u672a\u83b7\u53d6\u5230 '"+d+"' \u5b9e\u4f53\u7c7b\uff01\u8bf7\u68c0\u67e5\u5b9e\u4f53\u7c7b\u5173\u8054\u7684\u8868\u683c\u662f\u5426\u5b58\u5728\uff01";if(!g.js)throw"\u64cd\u4f5c\u5931\u8d25\uff01\u672a\u83b7\u53d6\u5230 '"+
d+"' JS\u5bf9\u8c61\uff01";e||(e={});d=eval("new "+d+"()");d.menu=c.System.getMenu(a);return f?d.getList(e,f):d.getList(e)};b.getWelcomePanel=function(){c.System.welcomeLeftPanels.push(c.System.getSystemOperate(!0));c.System.welcomeLeftPanels.push(c.System.getSystemWaitNotice(!0));var a=Ext.create("Ext.panel.Panel",{layout:{type:"accordion"},region:"center",border:0,flex:.6,items:c.System.welcomeLeftPanels});c.System.isSuperRole()&&(c.System.welcomeRightPanels.push(c.System.getSystemVersion(!0)),
c.System.welcomeRightPanels.push(c.System.getSystemConfig(!0)),c.System.welcomeRightPanels.push(c.System.getSystemMonitor(!0)));var d=Ext.create("Ext.panel.Panel",{layout:"accordion",region:"east",border:0,flex:.4,collapsed:!1,split:!0,subtitle:"\u7cfb\u7edf\u53f3\u4fa7\u9762\u677f",items:c.System.welcomeRightPanels});a=[a];0<c.System.welcomeRightPanels.length&&a.push(d);if(c.Listeners.onInitSystemWelcomeItems)c.Listeners.onInitSystemWelcomeItems(a);c.Power.isPower()||c.System.startCheckSystemWait(!0);
return Ext.create("Ext.panel.Panel",{layout:"border",region:"center",border:0,items:a})};b.getSystemOperate=function(a){var d=Ext.create("Ext.data.Store",{autoLoad:!1,fields:[],id:"SystemLogStore",idProperty:"operateId",pageSize:50,proxy:{type:"ajax",url:"entity/list",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},reader:{type:"json",root:"list",totalProperty:"totalRow"}}}),e=Ext.create("Ext.toolbar.Paging",{store:d,dock:"bottom",border:0,overflowHandler:"scroller",displayInfo:!0}),
f=Ext.create("Ext.grid.Panel",{region:"center",border:0,power:!0,multiColumnSort:!0,iconCls:a?"extIcon extLog":null,columnLines:!0,title:a?"\u7cfb\u7edf\u64cd\u4f5c\u65e5\u5fd7":null,hideHeaders:!0,dataList:!0,store:d,columns:[{header:"\u64cd\u4f5c\u7c7b\u578b",dataIndex:"systemLogType",align:"center",width:120},{header:"\u64cd\u4f5c\u4ecb\u7ecd",dataIndex:"systemLogContent",align:"center",flex:1},{header:"\u64cd\u4f5c\u65f6\u95f4",dataIndex:"systemLogDateTime",width:160,align:"center",rendererFunction:"renders.dateFormat('Y-m-d H:i:s')"},
{header:"\u64cd\u4f5c",dataIndex:"systemLogId",width:100,align:"center",renderer:function(g){return'\x3ca href\x3d"javascript:FastExt.System.showSystemLogDetails('+g+');"\x3e\u67e5\u770b\u8be6\u60c5\x3c/a\x3e'}}],dockedItems:[e],viewConfig:{enableTextSelection:!0,loadMask:{msg:"\u6b63\u5728\u4e3a\u60a8\u5728\u52a0\u8f7d\u6570\u636e\u2026"}}});e.insert(e.items.getCount()-2,{xtype:"button",iconCls:"extIcon extSearch",tooltip:"\u641c\u7d22\u65e5\u5fd7",handler:function(){f.add(c.System.showSearchSysOperate(f,
this))}});e.insert(e.items.getCount()-3,"-");d.on("beforeload",function(g,h){h={};null!=f.whereSearchParams&&(h=f.whereSearchParams);Ext.apply(g.proxy.extraParams,h);Ext.apply(g.proxy.extraParams,{entityCode:"ExtSystemLogEntity",limit:d.pageSize})});d.loadPage(1);return f};b.showSystemLogDetails=function(a){a=Ext.getStore("SystemLogStore").findRecord("systemLogId",a,0,!1,!1,!0);a=c.Grid.createDetailsGrid(function(f){var g=[],h={a__managerName:"\u7ba1\u7406\u5458",systemLogType:"\u64cd\u4f5c\u7c7b\u578b",
systemLogContent:"\u64cd\u4f5c\u8be6\u60c5",systemLogIp:"\u6765\u81eaIP",systemLogClient:"\u6d4f\u89c8\u5668\u4fe1\u606f",systemSendData:"\u63d0\u4ea4\u7684\u6570\u636e",systemResultData:"\u8fd4\u56de\u7684\u6570\u636e",systemLogDateTime:"\u64cd\u4f5c\u65f6\u95f4"},k;for(k in h)g.push({name:h[k],key:k,value:f[k]});return g}(a.getData()),{region:"center",power:!1,hideHeaders:!0},{width:100,flex:0},{align:"left",renderer:function(f,g,h){g.style="overflow:auto;padding: 3px 6px;text-overflow: ellipsis;white-space:normal !important;line-height:20px;word-break:break-word; ";
return"systemLogIp"===h.get("key")?"\x3ca href\x3d'https://www.baidu.com/s?wd\x3d"+f+"' target\x3d'_blank'\x3e"+f+"\x3c/a\x3e":f},listeners:{dblclick:function(f,g,h,k,l,n,p){f=f.getStore().getAt(h);h=f.get("key");"systemSendData"!==h&&"systemResultData"!==h||c.Dialog.showFormatJson(g,f.get("value"))}}});var d=parseInt((.5*document.body.clientWidth).toFixed(0)),e=parseInt((.7*document.body.clientHeight).toFixed(0));Ext.create("Ext.window.Window",{title:"\u65e5\u5fd7\u8be6\u60c5",height:e,iconCls:"extIcon extDetails",
width:d,layout:"border",resizable:!0,maximizable:!0,items:[a],modal:!0,constrain:!0}).show()};b.showSearchSysOperate=function(a,d){if(a.searchWin)c.Component.shakeComment(a.searchWin);else{var e=a.whereSearchParams?a.whereSearchParams:{},f=Ext.create("Ext.form.FormPanel",{bodyPadding:5,region:"center",autoScroll:!0,layout:"column",defaults:{labelWidth:100,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u53ef\u8f93\u5165\u2026"},items:[{fieldLabel:"\u5173\u952e\u5b57",columnWidth:1,name:"where['^search']",
xtype:"textfield",value:e["where['^search']"]},{fieldLabel:"\u5f00\u59cb\u65f6\u95f4",columnWidth:.5,name:"where['systemLogDateTime\x3e\x3d']",xtype:"datefield",format:"Y-m-d",value:e["where['systemLogDateTime\x3e\x3d']"]},{fieldLabel:"\u7ed3\u675f\u65f6\u95f4",columnWidth:.5,name:"where['systemLogDateTime\x3c\x3d']",xtype:"datefield",format:"Y-m-d",value:e["where['systemLogDateTime\x3c\x3d']"]},{fieldLabel:"\u64cd\u4f5c\u7528\u6237",columnWidth:.5,name:"where['a__managerName%?%']",xtype:"textfield",
value:e["where['a__managerName%?%']"]},{fieldLabel:"\u64cd\u4f5c\u7c7b\u578b",columnWidth:.5,name:"where['systemLogType%?%']",xtype:"textfield",value:e["where['systemLogType%?%']"]}]});e=d.text;Ext.isEmpty(e)&&(e="\u641c\u7d22\u7cfb\u7edf\u65e5\u5fd7");a.searchWin=Ext.create("Ext.window.Window",{title:e,width:500,minWidth:500,minHeight:110,height:250,layout:"border",constrain:!0,iconCls:"extIcon extSearch",resizable:!0,collapsible:!0,animateTarget:d,items:[f],listeners:{close:function(g,h){a.searchWin=
null}},buttons:[{text:"\u91cd\u7f6e",iconCls:"extIcon extReset",handler:function(){f.reset();a.whereSearchParams=f.getValues();a.getStore().loadPage(1)}},{text:"\u641c\u7d22",iconCls:"extIcon extSearch",handler:function(){a.whereSearchParams=f.getValues();a.getStore().loadPage(1)}}]})}a.searchWin.show();return a.searchWin};b.getSystemWaitNotice=function(a){var d=eval("new ExtSystemNoticeEntity()");d.menu={text:"\u7cfb\u7edf\u95ee\u9898\u4e0a\u62a5"};var e=Ext.create("Ext.data.Store",{autoLoad:!1,
fields:[],id:"SystemWaitNoticeStore",entity:d,pageSize:50,proxy:{type:"ajax",url:"entity/list",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},reader:{type:"json",root:"list",totalProperty:"totalRow"}}});d=Ext.create("Ext.toolbar.Paging",{store:e,dock:"bottom",border:0,overflowHandler:"scroller",displayInfo:!0});var f=Ext.create("Ext.grid.Panel",{region:"center",border:0,power:!0,multiColumnSort:!0,iconCls:a?"extIcon extTip":null,columnLines:!0,title:a?"\u7cfb\u7edf\u5f85\u529e\u4e8b\u9879":
null,hideHeaders:!0,dataList:!0,store:e,columns:[{header:"\u5f85\u529e\u6807\u9898",dataIndex:"noticeTitle",align:"center",width:200},{header:"\u5904\u7406\u4eba",dataIndex:"a__managerName",align:"center",flex:1},{header:"\u5f85\u529e\u5185\u5bb9",dataIndex:"noticeStateStr",align:"center",width:120},{header:"\u5f55\u5165\u65f6\u95f4",dataIndex:"noticeDateTime",width:200,align:"center"}],plugins:[{ptype:"rowexpander",rowBodyTpl:new Ext.XTemplate("\x3cp\x3e\u3010{noticeTitle}\u3011{noticeContent}\x3c/p\x3e",
"\x3cp\x3e\x3ctpl if\x3d'noticeState\x3d\x3d0' \x3e\x3ca id\x3d'aNoticeAction{noticeId}' href\x3d'javascript:FastExt.System.setDoneSystemWait({noticeId});'\x3e\u6807\u8bb0\u4e3a\u5df2\u8bfb\x3c/a\x3e\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x3c/tpl\x3e\x3ctpl if\x3d'noticeAction' \x3e\x3ca href\x3d\"javascript:{noticeAction};\"\x3e\u7acb\u5373\u524d\u5f80\x3c/a\x3e\x3c/tpl\x3e\x3c/p\x3e")}],dockedItems:[d],viewConfig:{enableTextSelection:!0,loadMask:{msg:"\u6b63\u5728\u4e3a\u60a8\u5728\u52a0\u8f7d\u6570\u636e\u2026"}}});
e.on("beforeload",function(g,h){h={};null!=f.searchForm&&(h=f.searchForm.getValues());Ext.apply(g.proxy.extraParams,h);Ext.apply(g.proxy.extraParams,{entityCode:"ExtSystemNoticeEntity",limit:e.pageSize})});e.loadPage(1);return f};b.setDoneSystemWait=function(a){c.Dialog.showWait("\u6b63\u5728\u6807\u8bb0\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.doneWaitNotice(a,function(d,e){c.Dialog.hideWait();d?(c.Dialog.toast(e),$("#aNoticeAction"+a).remove(),Ext.getCmp("bNoticeAction"+a)&&(Ext.getCmp("bNoticeAction"+
a).destroy(),(d=Ext.getCmp("NoticeAlertWindow"))&&0===$("[type\x3d'bNoticeAction']").length&&d.close())):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",e)})};b.startCheckSystemWait=function(a){window.clearTimeout(c.Server.checkWaitNoticeTimer);var d={};if(!a)for(var e=$("[type\x3d'bNoticeAction']"),f=0;f<e.length;f++)d["noticeId_"+f]=$(e[f]).attr("data-id");c.System.silenceGlobalSave?c.Base.toBool(c.System.noticeListener,!1)&&(c.Server.checkWaitNoticeTimer=setTimeout(function(){c.System.startCheckSystemWait()},
3E3)):c.Server.checkWaitNotice(d,function(g,h){try{if(g){var k=Ext.getCmp("NoticeAlertWindow");if(0>=h.length&&0===Object.keys(d).length)k&&k.close();else{g=[];for(var l=!1,n=0;n<h.length;n++){var p=h[n];g.push({xtype:"fieldset",margin:"10",id:"bNoticeAction"+p.noticeId,style:{background:"#ffffff"},columnWidth:1,viewModel:{data:p},defaults:{anchor:"100%",height:"auto",margin:"0",labelAlign:"right",labelWidth:0,columnWidth:1,disabled:!0,disabledCls:".x-item-disabled-normal"},items:[{xtype:"displayfield",
bind:"{noticeContent}",renderer:function(q,r){r=r.ownerCt.viewModel.data;var u="\x3cb style\x3d'display: block;font-size: 16px;margin-bottom: 10px;'\x3e"+r.noticeTitle+"\x3c/b\x3e";u=u+("\x3cdiv\x3e"+q+"\x3c/div\x3e\x3cdiv style\x3d'margin-top: 10px;display: flex;' \x3e\x3ca type\x3d'bNoticeAction' data-id\x3d'")+(r.noticeId+"' href\x3d'javascript:FastExt.System.setDoneSystemWait("+r.noticeId+");'\x3e\u6807\u8bb0\u4e3a\u5df2\u8bfb\x3c/a\x3e");Ext.isEmpty(r.noticeAction)||(u+='\x26nbsp;\x26nbsp;\x26nbsp;\x26nbsp;\x3ca href\x3d"javascript:'+
r.noticeAction+';"\x3e\u7acb\u5373\u524d\u5f80\x3c/a\x3e');u+="\x3cspan style\x3d'flex: 1;text-align: right;'\x3e"+r.noticeDateTime+"\x3c/span\x3e\x3c/div\x3e";return u+"\x3cdiv style\x3d'font-size: smaller;color: #a0a0a0;margin-top: 10px;'\x3e\u6ce8\uff1a\u5982\u679c\u5df2\u5904\u7406\u8bf7\u6807\u8bb0\u4e3a\u5df2\u8bfb\uff01\x3c/div\x3e"}}]});0===$("#bNoticeAction"+p.noticeId).length&&(l=!0)}if(l||a)if(k||(k=Ext.create("Ext.window.Window",{title:"\u7cfb\u7edf\u5f85\u529e\u4e8b\u9879",id:"NoticeAlertWindow",
width:400,height:400,layout:"column",closable:!1,constrain:!0,iconCls:"extIcon extTip",resizable:!1,scrollable:!0,tools:[{type:"refresh",callback:function(){Ext.getStore("SystemWaitNoticeStore").loadPage(1);c.System.startCheckSystemWait(!0)}},{type:"close",callback:function(){c.Dialog.showWait("\u6b63\u5728\u6e05\u9664\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.clearWaitNotice(function(q,r){c.Dialog.hideWait();q?k.close():c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",r)})}}],collapsible:!0}),
k.showAt(5*$(window).width(),5*$(window).width())),a?(k.removeAll(),k.add(g)):(k.insert(0,g),k.setScrollY(0,!0)),c.Listeners.onSystemNoticeShow)c.Listeners.onSystemNoticeShow()}}}finally{c.Base.toBool(c.System.noticeListener,!1)&&(c.Server.checkWaitNoticeTimer=setTimeout(function(){c.System.startCheckSystemWait()},3E3))}})};b.showBugReportDetails=function(a){var d=Ext.getStore("SystemBugReportStore"),e=d.findRecord("reportId",a,0,!1,!1,!0),f=function(k){var l=[],n={a__managerName:"\u4e0a\u62a5\u7528\u6237",
funcTypeStr:"\u529f\u80fd\u7c7b\u578b",funcName:"\u529f\u80fd\u540d\u79f0",bugContent:"\u95ee\u9898\u63cf\u8ff0",bugFlow:"\u64cd\u4f5c\u6b65\u9aa4",bugImagesHtml:"\u95ee\u9898\u622a\u56fe",fixInfo:"\u4fee\u6539\u610f\u89c1",reportStateStr:"\u4e0a\u62a5\u72b6\u6001",reportDateTime:"\u4e0a\u62a5\u65f6\u95f4"},p;for(p in n)l.push({name:n[p],value:k[p]});return l},g=c.Grid.createDetailsGrid(f(e.getData()),{region:"center",power:!1,hideHeaders:!0},{width:100,flex:0},{align:"left"}),h=Ext.create("Ext.window.Window",
{title:"\u95ee\u9898\u8be6\u60c5",height:500,iconCls:"extIcon extDetails",width:500,layout:"border",resizable:!0,maximizable:!0,items:[g],modal:!0,constrain:!0,buttons:["-\x3e",{text:"\u5220\u9664\u95ee\u9898",iconCls:"extIcon extDelete whiteColor",handler:function(){Ext.Msg.show({title:"\u7cfb\u7edf\u63d0\u9192",icon:Ext.Msg.QUESTION,message:"\u60a8\u786e\u5b9a\u8fd9\u6761\u95ee\u9898\u5417\uff1f",buttons:Ext.Msg.YESNO,defaultFocus:"no",callback:function(k,l){"yes"===k&&c.Store.commitStoreDelete(d,
[e]).then(function(){h.close()})}})}},{text:"\u53cd\u9988\u4fee\u6539\u610f\u89c1",iconCls:"extIcon extEdit",handler:function(){c.Dialog.showEditor(this,"\u63d0\u4ea4\u4fee\u6539\u610f\u89c1",function(k){e.set("fixInfo",k);e.set("reportState",1);e.set("reportStateStr","\u5df2\u5904\u7406");c.Store.commitStoreUpdate(d);g.updateData(f(e.getData()))})}}]});h.show()};b.getSystemVersion=function(a){var d=[{name:"\u9879\u76ee\u540d\u79f0",value:$("title").text()},{name:"\u9879\u76ee\u7248\u672c",value:c.System.version.desc},
{name:"\u9879\u76ee\u4f4d\u7f6e",value:c.System.root.value},{name:"\u64cd\u4f5c\u6587\u6863",value:"\x3ca href\x3d'"+c.System["doc-extjs"].href+"' target\x3d'_blank' \x3e"+c.System["doc-extjs"].value+"\x3c/a\x3e"},{name:"\u672c\u673aIP\u5730\u5740",value:c.System.host.value},{name:"\u7cfb\u7edf\u73af\u5883",value:c.System.os.value},{name:"\u7cfb\u7edf\u542f\u52a8\u65f6\u95f4",value:c.System.startTime.value},{name:"\u7cfb\u7edf\u5237\u65b0\u65f6\u95f4",value:Ext.Date.format(new Date,"Y-m-d H:i:s")},
{name:"\u6570\u636e\u5e93",value:c.System.db.value},{name:"\u6570\u636e\u5e93\u8fde\u63a5\u6c60",value:c.System.dbPool.value},{name:"\u9879\u76ee\u8fd0\u884c\u5bb9\u5668",value:c.System.server.value},{name:"\u8fd0\u884c\u5bb9\u5668\u4f4d\u7f6e",value:c.System.catalina.value},{name:"\u9879\u76ee\u6846\u67b6",value:"\x3ca href\x3d'http://www.fastchar.com' target\x3d'_blank' \x3e"+c.System.fastchar.value+"\x3c/a\x3e"},{name:"\u5f00\u53d1\u8bed\u8a00",value:c.System.java.value+" + ExtJs6 + HTML5 + CSS3"},
{name:"\u5f00\u53d1\u670d\u52a1\u5546",value:"\x3ca href\x3d'"+c.System.developer.href+"' target\x3d'_blank'\x3e"+c.System.developer.value+"\x3c/a\x3e"},{name:"\u7248\u6743\u5f52\u5c5e",value:"\x3ca href\x3d'"+c.System.getExt("copyright").href+"' target\x3d'_blank'\x3e"+c.System.getExt("copyright").value+"\x3c/a\x3e"}];return c.Grid.createDetailsGrid(d,{title:a?"\u7cfb\u7edf\u57fa\u672c\u4fe1\u606f":null,iconCls:a?"extIcon extVersion":null,power:!1,hideHeaders:!0},{},{align:"center"})};b.getSystemConfig=
function(a){var d=Ext.create("Ext.form.FormPanel",{url:"ext/config/saveSystemConfig",bodyPadding:5,method:"POST",region:"center",power:!1,border:0,title:a?"\u7cfb\u7edf\u5168\u5c40\u8bbe\u7f6e":null,iconCls:a?"extIcon extSet":null,autoScroll:!0,defaults:{labelWidth:100,margin:"5 5 5 5",labelAlign:"right",emptyText:"\u8bf7\u586b\u5199"},viewModel:{data:null},layout:"column",items:[{xtype:"fieldset",title:"\u57fa\u672c\u8bbe\u7f6e",columnWidth:1,layout:"column",defaults:{anchor:"100%",margin:"5 5 5 5"},
items:[{name:"theme-color",xtype:"colorfield",fieldLabel:"\u7cfb\u7edf\u4e3b\u9898\u989c\u8272",columnWidth:1,bind:"{theme_color}"},{name:"front-color",xtype:"colorfield",fieldLabel:"\u7cfb\u7edf\u524d\u666f\u989c\u8272",columnWidth:1,bind:"{front_color}"},{name:"system-layout",fieldLabel:"\u7cfb\u7edf\u5e03\u5c40\u65b9\u5f0f",columnWidth:1,xtype:"combo",displayField:"text",valueField:"id",editable:!1,readOnly:!0,value:1,bind:"{system_layout}",store:c.Store.getSystemLayoutDataStore()},{name:"theme",
fieldLabel:"\u7cfb\u7edf\u4e3b\u9898\u98ce\u683c",columnWidth:1,xtype:"combo",displayField:"text",valueField:"id",editable:!1,value:1,bind:"{theme}",store:c.Store.getThemeDataStore()},{name:"window-anim",fieldLabel:"\u7cfb\u7edf\u7a97\u4f53\u52a8\u753b",columnWidth:1,xtype:"combo",displayField:"text",valueField:"id",editable:!1,value:1,bind:"{window_anim}",store:c.Store.getYesOrNoDataStore()},{name:"tab-record",fieldLabel:"\u6807\u7b7e\u8bb0\u5fc6",columnWidth:1,xtype:"combo",displayField:"text",
valueField:"id",editable:!1,value:1,bind:"{tab_record}",store:c.Store.getYesOrNoDataStore()},{name:"tab-theme",fieldLabel:"\u6807\u7b7e\u4e3b\u9898\u5e94\u7528",columnWidth:1,xtype:"combo",displayField:"text",valueField:"id",editable:!1,value:1,bind:"{tab_theme}",store:c.Store.getYesOrNoDataStore()},{name:"font-size",fieldLabel:"\u7cfb\u7edf\u5b57\u4f53\u5927\u5c0f",columnWidth:1,xtype:"combo",displayField:"text",valueField:"id",editable:!1,bind:"{font_size}",store:c.Store.getFontSizeDataStore()},
{name:"front-radius",fieldLabel:"\u7cfb\u7edf\u5706\u6da6\u5927\u5c0f",columnWidth:1,xtype:"combo",displayField:"text",valueField:"id",editable:!1,bind:"{front_radius}",store:c.Store.getFrontRadiusDataStore()},{xtype:"button",text:"\u6062\u590d\u9ed8\u8ba4",iconCls:"extIcon extReset whiteColor",columnWidth:.5,handler:function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u60a8\u786e\u5b9a\u6062\u590d\u7cfb\u7edf\u9ed8\u8ba4\u7684\u914d\u7f6e\u5417\uff1f",function(e,f){"yes"===e&&(c.Dialog.showWait("\u8bf7\u7a0d\u540e\u2026\u2026"),
d.getForm().reset(),c.Server.deleteSystemConfig(function(g,h){c.Dialog.hideWait();g?location.reload():c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",h)}))})}},{xtype:"button",text:"\u4fdd\u5b58\u914d\u7f6e",columnWidth:.5,iconCls:"extIcon extSave whiteColor",margin:"5 5 5 0 ",handler:function(){d.doSubmit()}}]},{xtype:"fieldset",title:"\u7cfb\u7edf\u914d\u7f6e",columnWidth:1,layout:"column",defaults:{anchor:"100%",margin:"5 5 5 5"},items:[{xtype:"button",text:"\u521d\u59cb\u5316\u7cfb\u7edf\u914d\u7f6e",
columnWidth:1,iconCls:"extIcon extRefresh whiteColor",handler:function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u5c06\u521d\u59cb\u5316\u7cfb\u7edf\u8bb0\u5fc6\u914d\u7f6e\uff0c\u786e\u5b9a\u7ee7\u7eed\u5417\uff1f",function(e,f){"yes"==e&&c.System.startSilenceSaveConfig()})}},{xtype:"button",text:"\u4e0b\u8f7d\u7cfb\u7edf\u914d\u7f6e",columnWidth:.5,iconCls:"extIcon extDownload whiteColor",handler:function(){c.Dialog.showWait("\u6b63\u5728\u83b7\u53d6\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6\u4e2d\u2026\u2026");
$.post("downSystemConfig",function(e){c.Dialog.hideWait();e.success?(c.Dialog.toast("\u83b7\u53d6\u6210\u529f\uff01"),c.Base.openUrl(e.data,FastEnum.Target._self)):c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",e.message)})}},{xtype:"button",text:"\u4e0a\u4f20\u7cfb\u7edf\u914d\u7f6e",columnWidth:.5,margin:"5 5 5 0 ",iconCls:"extIcon extUpload whiteColor",handler:function(){c.System.uploadSystemConfigData(this)}},{xtype:"button",text:"\u66f4\u65b0\u7cfb\u7edf\u6570\u636e\u6743\u9650",columnWidth:1,
hidden:!c.Base.toBool(c.System.layer,!1),iconCls:"extIcon extPower whiteColor",handler:function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u786e\u5b9a\u66f4\u65b0\u7cfb\u7edf\u6240\u6709\u8868\u683c\u7684\u6570\u636e\u6743\u9650\u503c\u5417\uff1f\u5982\u679c\u6570\u636e\u5e93\u6570\u636e\u91cf\u8fbe\u5230\u5343\u4e07\u7ea7\u522b\u65f6\uff0c\u66f4\u65b0\u65f6\u95f4\u4f1a\u8f83\u957f\uff0c\u8bf7\u8c28\u614e\u64cd\u4f5c\uff01",function(e,f){"yes"==e&&c.System.validOperate("\u66f4\u65b0\u6240\u6709\u8868\u683c\u7684\u6570\u636e\u6743\u9650\u5c42\u7ea7\u503c",
function(){c.Dialog.showWait("\u6b63\u5728\u66f4\u65b0\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.updateAllLayer(function(g,h){c.Dialog.hideWait();c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",h)})},30)})}},{xtype:"button",text:"\u66f4\u65b0\u7cfb\u7edf\u6570\u636e\u540c\u5217\u503c",columnWidth:1,hidden:!c.Base.toBool(c.System.same,!0),iconCls:"extIcon extCopy2 whiteColor",handler:function(){Ext.Msg.confirm("\u7cfb\u7edf\u63d0\u9192","\u786e\u5b9a\u66f4\u65b0\u7cfb\u7edf\u6240\u6709\u8868\u683c\u4e4b\u95f4\u6709\u5173\u8054\u7684\u76f8\u540c\u5b57\u6bb5\u503c\u5417\uff1f",
function(e,f){"yes"==e&&c.System.validOperate("\u66f4\u65b0\u7cfb\u7edf\u8868\u683c\u76f8\u540c\u5b57\u6bb5",function(){c.Dialog.showWait("\u6b63\u5728\u66f4\u65b0\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026");c.Server.updateAllSame(function(g,h){c.Dialog.hideWait();c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192",h)})},30)})}}]}],doSubmit:function(){var e=d.form;e.isValid()&&e.submit({waitMsg:"\u6b63\u5728\u4fdd\u5b58\u914d\u7f6e\u4e2d\u2026\u2026",success:function(f,g){Ext.Msg.alert("\u7cfb\u7edf\u8bbe\u7f6e",
"\u8bbe\u7f6e\u4fdd\u5b58\u6210\u529f\uff01",function(h){"ok"===h&&location.reload()})},failure:function(f,g){g.result&&Ext.Msg.alert("\u4fdd\u5b58\u5931\u8d25",g.result.message)}})}});c.Server.showSystemConfig(function(e,f){if(e){e={};for(var g in f)e[g.replace("-","_")]=f[g];d.getViewModel().setData(e)}});return d};b.getSystemMonitor=function(a){Ext.isEmpty(a)&&(a=!0);var d=Ext.create("Ext.panel.Panel",{layout:"column",region:"north",power:!1,border:0,bodyPadding:5,title:a?"\u7cfb\u7edf\u76d1\u63a7\u4fe1\u606f":
null,iconCls:a?"extIcon extMonitor":null,closable:!1,autoScroll:!0,listeners:{afterrender:function(){e(d)}}}),e=function(f){a||f.setLoading("\u83b7\u53d6\u7cfb\u7edf\u4fe1\u606f\u4e2d\u2026\u2026");c.Server.loadMonitor(function(g,h){f.setLoading(!1);f.removeAll();if(h){c.System.monitor=h;var k=c.System.monitor.desc,l=c.System.monitor.data;g=function(n){var p=k[n],q=l[n],r=[],u;for(u in p)"title"!==u&&r.push({xtype:"textfield",fieldLabel:p[u],monitorIndex:n,bind:"{"+u+"}"});var t=p.title;r[r.length-
1].triggers={chart:{cls:"extIcon extReport2",hideOnReadOnly:!1,handler:function(){c.System.showMonitorChart(t,this.monitorIndex)}}};f.add({xtype:"fieldset",title:t,columnWidth:1,collapsible:!0,id:"SystemMonitorFieldSet"+n,viewModel:{data:q},defaults:{anchor:"100%",labelAlign:"right",labelWidth:80,columnWidth:1,editable:!1,disabledCls:".x-item-disabled-normal"},items:r})};for(h=0;h<k.length;h++)g(h);f.add({xtype:"button",text:"\u5237\u65b0\u4fe1\u606f",columnWidth:1,margin:"5 5 5 5",handler:function(n){n.setText("\u6b63\u5728\u5237\u65b0");
n.setDisabled(!0);e(f)}})}})};return d};b.getMonitorData=function(a){return c.System.monitor&&c.System.monitor.data&&c.System.monitor.data.length>a?c.System.monitor.data[a]:null};b.showMonitorChart=function(a,d){var e="SystemMonitorChart"+d,f=Ext.getCmp(e);f&&Ext.isFunction(f.updateChart)?f.updateChart():Ext.create("Ext.window.Window",{title:a,iconCls:"extIcon extReport2 whiteColor",height:450,width:450,id:e,layout:"border",resizable:!0,maximizable:!0,constrain:!0,padding:"10 10 10 10",bodyStyle:{background:"#ffffff"},
refreshTimer:null,monitorIndex:d,monitorStopped:!1,updateChart:function(){if(this.monitorStopped)return!1;try{var g=c.System.getMonitorData(this.monitorIndex);if(!g)return!1;var h=function(l,n,p,q){var r=p/n,u="green";.3<r&&(u="purple");.8<r&&(u="red");var t=" "+(100*r).toFixed(2)+"%";"%"===q&&(t="");return{series:[{type:"gauge",splitNumber:10,min:l,max:n,radius:"100%",itemStyle:{shadowColor:"rgba(0,138,255,0.45)",shadowBlur:10,shadowOffsetX:2,shadowOffsetY:2,color:u},progress:{show:!0,roundCap:!0,
width:18,itemStyle:{color:{type:"linear",x:0,y:1,x2:1,y2:0,colorStops:[{offset:0,color:"green"},{offset:1,color:u}]}}},pointer:{icon:"path://M2090.36389,615.30999 L2090.36389,615.30999 C2091.48372,615.30999 2092.40383,616.194028 2092.44859,617.312956 L2096.90698,728.755929 C2097.05155,732.369577 2094.2393,735.416212 2090.62566,735.56078 C2090.53845,735.564269 2090.45117,735.566014 2090.36389,735.566014 L2090.36389,735.566014 C2086.74736,735.566014 2083.81557,732.63423 2083.81557,729.017692 C2083.81557,728.930412 2083.81732,728.84314 2083.82081,728.755929 L2088.2792,617.312956 C2088.32396,616.194028 2089.24407,615.30999 2090.36389,615.30999 Z",
length:"75%",width:16,offsetCenter:[0,"5%"]},axisLine:{roundCap:!0,lineStyle:{width:18}},axisTick:{splitNumber:5,lineStyle:{width:2,color:"#999"}},splitLine:{length:12,lineStyle:{width:3,color:"#999"}},axisLabel:{distance:30,color:"#999",formatter:function(w){return"%"===q?w+"%":c.Base.toByteUnit(w,0)}},title:{show:!0},detail:{valueAnimation:!0,formatter:function(w){return"%"===q?w+"%":"{value|"+c.Base.toByteUnit(w)+"}\n{percent|"+t+"}"},rich:{percent:{fontSize:16,padding:[0,0,0,0]}},color:"auto"},
data:[{value:p}]}]}}(g.min,g.max,g.value,c.Base.toString(g.unit,"byte"));c.ECharts.loadECharts(this,h);var k=Ext.getCmp("SystemMonitorFieldSet"+this.monitorIndex);k&&k.getViewModel().setData(g);return!0}catch(l){console.error(l)}return!1},startTimer:function(g){var h=this;h.monitorStopped||(g&&this.setLoading("\u83b7\u53d6\u76d1\u63a7\u6570\u636e\u4e2d\uff0c\u8bf7\u7a0d\u540e\u2026\u2026"),this.stopTimer(),this.refreshTimer=setTimeout(function(){c.Server.loadMonitor(function(k,l){c.System.monitor=
l;g&&h.setLoading(!1);Ext.isFunction(h.updateChart)&&h.updateChart()&&h.startTimer(!1)})},g?0:1E3))},stopTimer:function(){this.refreshTimer&&clearTimeout(this.refreshTimer);this.refreshTimer=null},listeners:{show:function(g){g.startTimer(!0)},beforedestroy:function(g){g.monitorStopped=!0;g.stopTimer()}}}).show()};b.showLogin=function(a){var d=$("title").text(),e=c.System.getExt("login-background").value,f=c.Color.toColor(c.System.getExt("theme-color").value),g=c.System.getExt("login-logo").value,
h="normal"===c.System.getExt("login-type").value,k=c.System.getExt("copyright").value,l=c.System.getExt("copyright").href,n=c.System.getExt("indexUrl").value,p=c.System.getExt("version").desc,q=(new Date).getFullYear();e=c.System.formatUrl(e,{bg:f,dot:f});e=Ext.create("Ext.panel.Panel",{layout:"fit",border:0,iframePanel:!0,html:"\x3ciframe name\x3d'loginFrame'  src\x3d'"+e+"' width\x3d'100%' height\x3d'100%' style\x3d'border: 0px; overflow-x: hidden;background-color: "+f+"'/\x3e"});var r="\x3cdiv align\x3d'center' class\x3d'headPanel' style\x3d'color:"+
f+";'\x3e\x3cimg class\x3d'loginLogo'  width\x3d'50px' height\x3d'50px;' src\x3d'"+c.System.formatUrlVersion(g)+"' /\x3e\x3ch2\x3e"+d+"\x3c/h2\x3e\x3c/div\x3e";g&&0!==g.length||(r="\x3cdiv align\x3d'center' class\x3d'headPanel' style\x3d'color:"+f+";'\x3e\x3ch2\x3e"+d+"\x3c/h2\x3e\x3c/div\x3e");d=Ext.create("Ext.panel.Panel",{region:"north",layout:"fit",bodyCls:"bgNull",width:"100%",bodyStyle:{},border:0,height:"auto",html:r});f=Cookies.get("loginNameValue");g=Cookies.get("loginPasswordValue");r=
Cookies.get("loginMemberValue");Ext.isEmpty(r)&&(r="0");var u=3*c.Base.getNumberValue(c.System.fontSize)+8,t=Ext.create("Ext.form.FormPanel",{url:c.Server.loginUrl(),method:"POST",fileUpload:!0,bodyCls:"bgNull",border:0,width:"100%",layout:"anchor",region:"center",bodyStyle:{},padding:"10 10 10 10",items:[{xtype:"fieldset",title:"",layout:"anchor",padding:"10 10 0 10",items:[{xtype:"textfield",fieldLabel:"\u767b\u5f55\u540d",labelAlign:"right",labelWidth:u,margin:"10 10 0 0",name:"loginName",allowBlank:!1,
blankText:"\u8bf7\u8f93\u5165\u767b\u5f55\u540d",emptyText:"\u8bf7\u8f93\u5165\u767b\u5f55\u540d",value:f,anchor:"100%"},{xtype:"textfield",fieldLabel:"\u5bc6\u7801",labelAlign:"right",labelWidth:u,inputType:"password",margin:"10 10 0 0",allowBlank:!1,blankText:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",emptyText:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",value:g,submitValue:!1,name:"loginPassword",anchor:"100%"},{xtype:"fieldcontainer",labelWidth:0,anchor:"100%",layout:{type:"hbox",align:"stretch"},
hidden:h,items:[{xtype:"textfield",fieldLabel:"\u9a8c\u8bc1\u7801",labelAlign:"right",labelWidth:u,margin:"10 10 0 0",allowBlank:h,flex:1,letterKeyboard:!0,name:"validateCode",emptyText:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801",blankText:"\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"},{xtype:"image",margin:"10 10 0 0",width:70,cls:"validCodeImg",id:"imgCode",height:32}]},{name:"loginMember",fieldLabel:"\u8bb0\u4f4f",xtype:"combo",labelAlign:"right",labelWidth:u,margin:"10 10 0 0",displayField:"text",valueField:"id",
editable:!1,anchor:"100%",value:r,submitValue:!1,allowBlank:!1,store:Ext.create("Ext.data.Store",{data:[{id:"0",text:"\u7528\u6237\u540d"},{id:"1",text:"\u7528\u6237\u540d\u548c\u5bc6\u7801"}]})},{xtype:"fieldcontainer",labelWidth:0,anchor:"100%",layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",text:"\u91cd\u7f6e",iconCls:"extIcon extReset",flex:1,tipText:"\u91cd\u7f6e\u6570\u636e",margin:"10 5 10 10",handler:function(){t.form.reset()}},{xtype:"button",text:"\u767b\u5f55",id:"btnLogin",
tipText:"\u767b\u5f55\u7cfb\u7edf",margin:"10 10 10 5",iconCls:"extIcon extOk",flex:1,handler:function(){z()}}]}]}],listeners:{render:function(y){try{new Ext.util.KeyMap({target:y.getEl(),key:13,fn:z,scope:Ext.getBody()})}catch(A){console.error(A)}}}}),w=function(){try{t.form.findField("validateCode").reset(),Ext.getCmp("imgCode").setSrc("showCaptcha?t\x3d"+Math.random())}catch(y){}},z=function(){var y=t.form;if(y.isValid())if(c.Listeners.onBeforeManagerLogin)c.Listeners.onBeforeManagerLogin(y.getValues(),
function(){x()});else x()},x=function(){var y=t.form;if(y.isValid()){var A=t.form.findField("loginPassword").getValue(),B=t.form.findField("loginName").getValue(),D=t.form.findField("loginMember").getValue();Cookies.set("loginNameValue",B,{expires:30});Cookies.set("loginMemberValue",D,{expires:30});1===parseInt(D)?Cookies.set("loginPasswordValue",A,{expires:30}):Cookies.remove("loginPasswordValue");y.submit({params:{loginPassword:$.md5(A)},waitMsg:"\u6b63\u5728\u4e3a\u60a8\u767b\u5f55\u2026\u2026",
success:function(G,C){c.System.addScript({src:n+"?v\x3d"+c.System.getExt("version").value})},failure:function(G,C){w();-2===C.result.code&&t.form.findField("loginPassword").reset();C.result&&Ext.Msg.alert("\u767b\u5f55\u5931\u8d25",C.result.message,function(){-3===C.result.code&&t.form.findField("validateCode").focus()})}})}};f="_blank";l.startWith("javascript:")&&(f="_self");k=Ext.create("Ext.panel.Panel",{region:"south",layout:"fit",width:"100%",height:50,bodyCls:"bgNull",border:0,html:"\x3cdiv align\x3d'center'\x3e\x3ca href\x3d'"+
l+"' target\x3d'"+f+"' style\x3d'font-size: xx-small;color:#aaa;text-decoration:none;'\x3e"+k+"\x3c/a\x3e\x3c/div\x3e\x3cdiv align\x3d'center' style\x3d'font-size: xx-small;color:#aaa;margin-top: 5px;'\x3eCopyright \u00a9 "+q+" "+p+"\x3c/div\x3e"});k=Ext.create("Ext.window.Window",{title:"\u7ba1\u7406\u5458\u767b\u5f55",iconCls:"extIcon extLogin",width:420,resizable:!1,layout:"vbox",bodyCls:"bgImage",closable:!1,toFrontOnShow:!0,constrain:!0,items:[d,t,k]});k.show(null,function(){Ext.getCmp("btnLogin").focus();
try{h||(w(),Ext.get("imgCode").on({click:function(){w()}}))}catch(y){}});a.add(e);a.add(k)};b.showLogin2=function(a){var d=$("title").text(),e=c.System.getExt("login-background").value,f=c.System.getExt("login-lottie-json").value,g=c.Color.toColor(c.System.getExt("theme-color").value),h=c.System.getExt("login-logo").value,k="normal"===c.System.getExt("login-type").value,l=c.System.getExt("copyright").value,n=c.System.getExt("copyright").href,p=c.System.getExt("indexUrl").value,q=c.System.getExt("version").desc,
r=(new Date).getFullYear();e=c.System.formatUrl(e,{bg:g,dot:g});f=c.System.formatUrl(f,{bg:g});e=Ext.create("Ext.panel.Panel",{layout:"fit",border:0,iframePanel:!0,html:"\x3ciframe name\x3d'loginFrame'  src\x3d'"+e+"' width\x3d'100%' height\x3d'100%' style\x3d'border: 0px; overflow-x: hidden;background-color: "+g+"'/\x3e"});var u="\x3cdiv align\x3d'center' class\x3d'headPanel' style\x3d'color:"+g+";'\x3e\x3cimg class\x3d'loginLogo'  width\x3d'80px' height\x3d'80px;' src\x3d'"+c.System.formatUrlVersion(h)+
"' /\x3e\x3ch2\x3e"+d+"\x3c/h2\x3e\x3c/div\x3e";h&&0!==h.length||(u="\x3cdiv align\x3d'center' class\x3d'headPanel' style\x3d'color:"+g+";'\x3e\x3ch2\x3e"+d+"\x3c/h2\x3e\x3c/div\x3e");d=Ext.create("Ext.panel.Panel",{region:"north",layout:"fit",bodyCls:"bgNull",width:"100%",bodyStyle:{},border:0,height:"auto",html:u});h=Cookies.get("loginNameValue");var t=Cookies.get("loginPasswordValue"),w=Cookies.get("loginMemberValue");Ext.isEmpty(w)&&(w="0");u=2*c.Base.getNumberValue(c.System.fontSize);t=[{xtype:"textfield",
fieldLabel:'\x3csvg class\x3d"svgIcon" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extLogin"\x3e\x3c/use\x3e\x3c/svg\x3e',margin:"10 10 0 0",name:"loginName",allowBlank:!1,blankText:"\u8bf7\u8f93\u5165\u767b\u5f55\u540d",emptyText:"\u8bf7\u8f93\u5165\u767b\u5f55\u540d",value:h,anchor:"100%"},{xtype:"textfield",fieldLabel:'\x3csvg class\x3d"svgIcon" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extLogPwd"\x3e\x3c/use\x3e\x3c/svg\x3e',inputType:"password",margin:"10 10 0 0",allowBlank:!1,blankText:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",
emptyText:"\u8bf7\u8f93\u5165\u767b\u5f55\u5bc6\u7801",value:t,submitValue:!1,name:"loginPassword",anchor:"100%"},c.Captcha.getLoginCaptchaCmp(),{name:"loginMember",xtype:"combo",fieldLabel:'\x3csvg class\x3d"svgIcon" aria-hidden\x3d"true"\x3e\x3cuse xlink:href\x3d"#extLoginRemember2"\x3e\x3c/use\x3e\x3c/svg\x3e',margin:"10 10 0 0",displayField:"text",valueField:"id",editable:!1,anchor:"100%",value:w,submitValue:!1,allowBlank:!1,store:Ext.create("Ext.data.Store",{data:[{id:"-1",text:"\u4e0d\u8bb0\u4f4f"},
{id:"0",text:"\u8bb0\u4f4f\u7528\u6237\u540d"},{id:"1",text:"\u8bb0\u4f4f\u7528\u6237\u540d\u548c\u5bc6\u7801"}]})},{xtype:"fieldcontainer",labelWidth:0,anchor:"100%",layout:{type:"hbox",align:"stretch"},items:[{xtype:"button",text:"\u7acb\u5373\u767b\u5f55",itemId:"btnLogin",tipText:"\u767b\u5f55\u7cfb\u7edf",margin:"10 10 10 10",iconCls:"extIcon extLogin2",flex:1,handler:function(){y()}}]}];h={height:500,width:988};if(c.Listeners.onInitLoginPanel)c.Listeners.onInitLoginPanel(t,h);var z=Ext.create("Ext.form.FormPanel",
{url:c.Server.loginUrl(),method:"POST",bodyCls:"bgNull",border:0,width:"100%",layout:"anchor",region:"center",bodyStyle:{},padding:"10 10 10 10",items:[{xtype:"fieldset",title:"",layout:"anchor",padding:"10 10 0 10",defaults:{labelAlign:"right",labelWidth:u,labelSeparator:"",labelStyle:"font-size: 20px !important;color: #888888;"},items:t}],listeners:{render:function(D){try{new Ext.util.KeyMap({target:D.getEl(),key:13,fn:y,scope:Ext.getBody()})}catch(G){console.error(G)}}}}),x=function(){z.query("#captcha")[0].refreshCode()},
y=function(){var D=z.form;if(D.isValid())if(c.Listeners.onBeforeManagerLogin)c.Listeners.onBeforeManagerLogin(D.getValues(),function(){A()});else A()},A=function(){var D=z.form;if(D.isValid()){var G=z.form.findField("loginPassword").getValue().trim(),C=z.form.findField("loginName").getValue().trim(),E=z.form.findField("loginMember").getValue().trim();Cookies.set("loginNameValue",C,{expires:30});Cookies.set("loginMemberValue",E,{expires:30});1===parseInt(E)?Cookies.set("loginPasswordValue",G,{expires:30}):
(0!==parseInt(E)&&Cookies.remove("loginNameValue"),Cookies.remove("loginPasswordValue"));D.submit({params:{loginPassword:$.md5(G)},waitMsg:"\u6b63\u5728\u4e3a\u60a8\u767b\u5f55\u2026\u2026",success:function(F,H){F=function(I){c.Base.toBool(I,!0)?c.System.addScript({src:p+"?v\x3d"+c.System.getExt("version").value}):x()};if(c.Listeners.onAfterManagerLogin)c.Listeners.onAfterManagerLogin(F);else F()},failure:function(F,H){x();-2===H.result.code&&z.form.findField("loginPassword").reset();H.result&&Ext.Msg.alert("\u767b\u5f55\u5931\u8d25",
H.result.message,function(){-3===H.result.code&&z.form.findField("validateCode").focus()})}})}};u="_blank";n.startWith("javascript:")&&(u="_self");l=Ext.create("Ext.panel.Panel",{region:"south",width:"100%",height:50,bodyCls:"bgNull",border:0,html:"\x3cdiv align\x3d'center'\x3e\x3ca href\x3d'"+n+"' target\x3d'"+u+"' style\x3d'font-size: xx-small;color:#aaa;text-decoration:none;'\x3e"+l+"\x3c/a\x3e\x3c/div\x3e\x3cdiv align\x3d'center' style\x3d'font-size: xx-small;color:#aaa;margin-top: 5px;'\x3eCopyright \u00a9 "+
r+" "+q+"\x3c/div\x3e"});l=Ext.create("Ext.panel.Panel",{region:"center",layout:{type:"vbox",align:"stretch",pack:"center"},border:0,items:[d,z,l]});g=Ext.create("Ext.panel.Panel",{region:"west",layout:"fit",width:588,border:0,bodyStyle:{background:g},listeners:{render:function(D){c.Lottie.loadJsonAnim(D,f)},beforedestroy:function(D){c.Lottie.unloadJsonAnim(D)}}});var B=Ext.create("Ext.window.Window",{resizable:!1,header:!1,layout:"border",bodyCls:"bgNull",closable:!1,toFrontOnShow:!0,constrain:!0,
width:h.width,height:h.height,items:[g,l]});B.show(null,function(){B.query("#btnLogin")[0].focus();k||x()});a.add(e);a.add(B)};b.startSilenceSaveConfig=function(a,d){c.System.allShowListMethodMenu=c.System.getAllMethodMenu("showList");for(var e=0;e<c.System.entities.length;e++){var f=c.System.entities[e];if(f.js&&Ext.isEmpty(f.menu)){var g=$.md5(f.entityCode+f.comment);c.System.allShowListMethodMenu.push({method:"showList('"+g+"','"+f.entityCode+"')",icon:"icons/icon_function.svg",text:"",id:g})}}c.System.closeAllTab();
c.System.silenceGlobalSave=!0;Ext.MessageBox.show({justTop:!0,modal:!0,animateTarget:a,title:"\u7cfb\u7edf\u63d0\u9192",msg:d?d:"\u521d\u59cb\u5316\u7cfb\u7edf\u914d\u7f6e",iconCls:"extIcon extTimer",progressText:"\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u5373\u5c06\u5b8c\u6210\u64cd\u4f5c",progress:!0,closable:!1,closeAction:"destroy"});c.System.doNextSilenceMenu()};b.doNextSilenceMenu=function(){Ext.isEmpty(c.System.doNextSilenceMenuIndex)&&(c.System.doNextSilenceMenuIndex=0);var a=c.System.allShowListMethodMenu,
d=c.System.doNextSilenceMenuIndex;if(d>=a.length){if(c.Dialog.showAlert("\u7cfb\u7edf\u63d0\u9192","\u7cfb\u7edf\u914d\u7f6e\u5df2\u521d\u59cb\u5316\u5b8c\u6bd5\uff01",null,!0,!0),c.System.silenceGlobalSave=!1,c.System.doNextSilenceMenuIndex=0,c.Listeners.onAfterInitSystem)c.Listeners.onAfterInitSystem()}else Ext.MessageBox.updateProgress(parseFloat(String(d+1))/parseFloat(a.length),"\u6b63\u5728\u8bfb\u53d6\u914d\u7f6e\u4e2d\uff0c\u8bf7\u8010\u5fc3\u7b49\u5f85"),a=a[d],c.System.showTab(a.method,
a.id,a.text,a.icon),c.System.doNextSilenceMenuIndex=d+1};b.uploadSystemConfigData=function(a){var d=Ext.create("Ext.form.FormPanel",{url:"loadSystemConfig",method:"POST",margin:"5",fileUpload:!0,width:400,callBacked:!1,border:0,layout:"column",items:[{xtype:"filefield",fieldLabel:"\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6",labelWidth:120,labelAlign:"right",buttonText:"\u9009\u62e9\u6587\u4ef6",allowBlank:!1,name:"systemConfigFile",columnWidth:1}],doSubmit:function(){var g=d.form;if(g.isValid()){var h=
new Ext.LoadMask({msg:"\u6b63\u5728\u4e0a\u4f20\u6587\u4ef6\u4e2d\u2026",target:f});h.show();g.submit({success:function(k,l){c.Dialog.toast(l.result.message);f.close()},failure:function(k,l){h.destroy();l.result&&Ext.Msg.alert("\u7cfb\u7edf\u63d0\u9192","\u4e0a\u4f20\u5931\u8d25\uff01"+l.result.message)}})}},listeners:{render:function(g){try{new Ext.util.KeyMap({target:g.getEl(),key:13,fn:d.doSubmit,scope:Ext.getBody()})}catch(h){console.error(h)}}}}),e="btnSubmit"+(new Date).getTime(),f=Ext.create("Ext.window.Window",
{title:"\u4e0a\u4f20\u7cfb\u7edf\u914d\u7f6e\u6587\u4ef6",layout:"fit",resizable:!1,scrollable:!1,width:500,items:d,modal:!0,iconCls:"extIcon extUpload",animateTarget:a,constrain:!0,buttons:[{text:"\u91cd\u7f6e",width:88,iconCls:"extIcon extReset",handler:function(){d.form.reset()}},{text:"\u4e0a\u4f20",width:88,id:e,iconCls:"extIcon extOk",handler:function(){d.doSubmit()}}],listeners:{show:function(g,h){d.getForm().findField("systemConfigFile").fileInputEl.dom.click();Ext.getCmp(e).focus()}}});f.show()};
b.addFilterByEntityCreate=function(a,d){Ext.isEmpty(c.System.extCreateFilter[a])&&(c.System.extCreateFilter[a]=[]);c.System.extCreateFilter[a].push(d)};b.showGlobalSearch=function(a,d,e,f){Ext.isEmpty(d)&&(d=[]);Ext.isEmpty(a.code)&&(a.code="GlobalSearchWin");Ext.isEmpty(f)&&(f={});var g="\u7cfb\u7edf\u5168\u5c40\u641c\u7d22",h="GlobalSearchWin"+$.md5(a.code+d.join(",")),k=Ext.getCmp(h);0<d.length&&(g="\u5168\u5217\u641c\u7d22");if(k)k.isVisible()?c.Component.shakeComment(k):k.show();else{k=Ext.create("Ext.data.Store",
{autoLoad:!1,pageSize:40,fields:[],entityCodes:d,searchType:0<d.length?1:-1,proxy:{type:"ajax",url:"globalSearch",actionMethods:{create:"POST",read:"POST",update:"POST",destroy:"POST"},listeners:{exception:function(n,p,q,r){try{var u=eval("("+p.responseText+")");u.success||c.Dialog.showAlert("\u6570\u636e\u83b7\u53d6\u5931\u8d25",u.message,null,!0,!0)}catch(t){c.Dialog.showAlert("\u6570\u636e\u83b7\u53d6\u5931\u8d25",p.responseText,null,!0,!0)}}},reader:{type:"json",root:"list",totalProperty:"totalRow"}},
listeners:{beforeload:function(n,p,q){p=n.proxy.extraParams;q={key:n.searchKey,type:n.searchType,entityCode:n.entityCodes};q=c.Json.mergeJson(q,f);n.getProxy().setExtraParams(c.Json.mergeJson(p,q));return!0}}});var l=Ext.create("Ext.grid.Panel",{border:0,scrollable:"y",store:k,hideHeaders:!0,deferRowRender:!1,dataList:!0,region:"center",columns:[{header:"\u503c",dataIndex:"searchKey",flex:1,renderer:function(n,p,q){p.style="overflow:hidden;align-items: center; display:flex;line-height:24px;";var r=
p="",u=parseInt(q.get("type"));0===u?(p=' FastExt.System.selectTab("'+q.get("id")+'",true,true)',r="\x3cimg alt\x3d'' height\x3d'20' src\x3d'icons/icon_system.svg'/\x3e\x26nbsp;\u7cfb\u7edf\u83dc\u5355"):1===u&&(p="new "+q.get("entityCode")+'().showDetails(this,{"'+q.get("dataIdName")+'":"'+q.get("dataId")+'"})',r="\x3cimg alt\x3d'' height\x3d'20' src\x3d'"+q.get("menuIcon")+"'/\x3e\x26nbsp;"+q.get("entityInfo"));return"\x3cspan style\x3d'display: inline-flex;background: #e3e3e3;color: black;border-radius: 3px;font-size:small;margin-right: 5px;padding: 2px 4px;align-items: center;justify-content: center;'\x3e"+
r+"\x3c/span\x3e\x3ca style\x3d'display: inline-flex;align-items: center;' href\x3d'javascript:"+p+";'\x3e"+n+"\x3c/a\x3e"}}],emptyConfig:{lottie:"base/lottie/global_search.json",opacity:1,width:"70%",height:"70%",filter:""},tbar:{xtype:"toolbar",flex:1,style:{background:"#ececec"},items:[{xtype:"combo",displayField:"text",valueField:"id",editable:!1,width:120,value:-1,hidden:0<d.length,store:Ext.create("Ext.data.Store",{data:[{id:-1,text:"\u5168\u90e8"},{id:0,text:"\u7cfb\u7edf\u83dc\u5355"},{id:1,
text:"\u7cfb\u7edf\u6570\u636e"}]}),listeners:{change:function(n,p,q){l.getStore().searchType=p}}},{emptyText:"\u8f93\u5165\u5173\u952e\u5b57\uff0c"+g+"\uff08\u8f7b\u6572\u56de\u8f66\u952e\uff09",region:"center",flex:1,xtype:"textfield",itemId:"searchInput",name:"searchInput",code:"searchInput"+$.md5(a.code+d.join(",")),useHistory:!0,doSearch:function(){this.validate();l.getStore().loadPage(1)},listeners:{render:function(n,p){try{new Ext.util.KeyMap({target:n.getEl(),key:13,fn:function(q,r){this.doSearch()},
scope:this})}catch(q){console.error(q)}},change:function(n,p,q){l.getStore().searchKey=p},selectHistoryValue:function(n,p){n.doSearch()}},triggers:{search:{cls:"text-search",handler:function(){this.doSearch()}}}}]},viewConfig:{loadingText:"\u6b63\u5728\u52aa\u529b\u641c\u7d22\u4e2d\u2026"}});d=parseInt((.5*document.body.clientWidth).toFixed(0));k=parseInt((.7*document.body.clientHeight).toFixed(0));a=Ext.create("Ext.window.Window",{title:g,id:h,height:k,width:d,iconCls:"extIcon extSearch",layout:"border",
resizable:!0,constrain:!0,maximizable:!0,animateTarget:a,items:[l],modal:!1,firstShow:!0,listeners:{close:function(n,p){},show:function(n){setTimeout(function(){n.down("#searchInput").focus()},200);l.showEmptyTip()},hide:function(){l.hideEmptyTip()}}});e&&e.add(a);a.show()}};b.takeIcon=function(a,d){if(Ext.isEmpty(d))return a;var e=/([^/]*.svg)/;if(a&&e.test(a))return c.Server.getIcon(e.exec(a)[1].trim(),d)};b._fontSize="14px";b.lastTabId=-1;b.dateFormat="Y-m-d H:i:s";b.init=!1;b.menus=null;b.cloneMenus=
null;b.http=null;b.baseUrl=null;b.regByImage=/\.(jpg|png|gif|jpeg)$/i;b.regByMP4=/\.(mp4)$/i;b.regByExcel=/\.(xls|xlsx)$/i;b.regByWord=/\.(doc)$/i;b.regByText=/\.(txt)$/i;b.fullscreen=!1;b.sessionOutAlert=!1;b.restoredTab=!1;b.silenceGlobalSave=!1;b.welcomeRightPanels=[];b.welcomeLeftPanels=[];b.currClickTarget=null;b.extCreateFilter={};b.gridDefaultLinkButton=!0;b.managerPowerCheckSameRole=!0;b.menuSingleExpand=!0;b.gridColumnRestore=!0;b.monitor={data:[],desc:[]};b.gridRowNumber=!1;b.gridIDColumnHidden=
!1;b.gridRefreshData=!1;b.powerVersion="2.0";return b}();c.System=v;v=function(){function b(){}Object.defineProperty(b.prototype,"src",{get:function(){return this._src},set:function(a){this._src=a},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"href",{get:function(){return this._href},set:function(a){this._href=a},enumerable:!1,configurable:!0});Object.defineProperty(b.prototype,"text",{get:function(){return this._text},set:function(a){this._text=a},enumerable:!1,configurable:!0});
return b}();c.SystemScript=v;v=function(){return function(){window.getEntityDataStore=c.Store.getEntityDataStore;window.commitStoreUpdate=c.Store.commitStoreUpdate;window.getGridSelModel=c.Grid.getGridSelModel;window.renders=c.Renders;window.files=c.FileModule;window.getPageToolBar=c.Grid.getPageToolBar;window.getDetailsPanel=c.Grid.getDetailsPanel;window.system=c.System;window.toBool=c.Base.toBool;window.deleteGridData=c.Grid.deleteGridData;window.updateGridData=c.Grid.updateGridData;window.runCallBack=
c.Base.runCallBack;window.showDetailsWindow=c.Grid.showDetailsWindow;window.showWait=c.Dialog.showWait;window.hideWait=c.Dialog.hideWait;window.toast=c.Dialog.toast;window.showAlert=c.Dialog.showAlert;window.showLink=c.Dialog.showLink;window.showCode=c.Dialog.showCode;window.showEditorHtml=c.Dialog.showEditorHtml;window.showException=c.Dialog.showException;window.showJson=c.Dialog.showJson;window.showVideo=c.Dialog.showVideo;window.showImage=c.Dialog.showImage;window.showText=c.Dialog.showText;window.shakeComment=
c.Component.shakeComment;window.rotateOSSImgUrl=c.Image.rotateOSSImgUrl;window.showRectangle=c.Map.selRectangleInMap;window.MemoryCache=c.Cache.memory;window.buildUUID8=c.Base.buildUUID8;window.openUrl=c.Base.openUrl;window.server=c.Server}}();c.SystemCompat=v;v=function(){return function(){}}();c.ComponentInvokeInfo=v;for(var m in c)if(Ext.isFunction(c[m]))c[m]()})(FastExt||(FastExt={}));